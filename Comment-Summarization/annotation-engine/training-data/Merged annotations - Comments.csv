StackOverflow Post link,Comment,Viral,Kosta,Note,Kosta Note
https://stackoverflow.com/a/60661088/5749570,Using the wrong delete isn't the same as freeing memory that was already freed. Keep in mind that delete isn't free. delete does eventually cause memory to be freed but it also ends an object's lifetime and calls the destructor. – François Andrieux Mar 12 at 20:05,1,2,"I believe all comments are talking about the same thing. They are talking about the `delete` operator behavior at run time. Therefore, they all should be in group 1.",Choosing the right granularity is a common issue when people perform clustering. I think this can be either way. 
,"And its actually not freeing already freed memory, its trying to delete memory which you dont own and/or is nothing to do with table. – Lonesome Paradise Mar 12 at 20:09",1,2,,
,@TheGoldKnight23 Can you please explain how you came to that conclusion? – François Andrieux Mar 12 at 20:15,1,,,
,"delete[] will delete the current pointer then look for the other elements of the array, even if they dont exist. Which means that when it is called on a single pointer it goes on a rampage of destruction as it never finds the bounds of the array and it is completely undefined as to what happens at that point – Lonesome Paradise Mar 12 at 20:16",1,1,,
,@TheGoldKnight23 That is just what might happen when you use the wrong delete. It's Undefined Behavior. No single possible outcome is any more valid than any other. It might work fine sometimes. It might not crash and corrupt a bunch of data. It might even crash before it reaches the delete. It's incorrect to presume how UB will manifest. – François Andrieux Mar 12 at 20:18,1,1,,
,"Sure, but it will definitely cause a deletion of something (possibly many somethings) next to it on the heap and then we have objects of type X being destructed as objects of type A (fun :D). But the above segfault is not caused by freeing already freed memory but by using the wrong delete – Lonesome Paradise Mar 12 at 20:22",1,3,,
,"@TheGoldKnight23 Yes, using the wrong delete is a problem that needs to be fixed. No, it won't necessarily delete something. It might not even delete table at all! You may be interested in reading about time traveling Undefined Behavior. It's real. – François Andrieux Mar 12 at 20:23",1,3,,
,@FrançoisAndrieux delete indeed frees up memory pointed to by a pointer (and calls destructor). OP is using the delete array operator instead of the plain delete. – VHS Mar 12 at 20:30,1,4,,
,"@VHS Of course, but the problem with using the wrong delete is that it is Undefined Behavior. You can't assume it will be a memory problem. delete is not free. It could just as well crash because it tried to execute a destructor with a bad this. I can fail for all sorts of reasons. Bringing in memory management is an error in this answer. – François Andrieux Mar 12 at 20:31",1,4,,
,"@FrançoisAndrieux, I tried to reword my answer. I also read your link to the post about time traveling UB. It appears as if such 'time travel' may occur when the compiler sees a UB statically and optimizes it. However, in OP's case, a compiler may not be able to detect a UB and therefore, the delete[] table instruction would be executed at run time. – VHS Mar 13 at 1:05",1,5,,
,"@VHS Maybe time traveling UB won't occur here but it's just an example to illustrate that UB can do anything. As a c++ developer you are required to not presume what UB will do. It's not because we can't think of a reason it would act a certain way that it never will. There could be any number of other reasons that delete[] isn't reached or that delete[] would not reach the point of freeing memory,. – François Andrieux Mar 13 at 13:26",1,5,,
https://stackoverflow.com/a/6841479/5749570,"@Jon: Out of curiosity, why did they set their clocks back by such a ""weird"" interval? Anything like an hour would have seemed logical, but how come it was 5:52mins? – Johannes Rudolph Jul 27 '11 at 13:22",1,1,,
,"@Johannes: To make it a more globally normal time zone, I believe - the resulting offset is UTC+8. Paris did the same sort of thing in 1911 for example: timeanddate.com/worldclock/clockchange.html?n=195&year=1911 – Jon Skeet Jul 27 '11 at 13:25",1,1,,
,@Jon Do you happen to know if Java/.NET copes with September in 1752? I always used to love showing people cal 9 1752 on unix systems – Mr Moose Jul 27 '11 at 14:01,3,2,I think mine is correct. I think you have accidentally gotten group 2 and 3 reverse. These two comment have a total vote of 55 while the other 2 comments which you have annotated as group 2 have a total upvote of 39.,Agree
,"@Mr Moose: I believe Joda Time will do different things depending on the calendar you pick, and Noda Time will when we implement cutover calendars. I don't know about the ""native"" Java / .NET classes. – Jon Skeet Jul 27 '11 at 14:04",3,2,,
,"Does this mean that, somewhere in the Java date libraries, there's logic handling this very edge case (and every other bizarre edge case)? – Yahel Jul 27 '11 at 20:06",4,4,,
,"@yahelc: Nope - there's just general time zone code, which handles all kinds of historical time zone transitions. – Jon Skeet Jul 27 '11 at 20:07",4,4,,
,"@yahelc, to elaborate: time zone changes are basically a small set of different possible parameterized events. The code implements this set of events, and a timezone database supplies a list of events and parameters for each timezone. By the way, this timezone database can be updated independently of the JRE itself: oracle.com/technetwork/java/javase/tzupdater-readme-136440.html – Michael Borgwardt Jul 27 '11 at 22:05",4,4,,
,So why the heck was Shanghai 5 minutes out of wack in the first place? – Igby Largeman Jul 27 '11 at 22:16,2,3,I think mine is correct. I think you have accidentally gotten group 2 and 3 reverse. These two comment have a total vote of 55 while the other 2 comments which you have annotated as group 2 have a total upvote of 39.,Agree
,"@Charles: Lots of places were had less conventional offsets back then. In some countries, different towns each had their own offset to be as close to geographically correct as possible. – Jon Skeet Jul 27 '11 at 22:27",2,3,,
,"I understand the reasoning behind it, and why it's implemented like this. I personally think the result should be 'undetermined' at best. The way it's implemented now is as if the first occurrences of 23:54:08-23:59:59 never happened. 1 and 353 would both be a correct answer. Technically 2 different timezone's are subtracted which doesn't feel like correct behavior. – It's me ... Alex Oct 15 '14 at 14:35",6,,,
,"@It'sme...Alex: No, there's only one time zone here - with two different UTC offsets. A better API would allow you to determine which instant you meant when parsing an ambiguous local time, of course :) – Jon Skeet Oct 15 '14 at 14:37",6,,,
,"@Jon Skeet: ok, two different UTC offsets :-) ... But you understand what I mean. The implementation in java (and most likely other libraries as well) is a bit poor – It's me ... Alex Oct 15 '14 at 14:40",6,,,
,"@It'sme...Alex: Well java.util.Calendar and java.util.Date are certainly poor in a number of ways. In Noda Time, when you convert a LocalDateTime to a ZonedDateTime, you have to give an indication of how you want to handle ambiguous or skipped instants. – Jon Skeet Oct 15 '14 at 15:04",6,,,
,Is there a complete listing of all such time corrections that have been done in all of history? – Kevin H. Lin Oct 16 '14 at 1:58,8,,,
,"@JonSkeet If this answer is correct, then it might be wise to add it to your answer too, that way it's super up to date – Dan Temple Oct 30 '14 at 17:45",7,,,
,"@DanTemple: That answer isn't really correct - the time zone database changed the transition time slightly, but if you edit the original program appropriately, you'll still see a discontinuity. – Jon Skeet Oct 30 '14 at 17:49",7,,,
,I now see why Tom Scott says to just not do this. youtube.com/watch?v=-5wpm-gesOY – Ben Leggiero May 15 '15 at 1:11,5,5,,
,"Tom Scott also has a video on leap seconds @BenC.R.Leggiero: youtube.com/watch?v=Uqjg8Kk1HXo. (This one is from Tom Scott's own YouTube channel, not from Computerphile.) – TRiG Jul 3 '15 at 16:24",5,5,,
,"@Jon Skeet, I am not able to understand the difference. You have both times from the same time zone, if you add or subtract time to a time zone, both times must get affected. Then difference should be only one second. Can you please explain with numbers? – Gibbs Sep 13 '15 at 17:10",7,,,
,"@GopsAB: What do you mean by ""both times from the same time zone""? Ignore Shanghai for the moment - do you live in a time zone that observes daylight saving time? If so, what time does it change? That's a good way of seeing local time change by a different amount from UTC...] – Jon Skeet Sep 13 '15 at 17:13",7,,,
,"@JonSkeet Yes, I meant time1 and time2 in the program are from the same time zone. Isn't? – Gibbs Sep 14 '15 at 6:32",7,,,
,"@GopsAB: Yes, but I don't think that means what you think it means. ""Same time zone"" doesn't mean ""same UTC offset"". For example, I'm in the time zone identified as ""Europe/London"". Once a year, our local time jumps forward by an hour. Once a year, our local time falls back by an hour. In both cases, two universal times which are one second apart end up having local times which are much more than a second apart. – Jon Skeet Sep 14 '15 at 7:15",7,,,
,"@GopsAB: It's not true for local times, because local times go forward or back quite often, usually due to DST. Again - do you live in a culture with daylight saving time? And what do you mean by ""both times will get changed""? It's really not clear what's confusing you. – Jon Skeet Sep 17 '15 at 15:09",7,,,
,"I am from India, No DST used in India. What I understood the implementation is something like an array structure, where reducing all the elements by a time will not change the arithmetic operations. To be more clear, a = [1,2,3,4,5], a[1]-a[2] is 1. reduce a by 1,a will be [0,1,2,3,4] , again a[1]-a[0] gives the same answer. I hope it clears my understanding. – Gibbs Sep 17 '15 at 15:24",7,,,
https://stackoverflow.com/a/38550131/5749570,So it's byRef in regards to objects and byVal in regards to primitives? – Mox Jan 18 '17 at 11:40,2,3,,
,"@mox please read: Objects are not passed by reference, this is a ledgend: String a=new String(""unchanged""); – user1767316 Jan 25 '17 at 23:28",2,3,,
,"public void changeit(String changeit){changit = ""changed"";} changeIt(a); assert(a.equals(""unchanged"")); – user1767316 Jan 25 '17 at 23:35",2,3,,
,"This is yet another great example of the fallacy of the ""it is not pass by reference"" semantics argument. This answer says right in the bold, first sentence: ""only references are passed."" Either a reference is passed, or a reference is not passed. You just said yourself that a reference is passed. By saying ""it is not passed by reference since a reference is passed but..."" you are trying to make a point by mangling English. – Loduwijk Aug 2 '17 at 15:07",I,2,"Once again, our grouping is correct. Just the numbering is off. These particular group of comments are already integrated in the revised answer. So if I ignore the 'I' category, all of our annotations are in sync.",agree
,"@Aaron ""Pass by reference"" does not mean ""pass a value that is a member of a type that is called a 'reference' in Java"". The two uses of ""reference"" mean different things. – philipxy Sep 27 '17 at 8:36",I,2,,
,"@philipxy Because of some very arbitrary decision that has been made by a sub-set of the software community. What you describe is an opinion of how ""Pass by reference"" works, not a universally accepted definition. Even if you cite a few computer science books which agree with you, that only means that those authors share your opinion. English is English, and no matter how much the ""pass by reference definition purists"" want to argue the point they are merely arguing semantics about a non-universal opinion. Some of the answers here are nit-picky about the subjective definition of a nit. – Loduwijk Sep 27 '17 at 13:55",I,2,,
,"Quite confusing answer. The reason why you can't change a string object in a method, which is passed by reference, is that String objects are immutable by design and you can't do things like strParam.setChar ( i, newValue ). That said, strings, as anything else, are passed by value and, since String is a non-primitive type, that value is a reference to the thing that was created with new, and you can check this by using String.intern(). – zakmck Oct 30 '17 at 8:40",1,1,,
,"Instead, You can't change a string via param = ""another string"" (equivalent to new String ( ""another string"" ) ) because the reference value of param (which now points to ""another string"") cannot come back from the method's body. But that's true for any other object, the difference is that, when the class interface allows for it, you can do param.changeMe() and the top level object being referred will change because param is pointing at it, despite param's reference value itself (the addressed location, in C terms) cannot pop up back from the method. – zakmck Oct 30 '17 at 8:45",1,1,,
https://stackoverflow.com/a/322742/5749570,"Forgot to mention insertion costs. In a LinkedList, once you have the correct position, insertion costs O(1), while in an ArrayList it goes up to O(n) - all elements past the insertion point must be moved. – David Rodríguez - dribeas Nov 27 '08 at 7:20",I,1,It is already integrated in a subtle way. The present answer does mention that the insertion or add cost for LinkedList is O(1). ,"agree, but can we mark I,P,C in a separate column in addition to the cluster number"
,Regarding the use of Vector: There really is no need to fall back to Vector. The way to do this is with your preferred List implementation and a call to synchronizedList to give it a synchronized wrapper. See: java.sun.com/docs/books/tutorial/collections/implementations/… – Ryan Cox Nov 27 '08 at 12:19,4,5,,
,Also note that as of Java 6 there's no need to worry about losing performance with a thread-safe class. The JVM is smart enough to optimize those locks away from you if you don't need them. – Alex Beardsley Sep 8 '09 at 18:59,10,,,
,Linked list add is not always O(1) [or this should say addLast() is O(1)]. This is only true if done from within a ListIterator. The add methods in Java's LinkList implementation must search through the list if additions are not on the head or tail. So worst case this is O(n/2) (which really is O(n); but I wrote it this way as it searches forward or backward depending on the given index so is only over at most half the list). – Kevin Brock Mar 23 '10 at 0:56,7,,,
,"@Ken Brock That's add(int,E) vs add(E). – Tom Hawtin - tackline Dec 12 '10 at 21:20",7,,,
,"why LinkedList get is O(n), if you know the position it's O(1), isn't it? – dhblah Mar 11 '11 at 8:52",1,3,We have a lot of discrepancy here. I think the grouping and annotation I have are correct.,Ok to go with yours
,"No, for a LinkedList, get is still O(n) even if you know the position, because in order to get to that position, the underlying implementation has to walk the linked list's ""next"" pointers to get to that position's value. There is no such thing as random access. For position 2, walking the pointers might be cheap, but for position 1 million, not so cheap. The point is, it's proportional to the position, which means it's O(n). – Jonathan Tran Mar 11 '11 at 19:03",1,3,,
,"With an ArrayList, your memory is close together which can improve performance. – schmmd Apr 19 '11 at 22:00",1,,,
,@schmmd Then explain why memory is called Random-access Memory? – Kevin Apr 30 '11 at 12:27,1,4,,
,"@Kevin memory is random-access. But how do you know which spot in memory to read? For an array/ArrayList, you can calculate the address in memory by multiplying the element size times the position in the array, because they're stored contiguously. But for a LinkedList, you can't do that. Each element stores the address of the next. – Jonathan Tran May 4 '11 at 18:07",1,4,,
,"@Johnathan Tran Great comment but, my point was that it shouldn't be a difference if 'memory is close together'. – Kevin May 5 '11 at 6:44",1,4,,
,"@Kevin It may matter that memory is ""close together"". Hardware will cache contiguous blocks of memory (dynamic RAM) into faster static RAM in the L1 or L2 cache. In theory and most of the time practically, memory can be treated as random-access. But in reality, reading through memory sequentially will be slightly faster than in random order. For a performance-critical loop, this could matter. They call it ""spatial locality"" or locality of reference. – Jonathan Tran May 5 '11 at 20:25",1,4,,
,"This answer glossed over the worst aspect of LinkedList - significantly more allocations than an ArrayList. This can increase the constant time significantly compared to an ArrayList. Also, Vector is not really thread safe - it must still be safely published due to internal non-guarded state (one of the reasons Vector has been deprecated). – jsravn Dec 19 '11 at 21:01",3,,,
,"In order to get O(1) time for seeking, you have to call listIterator(0) and always use that for sequential (forwards or backwards) seeking. – yingted May 19 '12 at 14:36",1,,,
,"@JonathanTran you said removal from a linked list takes O(N) and then you say ""LinkedList allows for constant-time insertions or removals"" . isn't this contradictory ? – Geek Jul 17 '12 at 11:07",1,,,
,@Geek remove from position X is O(N) as the list must be traversed to reach the relevant position before doing the actual remove. Iterator.remove is O(1) because it makes use of the constant-time remove without having to traverse the list (i.e. removing the current element). – paulw1128 Aug 9 '12 at 12:52,1,,,
,"remove in ArrayList is O(1) if you remove from the end, it's O(n) only if you remove in the middle (so you can implement an efficient stack by using add, remove from the end) – Krzysztof Krasoń Nov 16 '12 at 9:38",1,,,
,Worth noting that contains() takes O(n) in both cases. – Giovanni Botta Apr 1 '13 at 15:42,9,,,
,"If one wishes to remove many items from an ArrayList on a single pass of an iterator, is the total time O(N) or O(N^2)? I know I'd implement it to be the former. – supercat Apr 3 '14 at 23:56",8,,,
,"It all really comes down to the size of the L2 cache. ArrayLists are faster then linked list as long as you are withing the size of the L2 cache. As soon as what you are storing exceeds the size of the L2 cache, it really does not mater that much, go with the linked list. – FlyingGuy Jan 20 '15 at 15:17",5,,,
,"I think that, similarly to ArrayList<E>#remove(int index) being O(n - index), you could also argue that LinkedList<E>#remove(int index) is in fact O(index + 1). To see why, consider that removing the first element in a LinkedList could only really be O(1). Who (dis)agrees? [Note that this doesn't mean it is wrong to say that LinkedList<E>#remove(int index) is O(n), because the order of magnitude of index is of course n]. – Matthias Feb 4 '15 at 21:29",5,,,
,Non locality of data hurts the LinkedList even in the case of iterating over the elements: david-soroko.blogspot.co.uk/2015/06/… – David Soroko Jun 24 '15 at 14:05,5,,,
,"Furthering the discussion of the performance of LinkedList.get, the documentation states that ""the list will be treversed from the end, when the position is beyond half way"", so ""get"" would be O(n/2). – rndStr Aug 30 '15 at 16:52",2,,,
,having read and I think understand this... I would think LinkedList would be preferred default as I personally thing using get is code smell. I rarely want/need it – xenoterracide Nov 1 '15 at 6:39,5,,,
,"There’s no such thing as O(n/2) or O(n/4). The big O notation tells you how an operation scales with larger n. and an operation needing n/2 steps scales exactly like an operation needing n steps, which is the reason why constant summands or factors are removed. O(n/2) and O(n/4) are both just O(n). LinkedList and ArrayList have different constant factors anyway, so it wouldn’t make sence to compare a O(n/2) of one with a O(n/4) of the other, both just denote linearly scaling operations. – Holger Jul 4 '16 at 9:57",2,2,,
,"@Andreas, use theta notation if you want to show that average is N/4, big O is not made for that – AdamSkywalker Jul 14 '16 at 8:51",2,,,
,"It's acceptable to add constants to Big-O/Big-Theta to emphasise an additional operation / explain a particular case. For example, when we talk about the complexity of reading from a hash table, you'll often see: O(1 + load factor). Yes, that 1 means nothing asymptotically, but it's useful to emphasise that there is a O(1) lookup followed by O(load factor) to follow any chains for collision hashes. Here, we're writing O(n/4) more to explain what ""average"" case is. Asymptotically, the factor makes no difference, but it's useful for briefly summarising what ""average"" means for the operation. – James Lawson Nov 27 '16 at 7:23",2,,,
,guys when i was going through vector's usage and differences i found that though vector synchronizes it is not thread safe. please refer this – Mani Dec 6 '16 at 7:20,3,,,
,"I think its important to mention: if your implementing something that is pure on the Stack (aka Deque) abstraction, requiring that the performance-critical portions of your work use only push and pop, then LinkedList gives you O(1) performance in compact memory without any amortization, which sounds pretty good to me. – Groostav Sep 14 '17 at 21:08",4,,,
,"While this is an excellent answer, it seems to me that what you really are saying is that you'd use LinkedList lists to build a large collection of varying size and then iterate over all the elements. Meanwhile, ArrayList lists are faster if you need to look up varying positions and not just iterate. (If you need to insert at random places a tree-like or map-like structure may be better so long as its ordered, like TreeMap) – Haakon Løtveit Feb 14 '18 at 11:37",12,,,
,"@Groostav LinkedList is all but “compact memory”. If you need a stack or deque, use ArrayDeque which gives you O(1) performance in truly compact memory. – Holger Apr 12 '18 at 7:28",4,,,
,"This is already covered somewhat above but to make it explicit, addLast is O(1) as well which is not obvious when discussing linked lists. – Ben Kushigian Aug 2 '18 at 22:22",11,,,
,What is meant by Iterator.remove() is O(1) for linked list? We still need to create the iterator and iterate over the list right? Shouldn't it be O(n) unless the element to be removed is at the end where the current pointer lies? – linuxNoob Sep 28 '18 at 15:47,6,,,
,"@linuxNoob Iterator.remove() can only operate on the linked list as it's being traversed, so it is always O(1). LinkedList.remove() would be O(n) unless it was the first item you were removing. – Bill K Dec 28 '18 at 18:20",6,,,
,"@BillK When you say operating on the linked list as its being traversed, it still means traversing through the list one element at a time right? Which means if it's not the current element then I'd have to traverse through the list (potentially unknown number of elements) before I can remove it? – linuxNoob Dec 29 '18 at 20:32",6,,,
,"@linuxNoob Yes. If you are doing an operation (let's say searching for a value) you must traverse the list be it linked or array. If it's a linked list then when you find your target, deleting it is O(1), if it's an array list deleting it is O(n). Moreover if you are scanning a list to delete, say, multiple entries with a certain trait then your operation becomes O(n) for a linked list and O(n^2) for an array list. I once ""Fixed"" an operation (Insertion sort) taking 6 hours down to seconds by JUST replacing an arraylist with a linked list. (then fixed it better with a sorted set) – Bill K Dec 29 '18 at 21:56",6,,,
,"@Bill K, why did you say that iterate over both linked list and array list cost constant time? Isn’t it O(n) since it is the cost for iterating over all the elements? – Eitanos30 Nov 12 '19 at 21:52",6,,,
,"@Eitanos30 Iterating over either list is not constant, it's O(n), however deleting a single element when you are in the middle of iterating over it is O(1) for a linked list and O(n) for an ArrayList. If you look at the entire operation of removing ""n"" elements from a list in a single pass, it's O(n) for a linked list and O(n^2) for an ArrayList – Bill K Nov 12 '19 at 23:43",6,,,
,"@Bill K, I understand, but you wrote in your answer the following sentence: ""Iterating over either kind of List is practically equally cheap. (Iterating over an ArrayList is technically faster, but unless you're doing something really performance-sensitive, you shouldn't worry about this -- they're both constants.)"". What did you mean when saying constant here? – Eitanos30 Nov 13 '19 at 13:39",6,,,
,"@Eitanos30 Sorry, not my answer. It's CW and I don't think I ever contributed to it except for a couple comments. Since it's CW I suggest you go in and edit it. – Bill K Nov 13 '19 at 17:02",6,,,
,"@Bill K, sorry how can i edit it? – Eitanos30 Nov 13 '19 at 18:55",6,,,
,"@Eitanos30 There should be a share/edit/flag link under the post. It looks like you have sufficient rep to edit a CW (I think the limit is 100, but this question is high activity so they might change it.). I think what he meant, by the way, is that the increase is linear (constant) as the list grows... but you are right that it's not completely clear. – Bill K Nov 14 '19 at 0:25",6,,,
,@Bikl K thanks. I will delete it – Eitanos30 Nov 14 '19 at 16:04,6,,,
https://stackoverflow.com/a/34658/5749570,"Useful if you don't know the API perhaps, but if you are having to test private methods in this manner there is something up with your design. As another poster says unit testing should test the class's contract: if the contract is too broad and instantiates too much of the system then the design should be addressed. – andygavin Jun 26 '09 at 14:23",1,1,,
,Very useful. Using this it is important to keep in mind that it would fail badly if tests were run post obfuscation. – Rick Minerich Feb 4 '10 at 1:11,4,5,,
,True... Anything Reflective will fail miserably after obfuscation. – Cem Catikkas Feb 4 '10 at 18:26,4,,,
,"The example code didn't work for me, but this made thigs clearer: java2s.com/Tutorial/Java/0125__Reflection/… – Rob Jul 1 '11 at 10:56",5,4,,
,"This is all great (I've been doing the same for a long time), but there is one glitch that I am trying to find the solution for. Imagine that u wanna test the exception outcome of the private method. Instead of the method invocation giving u an IllegalArgumentException, for example, you'll get null Class:java.lang.reflect.InvocationTargetException. Maybe there is a way of covering this, but I am not familiar with it. A colegue of mine proposed using powermock for it. – despot Aug 4 '11 at 11:56",9,,,
,Much better than using reflection directly would be to use some library for it such as Powermock. – Michael Piefel Oct 25 '11 at 7:22,2,2,,
,"Thank you ""Rob"" for the link. My test was failing at the getDeclaredMethod() call because I wasn't passing it the parameter arguments. – livefree75 Mar 11 '13 at 14:11",5,,,
,"@despot: According to the doc, you should be able to retrieve the original exception via getTargetException() or getCause(). – T-Bull Jun 23 '13 at 12:01",9,,,
,This is why Test Driven Design is helpful. It helps you figure out what needs to be exposed in order to validate behavior. – Thorbjørn Ravn Andersen Jul 18 '13 at 18:46,3,3,,
,"Here is an example for MyAdder.sum(int, int) --- MyAdder object = new MyAdder(); Method method = MyAdder.class.getDeclaredMethod(""sum"", new Class[] { Integer.TYPE, Integer.TYPE }); method.setAccessible(true); Object r = method.invoke(object, new Object[] { 1, 2 }); Assert.assertEquals(3l, ((Integer) r).longValue()); – Asim Ghaffar Sep 1 '13 at 10:59",10,,,
,shouldn't that be getClass().getDeclaredMethod() ? – JBoy Nov 29 '13 at 9:57,10,,,
,"Though this is the excepted answer, I would echo some other answers that say one should use a mocking library for this, like Powermock or JMockit. – Josef.B Aug 26 '15 at 17:28",2,,,
,"""you can't change private static final variables through reflection"" is not true - final fields can be changed via trick based on clearing Modifier.FINAL flag bit of the Field.modifiers field (unless cases where forbidden by security manager or primitive is inlined by compiler). – Tomáš Záluský Jan 26 '16 at 12:25",13,,,
,"Legacy or not, you shouldn't change visibility for testing purposes. +1 to Reflection in any case. – juanmf Mar 4 '16 at 13:10",8,,,
,For further details on accessing private methods refer link – gKaur Mar 9 '16 at 9:48,15,,,
,"if you are using ExpectedException, keep in mid that exception you might expect will be wrapped by a InvocationTargetException, so you should do something like : try { method.invoke(svc, request); } catch (InvocationTargetException e) { throw ((Exception)e.getCause()); } – Legna Jun 3 '16 at 15:30",16,,,
,"It's sad to see such a terribly wrong answer like this get so many upvotes. One should not reduce the accessibility of methods or fields, neither access them through Reflection. I have written literally thousands of JUnit/TestNG over many years, and I never had to resort to testing private methods directly. Occasionally, I had to read a private field (through Reflection), but that was about it. I guess some developers (many, apparently) are too lazy to write proper tests (which only call public methods), and prefer to cheat by using Reflection. – Rogério Jun 3 '16 at 16:02",7,,,
,These should really be wrapped in helper methods so you don't have to repeat that every time (and naturally... there are several frameworks that do that already). Also; you can most definitely set private static final variables through reflection. Whether you should or not is another matter. – BeUndead Jul 20 '16 at 14:20,17,,,
,"No I don't think appealing to TDD is a valid criticism here. Why should a unit test intended to cover a private method be excluded from that encapsulation? If TDD is supposed to tell you to make that method public, you're not producing quality code here, instead you're appeasing a logical flaw in the language itself. – Jonathan Neufeld Sep 1 '16 at 17:10",3,,Can you please review these? I think they belong to group 3 too.,Fine
,"Few of these replies and comments appear to have picked on this: the question could have been about approaches to legacy code, except that the OP has included the TDD tag. I don't have a huge amount of TDD experience yet, but if you study the ""seminal"" Growing Obj-Oriented Software Guided by Tests, I think it becomes clear: private methods should result from refactoring and only from refactoring. By definition refactoring means that the code has passed the relevant tests. So I think the question is why this TDD tag was included. – mike rodent Oct 23 '16 at 19:43",3,,,
,"testing private methods should be done from public members, private members that are not invoked directly or indirectly by public members have no value. Unit testing and TDD is not about directly testing every method written, it is about testing the behavior of the written code compared to the requirements for writing that code. – Espen Oct 27 '16 at 23:55",3,,,
,"Most purists fail to acknowledge that there are legitimate cases for this. My case: I am writing a plug-in for a (closed source) commercial product. Writing regular unit tests for public methods involves mocking large parts of that product, and there are limits to this approach. Being able to test my private methods in the manner described above ensures that 95% of my code has been tested before deployment. – mvreijn Dec 1 '16 at 11:17",6,,,
,"In all the answers and comments that poo-poo testing private methods, no one gave a good reason to conflate modularity and access. I like to break my code into small pieces, where each of these pieces do one thing. This aids readability and maintainability. Just because something makes sense as its own chunk of code doesn't mean I have to expose it as part of the contract for the class. Am I missing something? – Max Heiber Apr 15 '17 at 0:55",18,,,
,This guys provides a more in-depth explanation youtu.be/agnblS47F18?t=24m23s. Check at 24:23 for a solution similar to the example above. – Daniel Oct 10 '17 at 16:59,12,,,
,"One problem with testing private methods with reflection is that if you delete your method, you won't see it in the tests at compile time. – ACV Nov 30 '17 at 13:00",11,,,
,"PowerMock Whitebox reads private fields with reflection. So I think I have my answer: test private internal states with PowerMock, or just reflection without the overhead of introducing another independency, and private methods: don't test. – WesternGun May 12 '19 at 14:23",2,,,
,"""if you are having to test private methods in this manner there is something up with your design."" Well I'm TDDing an Android app, so... yeah. – Phlip Dec 3 '19 at 16:48",19,,,
,@RickMinerich - Beginner here. what is obfuscation ? – MasterJoe2 Mar 10 at 17:01,4,,,
,@CemCatikkas - I am not asking for any guarantees here. Is Manifold's Jailbreak library reliable enough to be considered for use in commercial software products ? I don't know if it is just an obscure project which is likely to be abandoned in the near future. – MasterJoe2 Mar 10 at 17:08,20,,,
https://stackoverflow.com/a/20658351/5749570,They why the output shows different values every time i run it ? I am running on the same machine – Aman Arora Dec 18 '13 at 12:36,1,1,,
,basicly yes. a computer is a working machine and has more or less stuff to do – Philipp Sander Dec 18 '13 at 12:38,1,1,,
,"in the catch(Error e), call other functions, If stack is full, how it is working? – Aman Arora Dec 18 '13 at 12:46",3,3,,
,check the edit please. – Aman Arora Dec 18 '13 at 12:51,4,4,,
,Please check the second code . Its not terminating. How it id getting stack to print ? – Aman Arora Dec 18 '13 at 13:10,2,2,,
,"it prints the stack, because the programm is still running (in an unstable condition). it is not terminating because calling b() in b() is an endless loop ;) – Philipp Sander Dec 18 '13 at 13:13",2,2,,
https://stackoverflow.com/a/42382347/5749570,I think the poster doesn't want the file packed inside a jar and wants it in a directory where it can be tweaked without unzipping & zipping again – lance-java Feb 22 '17 at 14:09,1,1,,
,I would tweak my answer if OP confirms that's what he needs. – VHS Feb 22 '17 at 15:31,1,4,Here VHS is replying to the above comment. Shouldn't they be in the same group?,"VHS knows, so I defer to him"
,"@VHS - your answer is closest to what i a want, in particular, Ans 2.2. Yes lance, i want it externally. So i specified the entry in build.gradle as you indicated, and i see now that when i do a gradle build, it creates a /my_app1/build/resources/main folder. I am still not able to read this with the code i have above however. the error is: ""java.io.FileNotFoundException: \config.dev.properties (The system cannot find the path specified)"" – mike01010 Feb 22 '17 at 16:16",2,2,,
,"@VHS, I am debugging this through eclipse after building it. Wondering if i have to let eclipse know where the resource files are for a given project? – mike01010 Feb 22 '17 at 16:33",3,3,My mistake on this one. I have updated this group to match yours.,ok
,"@mike01010, if you are debugging it through Eclipse, the relative paths are all relative to the project folder - the folder which has thesrc folder. So if your build folder is at the same level as src, you can use build/resources/main/config.dev.properties. – VHS Feb 22 '17 at 16:43",3,3,,
,"@VHS, that works, but i don't think that code is deployable, since there won't be a 'build' folder when deployed. would be nice if the relative path works for both debugging in eclipse as well as runtime – mike01010 Feb 22 '17 at 19:12",3,3,,
,"@mike01010, I understand your concern. That's why people recommend reading files from classpath instead of from a relative path. If a resource file is on classpath, you don't need to specify any path regardless of whether the run time is within eclipse or outside. – VHS Feb 22 '17 at 19:29",3,3,,
,"@VHS can you point me how to do that. i actually did try renaming the config folder to 'resources' and using ClassLoader.class.getResourceAsStream, to no avail. Also, does this method allow us to change config entries without having to re-build and re-deploy? – mike01010 Feb 22 '17 at 19:38",3,3,,
,See if this helps. – VHS Feb 22 '17 at 19:53,3,3,,
,"@VHS thanks, seems like that will compile the config into the jar. not an option for us. We'd like to change values in the config at run-time. will try to figure out best way to do this – mike01010 Feb 22 '17 at 22:10",3,3,,
https://stackoverflow.com/a/574650/5749570,"Thanks @IAdapter. Note that you should always do a compile before hand because it will just put whatever is in ""target/classes"" in the JAR. This will ensure that the JAR includes any changes you recently made to the source code. So, you should do something like: mvn clean compile assembly:single. – Michael May 31 '11 at 19:03",2,2,,
,"I've edited the question to include the phase binding. I removed the deprecated assembly goal, because no-one needs to know about that. – Duncan Jones Feb 21 '13 at 8:38",3,3,,
,"I've associated the assembly:single goal with the package phase in my project's pom.xml, but it works only when I do a mvn assembly:single from the command line. – Sahil Dave Oct 23 '13 at 14:55",,,,
,Is here any way I can direct the <mainClass> to a class under the test directory? I have a main class under org.core (the directory structure exists under main and test) but maven only includes compiled classes from main and not test. – Prashant Vaidyanathan Jul 16 '14 at 2:10,,,,
,Can we use this metod for java fx jar. Our the default ant jar task is better. But i am facing issues of dependencies with ant jar task.look my Question stackoverflow.com/questions/25915793/… – Mubasher Sep 18 '14 at 16:56,,,,
,"I see that this doesn't add the jars to the uber jar, instead this just adds all the class files to the jar. – pitchblack408 Apr 7 '15 at 16:31",5,5,,
,"Tip: you can also add the element <appendAssemblyId>false</appendAssemblyId> into the configuration to avoid the annoying ""-jar-with-dependencies"" suffix in the name – maxivis May 6 '15 at 19:22",1,1,,
,forget compile and you are screwed. – prayagupd Nov 13 '16 at 0:44,2,4,"I'm keeping it in group 2 because that's the group that talks about 'compile' requirement. Yes, this comment is not in the same conversation. But it is on the same topic (compile).",fine
,"maven assembly plugin could introduce some issues because could override some dependencies, so I cannot tell you to use it! Use the maven Shade plugin instead which works very nice for us. We spent some days to found that the maven assembly plugin overrides some dependencies which break application jar. Have a look there : mkyong.com/maven/create-a-fat-jar-file-maven-shade-plugin – user3774109 Mar 9 '17 at 15:07",,,,
,8 levels of wrapping is insane overdoing it – Niklas Nov 21 '17 at 21:48,,,,
,@maxivis Doing this seems to work but generates some warnings. – Raffi Khatchadourian Feb 1 '18 at 22:41,,,,
,"what if i don't have main method or class, i just need some random java file to be jar? – parlad Jul 20 '18 at 11:02",4,,This should be group 4,"ok, must have missed it"
,@parladneupane leave out the <archive> ...</archive> portion – gerardw Oct 24 '18 at 16:27,4,,,
,"He do not asked to use plugings, maven should be able compile with dependencies itself without strange commands and plugings – user10201743 Nov 20 '18 at 22:04",,,,
,"@user10201743 Just to give a little context: Everything in Maven is a plugin. The compiler? maven-compiler-plugin. Tests? maven-surefire-plugin. These two, including the assembly, are official maven plugins, so they might as well be considered as part of maven (esp. cause, at least now, all three of them are in your effective POM by default). – Adowrath Mar 16 '19 at 18:09",,,,
,I ran into this with the alexa-skills-kit-sdk-for-java which worked well until the instructions to create the WAR barfed in Maven. In 'Developing Your First Skill' it says enter the line command 'mvn org.apache.maven.plugins:maven-assembly-plugin:2.6:assembly -DdescriptorId=jar-with-dependencies package' which does not work. I put the above plug-in in the 'highest POM' (closest to the root file) and ran the line command 'mvn clean compile assembly:single' from that POM (directory) and it worked perfectly. – Richard Bradley Smith May 25 '19 at 1:16,,,,
,"For example if your main class path is src/main/java/com/example/ui/Main.java, you must write like that to pom.xml: <mainClass>com.example.ui.Main</mainClass>. – Halil İbrahim Oymacı Mar 31 at 9:25",,,,
https://stackoverflow.com/a/65049/5749570,Actually thread.stop() does not necessarily prevent finally block from being executed. – Piotr Findeisen Mar 30 '11 at 21:12,2,2,,
,"How about we say that the finally block will be called after the try block, and before control passes to the following statements. That's consistent with the try block involving an infinite loop and hence the finally block never actually being invoked. – Andrzej Doyle Sep 16 '11 at 11:24",1,1,,
,"By @andrzejDoyle definition, it will return success first before going to finally block. Is that correct? – dieend Apr 21 '13 at 7:44",1,1,,
,"@dieend: It will decide that the return value will be success, executes the finally block, then gives back control to the calling function. Nothing will be returned if the finally block throws. – Laurent LA RIZZA Jun 28 '13 at 5:00",1,1,,
,"there is also another case, when we use nested try-catch-finally blocks – ruhungry Mar 22 '14 at 20:39",4,4,,
,"also, finally block is not called in case of exception thrown by daemon thread. – Amrish Pandey Sep 11 '14 at 12:07",5,5,,
,But effective java says otherwise. informit.com/articles/article.aspx?p=1216151&seqNum=7 – Binoy Babu Dec 14 '14 at 3:08,3,3,,
,This is rather interesting that finally would be called when one re-throws his exception in catch() as new RuntimeException. – Mikhail Krutov Aug 16 '15 at 0:22,,,,
,"@BinoyBabu - That's about finalizer, not finally block – avmohan Jan 5 '17 at 10:17",3,3,,
,What about Runtime#halt ? – gstackoverflow Mar 13 '17 at 8:35,,,,
,"@AmrishPandey ""finally block is not called in case of exception thrown by daemon thread"" - really?? [Citation Needed], I think? – SusanW Apr 25 '17 at 12:59",5,,I think missed out these ones.,ok
,@SusanW javarevisited.blogspot.in/2012/03/… – Amrish Pandey Jun 5 '17 at 16:43,5,,,
,@SusanW docs.oracle.com/javase/tutorial/essential/exceptions/… – Amrish Pandey Jun 5 '17 at 16:45,5,,,
,"@AmrishPandey The Oracle page doesn't mention daemons at all. The other (blogger) page discusses a JVM terminating, but fails to go on to show any difference vs a non-daemon thread. Reality is: on System.exit completion (incl shutdown hooks) or other termination, all threads just die where they are standing whether daemon or not: no finallys get executed either way. The blogger is incorrect where they note this as a difference ... try it yourself. – SusanW Jun 5 '17 at 18:21",5,,,
,"@SusanW - Correct. The reason that the daemon thread is not executing finally in that example is reason 3). It is in an infinite loop. If the loop wasn't there, then it could also fail to execute the finally for reason 1). When main method returns (and there are no non-daemon threads) it executes System.exit() ... or the equivalent. Bottom line: daemon threads are NOT an exception to the reasons given by the Answer above. – Stephen C Aug 20 '17 at 1:16",5,,,
,"Infinite loop is not really an exception to the ""finally will be called when try block finishes"" rule. Even with an infinite loop in the try block, the finally block still will execute when the try block finishes, as usual - the try block just does not finish. This is not a special case. – Loduwijk Jan 3 '18 at 15:17",5,,,
,"""The host system dies; eg. power failure, hardware error..."" is not really an exception to the finally block rule either. That's like ""will return 1+1 always return 2?"" ""Not necessarily; a power loss can stop return 1+1 from returning 2."" ... not really a part of the answer. Same thing with #4, the kill -9 example; it is sufficient for #4 and #5 both that #2 ""JVM crash"" is listed, which could be worded ""JVM terminates abruptly"" to better catch all situations. – Loduwijk Jan 3 '18 at 15:20",5,,,
,finally is also executed when a StackOverflowError is thrown. – MC Emperor Feb 28 '18 at 15:00,,,,
,"Java'sSystem.exit(); (like C#'s or PHP's) can be confusing for developers coming from other programming languages. In Python sys.exit() raises a (regular) SystemExit exception that can be catched. In Pascal exit is a regular control statement, and finally will be executed too. – Dávid Horváth May 3 '18 at 14:04",,,,
,"@MCEmperor, to piggy-back on this, although finally is executed even after a StackOverflowError, frames added to the stack within a finally block can cause an unexpected additional StackOverflowError, leading to the remaining contents of the finally block being skipped. For this reason, StackOverflowError errors can be quite dangerous. We recently ran into a difficult issue with semaphores not being released in a finally block for this very reason. – Mike Hill Aug 1 '18 at 15:15",,,,
,"Q: Does it always? A: Yes, except... To me this means the accepted answer should be no. If there is exceptions to always, then its no. It may run most of the time. But not always. I am surprised I am one of few to react on this. – JugsteR Aug 14 '18 at 7:27",,,,
,"Also, finally won't be called if the world ends before the execution reaches the finally block... – Nishit Aug 28 '18 at 17:19",,,,
,"@JugsteR All of the cases when it doesn't is when something crazy happens like someone force killing the process, it entering an infinite loop, or the power going out. To me, if it behaves a certain way except in those most extreme of edge cases it's fine to say ""yes always, except..."" instead of ""no"". Actually, in the case of an infinite loop, it would still execute the finally, it's just that it never finishes what it's doing before it. – Captain Man Sep 13 '18 at 18:26",,,,
,"If the machine is suspended. If the kernel never again gives the JVM time to execute. There are probably many more edge cases when finally is not executed. This answer gives a good and easy to understand explanation. But it would be easier and more simple to say ""If the try block or try-catch block completes then the finally block is executed."" The JLS uses this same kind of language. – Anonymous Coward Oct 24 '18 at 23:38",,,,
,Can someone shed more light on last point If finally block is going to be executed by daemon thread and all other non daemon threads exit before finally is called.? – anir Nov 4 '18 at 13:11,,,,
,"@anir The JVM itself will terminate when the last non-daemon thread terminates (that's the defn of a daemon thread, btw: it won't prevent the JVM from exiting). So if your daemon thread had entered the try-block, and the last non-daemon terminated, then the JVM will exit and all daemons will abruptly vanish. – SusanW Nov 20 '18 at 22:07",,,,
https://stackoverflow.com/a/1128899/5749570,Except it's O(N) to create the collection in the first place :) – Drew Noakes Apr 25 '11 at 6:54,1,1,,
,"If it's static, it's probably going to be used quite a few times. So, the time consumed to initialise the set has good chances of being quite small compared to the cost of a lot of linear searches. – Xr. Oct 12 '11 at 19:39",2,2,,
,Creating then the collection is going to be dominated by code loading time (which is technically O(n) but practically constant). – Tom Hawtin - tackline Mar 7 '12 at 13:23,4,4,,
,"@TomHawtin-tackline Why do you say ""in particular here we want a set""? What is the advantage of a Set (HashSet) in this case? Why is a ""reference array"" bad (by ""reference array"" do you mean an ArrayList backed by an array as generated by a call to Arrays.asList)? – Basil Bourque Aug 29 '14 at 5:04",4,4,,
,"@BasilBourque The problem trying to be solved is determining whether a value is within a set of values. A Set is a very good fit. / By ""reference array"" I mean a Java language array of reference types. Arrays of primitives, whilst not great, are a bit short of efficient alternatives without some necessary clunky library. A later version of Java could support immutable selfless/value types, which would change things. – Tom Hawtin - tackline Aug 29 '14 at 13:29",4,4,,
,isn't this lookup actually O(log(n)) – nmr Sep 9 '14 at 21:49,3,3,,
,"@nmr A TreeSet would be O(log n). HashSets are scaled such that the mean number of elements in a bucket is roughly constant. At least for arrays up to 2^30. There may be affects from, say, hardware caches which the big-O analysis ignores. Also assumes the hash function is working effectively. – Tom Hawtin - tackline Sep 9 '14 at 23:51",3,3,,
,"you have to iterate the array to create the collection. O(n). You can then argue that amortized or simiar this evens out, but you must have an O(n) step somewhere. – Thorbjørn Ravn Andersen Jul 5 '15 at 11:22",3,,I think you missed out this one. Rests are in sync.,ok
,"This answer is completely right. The point most of the commenters miss is that if you were placing the objects into a collection in the first place it wouldn't be much more time than creating the array was. Just avoid using arrays unless you are absolutely sure nothing else will do (For performance purposes), using an array because you think it will be faster without testing to see if the collection is actually too slow in the first place is a perfect example of premature optimization. – Bill K Sep 24 '18 at 20:44",,,,
,For me this solution with Set is way more elegant than the accepted answer. Thanks. – Paulo Oliveira Jun 11 '19 at 14:21,,,,
,"This doesn't answer the question about the array. You just say ""don't use arrays"" which is not a solution. Additionally, you just say ""X is bad"" but don't explain why which is always bad for an answer. – Minn Aug 18 '19 at 20:37",,,,
,"At least in the OpenJDK implementation, the four-parameter Set.of method doesn't return a HashSet data structure; for so few elements, that would not be efficient. See the code here: hg.openjdk.java.net/jdk9/jdk9/jdk/file/86f19074aad2/src/… – kaya3 Oct 31 '19 at 1:29",5,5,,
,"@kaya3 Good. Big-O is for sufficiently large (i.e. quite large) n. I believe C# has had some kind of hybrid implementation from day 1, or perhaps 2.0. – Tom Hawtin - tackline Oct 31 '19 at 2:08",5,5,,
https://stackoverflow.com/a/285184/5749570,So I supposed it's not possible to call a super constructor and another constructor of the same class as both need to be the first line? – gsingh2011 Nov 2 '12 at 18:02,1,1,I think we need to discuss these. So I have classified all of these ones into group 1 because the core theme of these comments is about calling an overloaded constructor in the first line of another constructor.,i disagree; they are discussing constructor overloading but there are subtle differences
,@gsingh2011: Indeed. You can only chain to one other constructor. – Jon Skeet Nov 2 '12 at 18:06,1,1,,
,"This has to appear on the first line, but you can do calculations in the constructor before it is called: You can use static methods in the arguments of this() on the first line and encapsulate any calculation which has to be performed before the call to the other constructor in that static method. (I have added this as a separate answer). – Christian Fries Mar 11 '13 at 20:34",1,2,,
,"@gsingh2011 I know it's late but as a way around, you can call overloaded constructor using this(...) and then in that overloaded constructor, you can make a call to base class' constructor using super(...) – Ali May 13 '13 at 7:23",1,1,,
,@JonSkeet Yes! we can chain to one other constructor but actually we can have a very long chain – Trikaldarshi Jul 16 '13 at 21:38,1,5,,
,@Mohit: And why is that a problem? It's really not clear what the context of your comment is... – Jon Skeet Jul 16 '13 at 21:46,1,5,,
,"no not a problem i just added up to your comment that said ""only one other constructor"" so for many others create a long chain – Trikaldarshi Jul 16 '13 at 22:13",1,5,,
,It is mandatory that if you are using this() or super() they must be the first statement of the constructor and both can not be used in a constructor. – Harshit Gupta Jun 27 '15 at 11:18,1,,,
,"@gsingh2011 yes, for some reason only a single constructor of a class is allowed. – Francis Jun 28 '15 at 16:01",1,,,
,"@Francis: I assume you mean ""you can only chain to one other constructor"" - currently your statement makes it sound like you can only have one constructor per class, which is clearly not true. – Jon Skeet Jun 28 '15 at 16:32",1,,,
,@JonSkeet yup I meant chaining to one other constructor only. thanks for the correction and I apologize for my misleading statement. – Francis Jun 29 '15 at 11:06,1,,,
,"@Francis I'm not sure, but I believe the reason is that if the first line of the constructor delegates to another constructor or calls a superclass constructor, it actually runs before the object is constructed. C++ has the same limit, you can only have one call to a parent class constructor or (as of C++11) one delegation per constructor, and no more, with both executing before the object is constructed. – Justin Time - Reinstate Monica Feb 9 '16 at 18:50",1,,,
,"@JustinTime: You'd have to define what you mean by ""before the object is constructed"" for me to be able to judge the truth of that... – Jon Skeet Feb 9 '16 at 18:52",1,,,
,"@JonSkeet I mean that going from what I know of Java, delegation or superclass constructor calls are executed before the object's fields are initialised and it's put into a state where it's considered to be ""constructed"". Specifically, I believe the process is: 1) Run parent class/superclass constructor to initialise inherited portion of the class, 2) Initialise instance-specific member variables so the object is valid, so member access in the constructor's body won't break anything, 3) Execute body of constructor to finish construction. It's considered constructed by the end of step 3. – Justin Time - Reinstate Monica Feb 9 '16 at 18:59",1,,,
,"In that regard, I believe it works in the same manner as C++ (construct inherited portion, initialise object from initialisation list, run body of constructor), but with cleaner, but less specific, syntax (the initialisation list is moved to the top of the constructor's body, instead of being after the signature but before the body), with delegation passing the job of actually creating the object to the other constructor, and then running any code in the delegating constructor on a valid object after the constructor it delegates to returns. Correct me if I'm wrong. – Justin Time - Reinstate Monica Feb 9 '16 at 19:01",1,3,,
,"@JustinTime: Again, it depends on what you mean by ""creating"" - the object is ""created"" in that its memory is allocated and the type is set before any constructor bodies are executed. Constructors are initialization rather than creation. In particular, the type of the object is its ""final"" type right from the start - so if you call any virtual methods from constructors, you'll get the most-specific override called. I believe this differs from C++. – Jon Skeet Feb 9 '16 at 19:06",1,3,,
,"By creating the object, I mean allocating memory, setting the type, and initialising fields, so that the object is in a valid, usable state (the implicit first step of every constructor), with delegation passing the job of making the object valid & usable onto the constructor that's delegated to. Didn't know that objects don't start as their actual type in C++, but it makes sense considering how C++ implicitly chains parent class constructor(s) to construct the inherited portion of a derived class before actually executing the derived class' constructor; I guess I'll have to be wary of that. – Justin Time - Reinstate Monica Feb 9 '16 at 19:15",1,3,,
,"I know I am coming late to the comment section, but I don't understand why new Foo(1); wouldn't work ? – Andrej Sep 26 '19 at 19:07",2,4,,
,"@Andrej: That would indeed be ""calling one constructor from another"" but it wouldn't be doing what the OP wants, which is to initialize a single object via multiple constructors, one chaining to another. Creating two objects by just creating a separate object within one constructor call isn't the same thing at all. – Jon Skeet Sep 26 '19 at 22:10",2,4,,
https://stackoverflow.com/a/285187/5749570,"If many constructor parameters are used, consider a builder. See Item 2 of ""Effective Java"" by Joshua Bloch. – koppor Nov 13 '12 at 20:16",1,1,"Both of these comments recommend builder pattern. So they should be in the same group. if you change it to group 1, the rests of the comments will come in sync.",ok
,"The problem with the implementation of the last approach using the factory method, newCons, is that you are trying to change state of an object, using setArg1(...), that should most likely have its fields set as final. As we are trying to keep as much as possible of an object immutable, if not completely, a builder pattern will address this issue more correctly. – YoYo Jan 30 '16 at 6:46",1,2,,
,"Wouldn't you rather do :: public Cons() { this(madeUpArg1Value,madeUpArg2Value); } – LordHieros Apr 16 '18 at 13:31",3,4,,
,Initialization should proceed from least to greatest - I would never have a default constructor call up the chain to a multi-parameter constructor. What needs to happen is that all constructors call either the default or a constructor with less parameters. – Rodney P. Barbati Apr 23 '18 at 18:17,2,3,,
,"@RodneyP.Barbati It's pretty common in Java for lower-arity constructors to call greater-arity constructors and then do nothing else. if a class K has, e.g., two final fields a, b, then the ""general constructor"" would be K(A a, B b) { this.a = a; this.b = b; }. Then, if b has a reasonable default, there can be a one-arg constructor K(A a) { this(a, DEFAULT_B); }, and if there's a default a as well, we have a default constructor: K() { this(DEFAULT_A); }. That's a pretty common convention in Java. – Joshua Taylor May 17 '18 at 13:12",2,3,,
,"@RodneyP.Barbati If you have a final field (so that it must be set), then the default constructor would have to set it. If your higher-arity constructors call the default constructor (which would have to be done before anything else), then the higher-arity constructors never have any options to set any of those fields. – Joshua Taylor May 17 '18 at 13:14",2,3,,
,This one works with Android Studio while the accepted answer does not. Not sure why. – Hong Dec 4 '18 at 20:03,4,5,,
https://stackoverflow.com/a/541506/5749570,"Exactly, well put. What behavior are we trying to overwrite in Thread by extending it? I would argue most people are not trying to overwrite any behavior, but trying to use behavior of Thread. – hooknc Feb 12 '09 at 16:50",1,1,,
,"As a side comment, if you instantiate a Thread and do not call its start() method you are creating a memory leak in Java < 5 (this does not happen with Runnables): stackoverflow.com/questions/107823/… – Nacho Coloma Feb 7 '13 at 13:48",2,2,,
,"One minor advantage of Runnable is that, if in certain circumstances you don't care about, or don't want to use threading, and you just want to execute the code, you have the option to simply call run(). e.g. (very handwavy) if (numberCores > 4) myExecutor.excute(myRunnable); else myRunnable.run() – user949300 Mar 6 '13 at 19:30",3,3,,
,@user949300 you can also do that with extends Thread and if you don't want threading why would you even implement Runnable... – m0skit0 Apr 23 '13 at 8:15,3,3,,
,"I would also add that by implementing Runnable now rather than extending Thread, you make it easy for a future refactor of using thread-pools, timers, schedulers, and Executors. – brettw Jul 18 '13 at 3:46",4,,Both recommend implementing Runnable rather than extending Thread.,ok
,"To paraphrase Sierra and Bates, a key benefit of implementing Runnable is that you are architecturally seperating the ""job"" from the ""runner"". – 8bitjunkie Feb 12 '14 at 9:28",4,4,,
,"Another addition to the ""practical terms"" bit: a Runnable is, really, an encapsulation of any bit of code. Under certain circumstances, it may be useful to run a Runnable even when not within the context of a new thread. – Isaac May 24 '14 at 1:35",6,,,
,@m0skit0 the point of the code by user949300 is that it uses a conditional to only enable multi-threading when there are enough physical core – lolski Aug 18 '14 at 15:34,3,,I think you might have missed out this set of comments. They specifically refer to the user of a comment of group 3 earlier.,yes
,"@lolski My point being you can do that extending Thread or implementing Runnable, so really doesn't matter. – m0skit0 Aug 18 '14 at 15:56",3,,,
,"@m0skit0: It doesn't matter if you don't care about your code expressing what you're interested in. Personally I care about that very much. Yes, you can extend Thread just to implement Runnable... heck, you can pass one Thread instance to the constructor of another Thread instance. That doesn't mean it's a good idea. – Jon Skeet Aug 18 '14 at 16:03",3,,,
,"@JonSkeet Sorry, I didn't mean it doesn't matter to extend Thread or implement Runnable, I meant that that was not a valid argument for implementing Runnable :) – m0skit0 Aug 18 '14 at 17:15",3,,,
,"@m0skit0: What wasn't a valid argument for implementing Runnable? You implement Runnable if you want to represent ""something that can be run"" - it doesn't necessarily have to be in a new thread. – Jon Skeet Aug 18 '14 at 17:32",3,,,
,"Note that sometimes you (conceptually) are creating ""runners"", not ""jobs"". E.g. if you're writing a thread pool (for whatever reason). – user253751 Feb 12 '15 at 23:51",3,,,
,"@JonSkeet i'm currently creating a class that handles Threads, for example: pastebin.com/QNc8xY46. is it OK, or terribly wrong to do so? – homerun Mar 3 '15 at 11:48",5,5,,
,"@somefolk: Well it feels terribly wrong to have public methods beginning with _, and having both start() and _start() is really confusing... as is having an instance method called _sleep(), when there's a static sleep method. Not that your _sleep method actually does anything with the instance anyway. In general, this looks like a bad idea to me so far. – Jon Skeet Mar 3 '15 at 11:50",5,5,,
,The same answer is in official Java tutorials: docs.oracle.com/javase/tutorial/essential/concurrency/… – greenmarker Jun 27 '15 at 18:02,,,,
,"A thread that performs a specific task ""is a"" thread in the object oriented Liskov substitution sense, so the philosophical argument is invalid. The valid arguments for preferring Runnable are practical, and have to do with modularization of code, especially in cases where you only want multithreading for performance reasons. – Warren Dew Oct 20 '15 at 16:35",,,,
,"I know this is an old post, but I feel maybe you could elaborate a little more @JonSkeet give code snippets, pros and cons. As I believe some other answers are more worthy! – Small Legend May 21 '16 at 14:31",,,,
,"@SmallLegend: I don't see any benefit in code snippets here - I've basically explained the philosophical difference. You should generally extend a class if you're planning to change some of the behaviour it implements. When you extend Thread just to override Runnable, you're changing behaviour that isn't part of Thread itself. – Jon Skeet May 21 '16 at 14:33",,,,
,"Okay, you know best! So generally, there are no situations where one would choose Thread over Runnable? @JonSkeet – Small Legend May 21 '16 at 14:36",,,,
,"@SmallLegend: Well if you were customising the actual threading behaviour you could, rather than just ""the task that it's going to run"". Not sure what custom threading behaviour you would implement, admittedly... – Jon Skeet May 21 '16 at 14:44",,,,
,"I think that composition being philosophically purer is an argument for extending an object. Since this answer is saying implementing Runnable is preferred to extending Thread, perhaps composition has nothing to do with the rationale. – H2ONaCl Oct 6 '16 at 22:48",,,,
,"@H2ONaCl No, absolutely the opposite. Preferring composition over inheritance speaks against extending anything. – Jon Skeet Oct 6 '16 at 22:57",,,,
,Will there be any difference in the execution times between the two approaches? – AV94 Nov 18 '16 at 4:39,,,,
,"@AV94: Not measurable, I expect. – Jon Skeet Nov 18 '16 at 7:24",,,,
,"If you make an extend thread that prints out ""hello"" - and make a class that implements runnable - that prints out ""hello"", does that mean this is still true: ""You're not really specialising the thread's behaviour"" ?. I mean is there some mechanical things behind the scenes that make them different - or did Jon Skeet mean that you can potentially write more kind of code in an thread that extendend - and that that therefore have a greater risk of being screwed up with? How would telling an extend thread to print hello be more specializing than telling runnable to print hello? How? – Lealo Aug 13 '17 at 21:53",,,,
,"@Lealo: Implementing an interface isn't specialization... It's just providing the behaviour. The point is to separate the infrastructure involved in running ""some code"" on different thread, and what that code is. They are orthogonal concerns, so shouldn't be merged together via inheritance, IMO. I suspect if Java were redone from scratch today, this wouldn't even be an option. – Jon Skeet Aug 13 '17 at 21:57",,,,
,"Can you relate your point to the size of an thread that extends a class - to implementing the runnable interface. The thread class already contains the runnable interface. So I assume it somehow are bigger in size. By using extended thread you need (Thread: runnable interface - extending java.lang.object), but you can take out that runnable interface and use it independently. Also is this not then just as comparing (ice cream) with (ice cream + ice cream hornet)? – Lealo Aug 14 '17 at 0:23",,,,
,"@Lealo: The size is irrelevant to the point here. Yes, Thread implements Runnable, but that was a design mistake IMO. – Jon Skeet Aug 14 '17 at 5:35",,,,
,"@8bitjunkie But what if your ""unit of work"" is a ""runner""? For example the ""work unit"" done by the threads in a thread pool, which pulls other work units off a queue and executes them, forever. – user253751 Dec 2 '19 at 18:13",,,,
https://stackoverflow.com/a/604426/5749570,"For reference, the Blah.valueOf(""A"") method is case sensitive and doesn't tolerate extraneous whitespace, thus the alternate solution proposed below by @JoséMi. – Brett Dec 17 '13 at 17:37",1,1,,
,"@Michael Myers, Since this answer is the most voted up by far, should I understand that it's good practice to define an enum and its String value to be exactly the same? – Kevin Meredith Feb 12 '14 at 21:24",3,3,,
,"@KevinMeredith: If you mean the toString() value, no, I wouldn't say that. name() will get you the actual defined name of the enum constant unless you override it. – Michael Myers♦ Feb 14 '14 at 4:10",3,3,,
,"What exactly do you mean by ""are created at compile time and do not appear in source code."" ? – treesAreEverywhere Mar 7 '14 at 0:43",2,2,,
,"@treesAreEverywhere More specifically, those methods are generated (or synthesized) by the compiler. The actual enum Blah {...} definition shouldn't try to declare its own values nor valuesOf. It's like how you can write ""AnyTypeName.class"" even though you never actually declared a ""class"" member variable; the compiler makes it all Just Work. (This answer may no longer be useful to you 3 months later, but just in case.) – Ti Strga May 30 '14 at 19:31",2,2,,
,"Great answer--in addition I've found adding a few little helper methods to enums helps a lot... For instance, if you create a static map of lower-case entries in the constructor then you can add a method that looks the enum up in a case-insensitive way, or converts underbars to spaces so user input like ""Second Entry"" could map to an enum SECOND_ENTRY. – Bill K Nov 19 '15 at 17:39",4,4,,
,"Why does @Brett's comment have so many votes? Of course it's case sensitive and doesn't tolerate extraneous whitespace, anything else would be insane. – nemetroid Jun 29 '17 at 8:54",6,,,
,"@nemetroid Not that insane, given that whitespace is not allowed in names and that all enum names are uppecase by convention. So a tolerant lookup method is possible as the result stays unique. However, users may require something even more tolerant and therefore it's best to provide a canonical strict version (and there are other problems like uppercasing being locale-sensitive and whatever). – maaartinus Aug 21 '18 at 22:48",6,,,
,"Upvote, but this post would be even better with a mention of Enum::name – Bex Aug 22 '18 at 14:27",5,5,,
https://stackoverflow.com/a/886979/5749570,"This does jump to directly after the loop. Try it! Yes, the label comes before the loop, but that's because it's labeling the loop, rather than the place you want to exit to. (You can continue with a label too.) – Jon Skeet May 20 '09 at 9:15",1,1,,
,Perl also does permits this its own label system. I think a lot of languages do -- it hardly surprises me that it is in Java. – Evan Carroll Dec 6 '11 at 22:53,2,2,,
,"@Evan - that claim is clearly true - in languages that promise that it's true. But Java doesn't make that promise. If a language is in conflict with your assumptions, it's possible that it's your assumptions that are at fault. In this case, I think you're still partly right - principle of least surprise WRT the many who never heard of (or forgot about) that form of break. Even then, exceptions are another better-known exception (sorry). But I'd still be unhappy about this if it wasn't obvious (small loops, warning comment if the label/break still aren't visible enough). – Steve314 Dec 7 '11 at 0:40",2,2,,
,"@boutta - Ada has this style of break spelled with an exit <optional-label> when <condition>; statement, and it has a goto, so you can put the label either end of the loop. IIRC, goto is much more frowned on than the exit version though. Even for exit, some people will beat you with a pretty big stick for using a ""hidden goto"", but if you use a blatant goto... – Steve314 Dec 7 '11 at 0:48",,,,
,"Well one Jon skeet answer I don't like much, as I don't want to go through a code like this with all those labels.. But upvoted since it is allowed in the language.. – Krishnabhadra Jan 8 '13 at 12:08",,,,
,JonSkeet or @BGR Why are break labels not ok? Or why do you prefer the other way? – JWiley Mar 19 '13 at 18:32,5,5,,
,@JWiley: I usually find it's easier to read a method which returns from the middle of code. – Jon Skeet Mar 19 '13 at 18:45,5,5,,
,"@JWiley. Same here; easier to read: when you ""hit"" return, you can stop reading - easier to maintain: when fixing something before the return, you do not have to worry for side effects outside of the loop. IMHO, returning fast usually leads to more compact, simpler code. – Bruno Grieder Mar 20 '13 at 10:05",5,5,,
,"In Dijkstra's ""Goto considered harmful"" paper, what he specifically objected to was the labels, not the goto. He observed that the number of bugs seems to increase with the number of labels in a program, and that labels and gotos make programs difficult to analyze. – erhun Aug 5 '14 at 20:12",,,,
,What is outerloop? No type? Even i tried to do same syntax error! – Muhammad Babar Feb 2 '15 at 10:43,3,3,My mistake. Fixed it. Now we are in sync.,ok
,"@MuhammadBabar: outerloop is a label. I don't know exactly what code you tried, but the code in my answer compiles and runs just fine. – Jon Skeet Feb 2 '15 at 10:47",3,3,,
,Does this paradigm work for breaking out of a loop inside a switch-case statement that is part of the loop? – Bruce Wayne Jul 16 '15 at 17:11,,,,
,"@Bruce: I suspect so, but I suggest you just try it. – Jon Skeet Jul 16 '15 at 17:42",,,,
,"@erhun, Regarding labels, I would think that ""break to"" or ""continue to"" would be inherently more readable than ""go to"", since the places you can break to or continue to are few and straightforward to find. – Earl Zedd Nov 13 '15 at 0:00",,,,
,"@MinhasKamal: Please stop edits with things like putting ""EDIT"" in bold for no reason, and quoting pieces of output. Your proposed edit was no clearer, and clearly conflicted with my intended indentation etc. – Jon Skeet Mar 19 '16 at 14:18",,,,
,"""break outerloop"" == ""goto"" statement. uurgh! I use booleans as an explicit trigger to terminate a loop in the for statement when i have nested loops, single point of exit out of an inner loop and then further tests outside of each loop achieve the same thing, but IMHO is better for maintainability. Each to their own.. – angryITguy Jun 14 '17 at 2:41",,,,
,"It's a matter of readability. And I think the labeled break is perfectly readable, it explicitly declares the block it wants to leave, so to me it's even clearer than the unlabeled break. Having said that, if the nested loops fulfill some purpose that can be expressed with a method name (and doesn't need to pass a dozen of parameters), introduce the method. But I'd definitely prefer the nested loops with labeled break to a method that's named ""loop"". – Ralf Kleberhoff Jul 30 '17 at 10:38",,,,
,"I have sonarLint plugin installed in my IDE, while using break with label, sonarLint gives it as a major codeSmell and when I look at the description provided, it says Labels are not commonly used in Java, and many developers do not understand how they work. Is the reason provided legit? – Nisarg Patil Jan 19 '18 at 7:22",4,4,My mistake. Fixed it. Now we are in sync.,ok
,"@NisargPatil: The reasoning seems sound, although I don't think I'd call it a ""major code smell"". As per the start of my answer though, I'd prefer to just put it in a separate method. – Jon Skeet Jan 19 '18 at 7:25",4,4,,
,"Maybe you meant ""put both loops in a different method (or only body of the outer loop in case continue needed instead of break)""? – John McClane Dec 5 '18 at 3:24",,,,
,"@JohnMcClane: It's hard to know exactly what I meant 9 years later, but I suspect you're right. Will edit. – Jon Skeet Dec 5 '18 at 7:27",,,,
,"@NisargPatil Just because it is in sonarLint doesn't make it a code smell. It just means there was a developer that added this to sonarLint with a personal itch to scratch, and it is full of these kinds of rules that only make sense when abused, or because some developer has a personal hate crusade against them. Labelled breaks and continues are a very elegant way to describe what you want to do. – john16384 Feb 8 '19 at 16:52",4,4,My mistake. Fixed it. Now we are in sync.,ok
,"Unlike many commenters, I find nothing wrong with this construct. It's often clearer than flag variables. It doesn't to my mind have the problem that Dijkstra's complaint about label proliferation. With 1960s-vintage labels and goto, the presence of a label meant control could arrive there from almost anyway. This sort of label is not a jump target, it's just naming a statement. I do however find 'break foo' to be a little odd from readability; BLISS had 'leave foo' for this same construct, which makes much more sense linguistically speaking: we are leaving the statement named 'foo'. – user10762593 Feb 27 '19 at 0:59",,,,
,"Great info, but yeah, I can definitely see why you and other prefer having the loop in a method and returning instead. – Andrew Robie Jul 1 '19 at 14:04",,,,
,"While I do like the return solution, sometimes the label solution is better because it doesn't interrupt the flow of reading (as a separate method would), e.g. if you've got more code before and especially after the loops. @JonSkeet A suggestion: Add another print directly after the inner loop. This way you can ""prove"" that the break actually breaks both loops instead of jumping outside the inner loop and only then breaking the outer loop too. – Neph Oct 23 '19 at 10:30",,,,
,"@Neph: I'd rather not start editing a 10+ year old answer, having to rerun it etc. I haven't seen any sign that people need that ""proof"". The fact that it doesn't show ""3 0"" seems proof enough to me. – Jon Skeet Oct 23 '19 at 10:33",,,,
,"@JonSkeet I just ran it to test it and added the extra print because I wasn't sure how the break would work exactly. Not showing ""3 0"" just means that the inner loop is broken, it doesn't proof that it won't run code after the inner loop (so e.g. the extra print I suggested) before that outer loop is broken too. I can provide an edit for code and prints if you'd like. – Neph Oct 23 '19 at 10:39",,,,
,"@Neph: No, I really don't think it's worth adding the extra output. – Jon Skeet Oct 23 '19 at 11:54",,,,
https://stackoverflow.com/a/215505/5749570,"The table above is incorrect, as even private members can be seen/used by any class/static method in the same source-file. – Usagi Miyamoto Apr 16 '17 at 6:17",I,1,So these comments were integrated in the revised answer. ,"agree, but can we mark I,P,C in a separate column in addition to the cluster number"
,The protected member can only be accessed from subclass of same package but not subclass from different package. There should be a correction in above table – niks Sep 1 '17 at 8:35,I,2,,
,I am still not able to differentiate between 'Public' and 'Protected'. And what is 'World' in this answer. Does it mean access out of project folder in a different project & package?? But that is not taking place. Need help on this. – Deepak Apr 25 '18 at 12:25,2,4,,
,"@Deepak, World is within your project. If you have a class that is public, any other class can instantiate that class. Same as methods. If it is public, anyone that uses that class can use that method. Package refers to the ""folder"" that you are in. So, ca.my.package.controllers is different than ca.my.package.models. Public items are accessible outside of those packages, but the rest are not. package-private are considered public within the package, essentially. Protected means anything that inherits it, or within the same package. Private removes all outside access, including package. – adprocas May 3 '18 at 12:59",2,4,,
,"World is within your project. I should explain further. Libraries are within your project, and if you're creating a library, they would expose these public classes and methods as well. So, saying just within your project is a bit off. ""Everything that uses it"" is a better description. – adprocas May 3 '18 at 13:02",2,4,,
,@adpro - I tried at my end making methods public and protected but both of these types of methods are accessible outside their primary package and user has to extend the parent class in both the cases which is quite obvious. I am still unsure of the difference. A little bit more explanation or trick might help. – Deepak May 4 '18 at 6:23,2,4,,
,"@Deepak, if you are extending (inheriting) the class then that class that is inheriting will have access to all public and protected methods and properties. If you instead instantiate that class in another class (not extend) and try to do something like object.protectedMethod() on a protected method, you won't be able to unless it is in the same package. – adprocas May 4 '18 at 12:22",2,4,,
,"For example, if I have MyClass and I'm doing AnotherClass extends MyClass I will have access to all protected and public methods and properties from within AnotherClass. If I do MyClass myClass = new MyClass(); in AnotherClass somewhere - let's say the constructor - I will only have access to the public methods if it is in a different package. Note that if I do = new MyClass() { @Override protected void protectedMethod() { //some logic } }; it appears that I can access protected methods, but this kind of the same as extending it, but inline instead. – adprocas May 4 '18 at 12:25",2,4,,
,"Unfortunately, this answer is a gross oversimplification. Reality is a bit more complicated, especially when you consider protected (which is actually quite a difficult access modifier to fully understand - most people who think they know what protected means really don't). Also, as Bohemian pointed out, it doesn't answer the question - it says nothing about when to use each access modifier. In my opinion, this answer isn't quite bad enough to downvote, but close. But over 4000 upvotes? How did this happen? – Dawood ibn Kareem Jul 11 '18 at 6:26",1,3,"If you remove the two integrated comments, our annotation will align well. Right now they are 2 apart.",ok
,"Subclass (same package) field is misleading, It's better to remove that column. Because it doesn't matter is that a subclass or not. – Anatolii Stepaniuk Sep 6 '18 at 7:04",3,5,,
,"@DawoodsaysreinstateMonica It's a great answer, it's exactly what most people that find this page are looking for. Also, that table is from the official Oracle tutorial. But how about you toss us a link so we can learn what ""protected"" really means? – Heinzlmaen Feb 6 at 14:58",1,,Reply to Dawood's comment,ok
https://stackoverflow.com/a/17959137/5749570,Can you provide an example case with specific data where you think Days.daysBetween is incorrect? – Basil Bourque Dec 25 '14 at 9:33,I,1,Integrated,"agree, but can we mark I,P,C in a separate column in addition to the cluster number"
,"When you say to use Instant, you're not just talking about start.toInstant(), are you? – Patrick M Feb 10 '15 at 21:44",I,2,,
,"@PatrickM Yes, I was. On reflection, it's not clear exactly what constraints this is intended to impose, so I'll remove that last sentence. Thanks! – Alice Purcell Feb 11 '15 at 23:28",I,2,,
,@chrispy daysBetween doc says it returns number of WHOLE days. In my case 2 days and 1 hour should return me 3 days. In your example it returns 2 days. Is there a way to achieve this? – Sujit Joshi Jun 18 '16 at 20:51,3,3,I think yours is wrong here. All comments have equal votes (0). So we should take total rep points in account.,you are right
,@SujitJoshi I'm afraid I don't understand your question. I suggest posting a full Stack Overflow question and pasting a link here for me :) – Alice Purcell Jun 19 '16 at 21:55,3,3,,
,Beware of dates overlapping with a new year! Days between 31 dec 2016 and 5 jan 2017 gives -361 days. – Sylphe Jan 4 '17 at 17:37,1,4,,
,"@Sylphe No, it doesn't, I just checked. I suspect you typo'd 2017. – Alice Purcell Jan 5 '17 at 12:47",1,4,,
,What if cast to UTC DateTime withTimeAtStartOfDay is it equivalent ? – Oleksandr Albul May 2 '19 at 5:23,2,5,,
,@OleksandrAlbul That will only give you an answer valid in the UTC timezone. – Alice Purcell May 3 '19 at 9:49,2,5,,
https://stackoverflow.com/a/15182578/5749570,"Pedantically, new Random(-229985452).nextInt(27) always returns 8. – user253751 Mar 12 '15 at 2:16",1,1,,
,"@immibis why? i mean Random() should return random number every time, not a fix ordered number set? – roottraveller Mar 7 '17 at 7:22",1,2,@immibis is the same as @user253751. So that means all of these comments should be group 1.,agree
,"@rootTraveller For a start, new Random() doesn't return a number at all. – user253751 Mar 7 '17 at 7:25",1,2,,
,"@roottraveller ""Random"" is a deterministic psuedo-random number generator. If you initialise it with a fixed seed it will produce a fixed sequence of numbers. – plugwash Oct 9 '18 at 13:55",1,2,,
,Is there a way these seeds are calculated? There must be some logic...or is it just brute force. – Sohit Gore Jan 25 '19 at 10:36,2,3,This will align automatically once you fix the above.,ok
,"@SohitGore Given that Java's default Random isn't cryptographically secure (I'm pretty sure it's a Mersenne Twister, but don't quote me on that), it's probably possible to work backwards from ""I want these numbers"" to ""this is the seed I would use"". I've done something similar with the standard C linear congruential generator. – Fund Monica's Lawsuit Jun 27 '19 at 20:06",2,3,,
https://stackoverflow.com/a/15182511/5749570,"Was this something the people who designed Java intentionally did (as an Easter egg?) It's just a bit mind-blowing that you could possibly product the Hello, world String, which just happens to be the most favourite string in any programming languages. – One Two Three Mar 3 '13 at 4:44",4,2,There is another group ahead of this,ok
,"@Vulcan - the javadoc says that the seed is 48 bits. docs.oracle.com/javase/7/docs/api/java/util/Random.html. And besides, the actual seeds are 32 bit values. – Stephen C Mar 3 '13 at 4:58",2,3,This comment has 8 votes - the most votes after group 1. So it should be group 2.,ok
,"Each element of the random number sequence is taken modulo 27, and there are 6 elements in each of ""hello\0"" and ""world\0"". If you assumed a truly random generator, the odds would be 1 in 27^6 (387,420,489) of getting the sequence you were looking for -- so it's pretty impressive but not quite mind-blowing! – Russell Borogove Mar 3 '13 at 7:48",1,1,,
,"@RussellBorogove: But with those odds, and 2^64 possible seeds, there are an expected 47.6 billion seed values that give that sequence. It's just a matter of finding one. – dan04 Mar 3 '13 at 17:54",1,1,,
,"@dan04 -- I wasn't quite willing to make that estimate; depending on the implementation of the PRNG, the size of the seed word might not equal the size of the state, and sequence paths might not be evenly distributed. But still, the odds are definitely good, and if you couldn't find a pair you could try again with different casing (""Hello"" ""World""), or using 122-k instead of 96+k, or... – Russell Borogove Mar 3 '13 at 18:15",1,1,,
,"@OneTwoThree It's almost always very important that a random number generator can be predictable when needed, as it's very hard to test things otherwise, as running the same code twice can produce different results. Using seeds in PRNGs means you can use a specific seed when testing (or at least report the seed so a result can be reproduced), and then later you can use a seed which will change - e.g. new Random() uses a seed taken from the current time. – user1020786 Mar 4 '13 at 8:55",4,5,Discrepancy due to above error.,ok
,Note that the javadoc does not specify the exact details of the implementation. Hence you cannot rely on this being portable across JVM implementations. – Thorbjørn Ravn Andersen Aug 26 '13 at 7:28,3,4,,
,"@ThorbjørnRavnAndersen The Javadoc specifies that ""particular algorithms are specified for the class Random. Java implementations must use all the algorithms shown here for the class Random, for the sake of absolute portability of Java code."" – FThompson Aug 27 '13 at 3:05",3,4,,
https://stackoverflow.com/a/3295517/5749570,"Right on, in my opinion almost all documentation revolving around beans can't describe the term as concisely as you have. +1 – AndaP Sep 20 '12 at 12:42",P,1,"I think it is a pure P. If I call it group 1 like you do, the rests of the annotations align well.","good. please put P,I,C in another column"
,Is it required for the members of a bean to also be beans? Seems like a reasonable requirement.. – worldsayshi May 6 '13 at 8:01,1,2,,
,"@worldsayshi - No, it's not required. For example a bean can contain a String; and String is not a bean. (String is immutable, so you cannot create it by calling an empty constructor and a setter.) It seems reasonable that a Serializable object should have Serializable members, unless it somehow serializes them from outside. So no, Java bean members do not need to have any aspect of Java beans. Although it is more simple if they are beans, too. – Viliam Búr Aug 2 '13 at 5:46",1,2,,
,"""All properties private"" is not correct. Properties are inferred from the getters and setters (if there is a method X getFoo() -> the bean has a readable property called ""foo""; if there is a method setFoo(X foo) -> the bean has a writeable property called ""foo""). Properties can be backed by member fields (but don't have to be) which are usually private. – Puce Dec 1 '15 at 16:19",2,3,,
,"I hope for being a Java bean ""a class must be Public"". And is it really need that it should implement Serializable Interface?? – Satyabrata sahoo May 27 '16 at 7:12",I,5,Integrated,
,"It sounds as if you should not declare state variables final, because you have a no-args constructor. Is this right? – ncmathsadist May 29 '16 at 17:09",3,4,,
,"@ncmathsadist, yes, that must be the case. – Paul Wintz Jun 2 '17 at 18:22",3,4,,
,Thanks a lot! Why did I have to search everywhere to get to this? Why cannot people be as to the point as you have been with your answer?!! Such a hugely un-intuitive term for such a simple standard. – mavili Nov 5 '18 at 14:28,P,,Praise,
,"@Puce I think that misnomer is due to the fact that in other OOP languages, member fields are called properties (JavaScript, PHP) or instance variables (Python). People seem to use these terms interchangeably. – OzzyTheGiant Apr 12 '19 at 13:32",2,,I think you missed out these 2.,ok
,"That's all very concise, clear and nice; however, nowadays, a lot of people (in courses, tutorials, or even talks) refer the the @Entity (javax.persistence.entity) as to the Javabean class annotated with @Entity (for ORM mapping).. and.. @Entity classes do not implement java.io.Serializable.. that's what usually confuses me a bit, as I'm a very picky and perfectionist type of person. Is @Entity a Javabean or something close to Javabean? – Giorgi Tsiklauri Dec 8 '19 at 8:02",4,,,
https://stackoverflow.com/a/11227902/5749570,@phonetagger Take a look at this followup question: stackoverflow.com/questions/11276291/… The Intel Compiler came pretty close to completely getting rid of the outer loop. – Mysticial Jul 10 '12 at 17:08,1,1,,
,@Mysticial How does the train/compiler know that it has enter the wrong path ? – onmyway133 Aug 6 '13 at 9:07,,,,
,"Under the modern C and C++ standards, the shifting hack is actually not implementation-defined behavior, but undefined behavior! Shifting a 1 in or out of the sign bit of a signed integer is no longer permissible. – Phil Miller Aug 18 '13 at 20:57",4,4,,
,@Novelocrat Only half of that is correct. Shifting a 1 into the sign-bit when it is zero is indeed UB. That's because it's signed integer overflow. But shifting a 1 out of the sign-bit is IB. Right-shifting a negative signed integer is IB. You can go into the argument that that C/C++ doesn't require that the top bit be the sign indicator. But implementation details are IB. – Mysticial Aug 18 '13 at 21:04,4,4,,
,"@Mystical readability of the 'hack' can be increased by introducing a method. E.g. in java private int sumIfGreaterThan128(int curSum, int value). The JIT compiler will inline it at runtime anyway. I guess in other languages there are equal optimizations available. – René Link Jan 24 '14 at 10:15",,,,
,"@Unheilig Using bitwise operations for anything other than legitimate bit manipulation or multiplying/dividing by a variable power-of-two is not something I usually recommend since it's often obfuscating. Nevertheless, here's a good reference for bit twiddling hacks: graphics.stanford.edu/~seander/bithacks.html – Mysticial Mar 8 '14 at 19:53",3,3,,
,"@Mysticial Thanks so much for the link. It looks promising. I will go though it. One last request. Sorry, but please don't mind, could you tell me how you could do this int t = (data[c] - 128) >> 31; sum += ~t & data[c]; to replace the original if-condition above? – Unheilig Mar 8 '14 at 20:05",3,3,,
,"@obe: Given hierarchical memory structures, it's impossible to say what the expense of a cache miss will be. It might miss in L1 and be resolved in slower L2, or miss in L3 and be resolved in system memory. However, unless for some bizarre reason this cache miss causes memory in a non-resident page to be loaded from disk, you have a good point... memory hasn't had access time in the range of milliseconds in about 25-30 years ;) – Andon M. Coleman Apr 19 '14 at 12:17",,,,
,"Would the conditional be faster than the hack if there was no branch prediction? The conditional would be (check) (jump) (add), whereas the hack uses 4 consecutive arithmetic operations – woojoo666 Jun 19 '14 at 23:33",,,,
,@woojoo666 That would depend on how expensive the 4 operations are with respect to the branch handling logic. So it'll probably vary on a case-by-case basis. – Mysticial Jun 19 '14 at 23:45,,,,
,"Isn't it possible to execute both branches in parallel and later stop execution of one wrong branch, Instead of predicting one branch? – naveejr Jul 8 '14 at 5:33",,,,
,"@Tuğrul I would assume that for a given particle the chance that it collides with another particle is less than 1%. Then the branch prediction could just always predict no collision and would be >99% correct, whether sorted or not. In the end for fast collision check you'll want to use a tree structure anyways. – matec Sep 27 '14 at 19:23",,,,
,"I wonder why is the branch prediction concept in place, what is the use of the (Branch Prediction)concept ? I mean without it we would get definite result with the sorted and unsorted array. – Code Geek Nov 7 '14 at 17:52",,,,
,"When does branch prediction takes place? When does language will know that array is sorted? I'm thinking of situation of array that looks like: [1,2,3,4,5,...998,999,1000, 3, 10001, 10002] ? will this obscure 3 increase running time? Will it be as long as unsorted array? – Filip Bartuzi Nov 9 '14 at 13:37",5,,These 2 comments have a total upvote score of 17 + 21 = 38.,ok
,"@FilipBartuzi Branch prediction happens in the processor while it is running the code. The language doesn't know anything. In your example, it will still be fast because you're only adding 1 or 2 mispredictions on and around the 3. – Mysticial Nov 9 '14 at 17:49",5,,,
,"@BJHomer I tried it with Clang 3.5: debug sorted 9.3s, debug unsorted 24.6s. O2 sorted 5.0s, O2 unsorted also 5.0s. So it seems like Clang is able to optimize the loop well. The branchless version from the post took 13s for debug, 4.1s for O2, with almost no difference between sorted/unsorted. – Tomas Andrle Nov 25 '14 at 15:32",,,,
,"This may be out of scope of this Q/A, but are there modern processors that will continue down both paths a short ways when the branch prediction reports similar odds for each branch? If not, why not? It would seem that spare cycles gone into ensuring the branch is ready in time is better than guessing incorrectly or just waiting around. – Slipp D. Thompson Jan 17 '15 at 22:54",,,,
,@SlippD.Thompson Probably not for the reasons I mentioned in an earlier comment.. – Mysticial Jan 18 '15 at 1:19,,,,
,Rule of thumb for writing code that is efficient on a modern processor: Everything that makes the execution of your program more regular (less uneven) will tend to make it more efficient. The sort in this example has this effect because of branch prediction. Access locality (rather than far-and-wide random accesses) has this effect because of caches. – Lutz Prechelt Feb 1 '15 at 15:25,,,,
,"The grammar in me wants me to think this should read ""... victim of branch prediction failure"" rather than just ""... victim of branch prediction fail."" – jdero Jun 27 '15 at 11:35",2,2,,
,"So in Java's case, for example, does the branch prediction take place on the processor level or in the java runtime? – TheGuyWithTheFace Jun 29 '15 at 14:42",,,,
,"GCC has a lot of optimizations that aren't enabled by default, among the things it can do: – Ismael Luceno Jul 11 '15 at 9:19",,,,
,"it can split loops (with -ftree-loop-distribution and -ftree-loop-distribute-patterns), move invariant sections (by default), move invariant conditions out of the loops (with -funswitch-loops, but causes duplication), convert conditional jumps to conditional stores or remove them (-ftree-loop-if-convert and -ftree-loop-if-convert-stores). Sadly a lot of these options have unsafe side effects, and only do any good improvement to very naively written code. – Ismael Luceno Jul 11 '15 at 9:27",,,,
,"There is another fact here. The data and temporal locality. When you access the same position many times subsequently, its value still in the registers, so this is why the loop interchange doubles the performance over the original sorted version. – Renato Oliveira Oct 13 '15 at 11:08",,,,
,"@Mysticial, Is this answer still valid given the processor changes now in 2015/6? – Sandeep Dec 6 '15 at 11:43",,,,
,"@Sandeep Yes. Processors still have branch prediction. If anything has changed, it's the compilers. Nowadays, I bet they're more likely to do what ICC and GCC (under -O3) did here - that is, remove the branch. Given how high profile this question is, it's very possible that compilers have been updated to specifically handle the case in this question. The definitely pay attention to SO. And it happened on this question where GCC was updated within 3 weeks. I don't see why it wouldn't happen here as well. – Mysticial Dec 6 '15 at 16:31",,,,
,I just ran the code in VS 2015 and the sorting doesn't improve performance anymore. I measured about 1.1s for 32768 elements and about 11s for 327680 elements (moved to a global variable to prevent a stack overflow) with my Intel Core I5 with 3.6GHz thanks to TurboBoost. I looked to a disassembly and I didn't find any branch except one for terminating the loop - it actually uses instructions like cdq and movlpd which are normally used for floating point operations. – Marian Spanik Dec 9 '15 at 17:46,,,,
,"@One-One The prediction is done at the beginning of the pipeline, the operation flows through the pipeline and reaches a waiting area for its operands. Once its operands are available, the instruction executes and the instruction becomes eligible for retirement (commit to actual state). The retirement of the branch checks whether the guess was correct. If not, flush pipeline and restart instruction fetcher at correct instruction. If prediction was correct, just keep going. By this time, many instructions after the predicted branch have started but have not been committed to state. – doug65536 Apr 22 '16 at 12:33",,,,
,"Complementing... you can also use something like 'sum += (data[i] > 128) * data[i];', which is still branchless but same accuracy as the one with the branch. – chaws May 13 '16 at 20:18",,,,
,What about the ternary operator? sum += data[i] > 128 ? data[i] : 0 – Nicholas Hamilton May 19 '16 at 23:39,,,,
,@NicholasHamilton The ternary operator is a branch. Though some compilers (namely MSVC) seem to be better at optimizing them than plain-old if-statements. – Mysticial May 19 '16 at 23:44,,,,
,Really good explication. If you add this code it become much more faster: for (register unsigned i = 0; i < 100000; ++i) { // Primary loop for (register unsigned c = 0; c < arraySize; ++c) { register int t=(data[c]<<25)>>31; sum += ~t & data[c]; } } – Malus Jan Jun 5 '16 at 21:38,,,,
,"@Mysticial: Thanks for such a nice insight. After going through this came to my mind couple of questions: identify a pattern and follow it this sounds more of artificial intelligence. So is it safe to say modern compilers are equipped with AI algorithms for branch prediction? halt execution and wait until the previous instructions are complete that sounds to me of multiple threads. Does CPU internally breaks code blocks into threads? (One your comment also mentions processor is executing many instructions at the same time). If yes, what role does compiler play? – Atul Jul 14 '16 at 14:48",,,,
,"@Atul The Wikipedia article on branch prediction has examples of some branch prediction algorithms. Whether or not you want to call them ""AIs"" is up to you. For your other question about multiple instructions at the same time, it's called Superscalar Execution. – Mysticial Jul 14 '16 at 14:55",,,,
,"@Mysticial: Thanks! I took some time to go through article(s). What I gather is, branch prediction is more about processor architecture, no matter what compiler we use (unlike what I was under impression) – Atul Jul 15 '16 at 2:35",,,,
,I still fail to understand why the compiler has to even predict?! Why does it not just compare the two values with each other and decides then?! – Black Jul 21 '16 at 6:31,,,,
,"@EdwardBlack It's not the compiler that does the prediction. It's the processor. Secondly, the processor can't ""just decide"" because it's doing many things at the same time. To oversimplify things a bit, while the processor is executing the current instruction, it's already reading ahead by 20+ instructions and preparing them for execution. If you have a branch, the processor needs to decide which side to do this ""read ahead"". When there's a misprediction, everything that has been ""read and prepared ahead of time"" needs to be thrown away and restarted on the other side. – Mysticial Jul 21 '16 at 15:09",,,,
,"@EdwardBlack An appropriate analogy for this ""read ahead"" thing would be airline flight scheduling. Flight schedules are made months ahead of time. But when something unexpected happens (like a storm shutdowns down a major hub), flights get canceled and that schedule goes up in smoke. The result? Massive delays that propagate through to many flights that don't even touch that airport. Of course for a processor, the ""pre-planning"" window is on the order of nano-seconds and up to a few hundred instructions rather than thousands of flights that cover months. – Mysticial Jul 21 '16 at 15:14",,,,
,This is a good answer but it should be made clear that it is processor branch prediction that is causing this behaviour. Compilers predict branches too. – TimK Aug 9 '16 at 19:25,,,,
,"As a side note, there has been some research done where branch predictors were able to ""figure out the pattern of rand()"". They had a branch that was basically if( rand.nextInt(100) < 50 ) and correctly predicted something like 99% of the time. – Riley Sep 20 '16 at 15:02",,,,
,There were a few questions as to why the processor doesn't just execute both branches. One reason is that processors can have as many as 20 predictions in-flight (guessed but not resolved yet). To handle that many you'd need to be executing 2^20 (1048576) different paths at the same time. – Riley Sep 20 '16 at 15:08,,,,
,@Riley I actually did answer the comments about executing both branches. But it seems that my comment got deleted for some reason. – Mysticial Sep 20 '16 at 15:56,,,,
,@Mysticial Was your answer basically the same or is there another reason? – Riley Sep 20 '16 at 15:57,,,,
,@Riley Same. Exponential resource growth and the fact that prediction is often very accurate. – Mysticial Sep 20 '16 at 16:02,,,,
,"@Adjit There's no simple answer to that. For the particular case here, GCC and ICC can do conditional moves, but VS can't. But that will change depending on the code. The example in this question is optimizeable to a conditional move. But not always. Only really simple branches can be optimized this way. – Mysticial Oct 29 '16 at 23:42",,,,
,"@Adjit No, that's way too specific. What to take away is that anything that causes the flow of execution to conditionally change is subject to a performance penalty due to branch misprediction. This includes if-statements, loop-conditions, switches, ternary operators, short-circuiting boolean logic, calls to function pointers, calls to lambdas, calls to virtual/polymorphic methods, etc... (The last 3 of these aren't related to branch-prediction per se, but the same concept applies in that the processor doesn't ""know where to go"" next.) – Mysticial Oct 31 '16 at 15:11",,,,
,@Mysticial is there a particular reason you opted for your implementation (declaring an int) over sum += ~((data[c] - 128) >> 31) & data[c]; ? – Zze Nov 15 '16 at 2:20,,,,
,"@Zze No. That was just the way it turned out when I derived it. The variable being the mask that either enables the value, or sets it to zero. – Mysticial Nov 15 '16 at 5:57",,,,
,@mysticial Does it mean that it is possible that the result of the program is incorrect because of the prediction? How does it know/validate whether the guessing is correct? Wouldn't that still need to actually compute everything to know the correct result for validation? – elfan Nov 16 '16 at 22:36,,,,
,"@elfan No. Branch prediction does not affect correctness. When the processor runs a set of instructions, it must behave ""as if"" it were running them line-by-line. It can play tricks underneath to make things faster (such as branch prediction), but in the end, it still must respect the program as it is written. For your other question, the processor will know when a prediction is correct once the branch instruction executes and determines which way it's supposed to go. – Mysticial Nov 16 '16 at 23:37",,,,
,"@Mysticial, does it mean in this case the code will complete in around 2 seconds (instead of 12) if there is no branch prediction, and that the extra 10 seconds was because of the overhead of wrong predictions (the train going back)? – elfan Nov 17 '16 at 3:02",,,,
,"@elfan No. As a hypothetical example: If there was no prediction, it would always take 10 seconds. With good prediction, it would be 2 seconds. With consistently bad prediction, it would be 12 seconds. The extra 2 seconds being the overhead of going back. In most cases, it will be closer to the 2 seconds, so it's a net win. – Mysticial Nov 17 '16 at 3:59",,,,
,"I see, so the 8 seconds was the overhead to stop the train and ask the driver every time. If there was no branch at all, and no branch prediction, then the code will always take 2 seconds (i.e. similar to the case that the prediction is always correct in a system with branch prediction). Thanks for your great explanation @Mysticial – elfan Nov 17 '16 at 6:37",,,,
,More simplify way for: int t = (data[c] - 128) >> 31; sum += ~t & data[c]; is char t = data[c] >> 7 ; /* Truncating the 7 bits (equivalent to data[c] >=128 ) */ sum += -t & data[c]; /* -t will be equivalent to -1 if data[c] >= 128*/. – Mohit Thakur Nov 29 '16 at 6:00,,,,
,How does this influence (if at all) the evaluation of the complexity of an algorithm? – njzk2 Dec 2 '16 at 19:43,,,,
,"@njzk2 it doesn't. Complexity is the asymptotical behaviour of the time (or size) of a function when its inputs tends to infinity. Branch prediction failures doesn't change how the curve behaves at infinity, it only adds some constant computation time to the branch operation. – Snaipe Dec 7 '16 at 20:20",,,,
,"I question the efficacy of human minds when it comes to unnecessary overhead such as branch prediction. I just read up on the Wikipedia article—what smart person invented this so I can smack him upside? Just do two concurrent speculative executions for both branches and then discard the ""wrong"" branch's speculative execution. – AMDG Feb 6 '17 at 0:22",,,,
,"@LinkTheProgrammer I'm not so sure the solution is that simple. Because if it was, they'd probably be doing that already. The main problem I see is that modern CPUs will be predicting multiple branches ahead. And that leads to an exponential state explosion if you want to follow them all. The other thing is that running down multiple paths means you'll be wasting a lot execution resources on stuff that will be thrown away. And that probably has implications for power consumption as well. – Mysticial Feb 6 '17 at 19:24",,,,
,"@Mysticial perhaps, but I'm thinking pure latency here. We can worry about power consumption when my $200 laptop stops lagging and people start writing actually efficient code. – AMDG Feb 6 '17 at 21:43",,,,
,There is also __builtin_expect in GCC to help the compiler. See stackoverflow.com/questions/109710/… – k3a Mar 10 '17 at 20:10,,,,
,sum += ~t & data[c]; The above will be wrong since a & operation will change the bits. What you want is as below a multiplication operation: sum += (~t * data[c]); – TheLoneJoker Sep 18 '17 at 1:46,,,,
,I would like to know what patterns can i use to achieve this? Is there anything i could do without properly planning all the time on these small array operations so i can just write code in a fashion that suits for the computer? Is it better to sort the array all the time before an operation? I know its sort of pointless at this level but many things add up very quickly. Also does the same thing applies in other programming languages? Or is it c++ specific? – DDD Oct 2 '17 at 16:55,,,,
,"@Azarus I think you're among a sizable # of people who are getting confused by the sorting aspect. Sorting has nothing to do with branch prediction itself. It just happens to expose the effect of branch prediction in the specific example of this question. So don't go around blindly sorting things thinking it will magically solve everything. Not all illnesses are treated with antibiotics. You need to understand the problem first before you can apply the solution. Otherwise you may end up doing more harm than good. And before you even get to that, the rules of premature optimization still apply. – Mysticial Oct 2 '17 at 17:16",,,,
,@mystical i am aware of that would be indeed really stupid to sort arrays all the time. The computer would run into branch prediction all the time. But my question was more about what can we use in practice to avoid or reduce its performance issues if theres any in the first place? Is there anything we can do about it? Or its not worth the effort and situations where it really matters are rare? – DDD Oct 2 '17 at 17:20,,,,
,"@Azarus If you're looking for a ""best practice"", it's in the answer already - ""A general rule of thumb is to avoid data-dependent branching in critical loops."" But I can't speak for whether it's worth the effort since it depends on the requirements of the application and the available resources to do it. – Mysticial Oct 2 '17 at 17:53",,,,
,"ok, I see your benchmarks, but whole branch prediction thing doesn't provide much performance. it introduces more problems than solving it. then why cpu manufactures even bothered integrating such thing in it? – M.kazem Akhgary Oct 11 '17 at 14:10",,,,
,"@M.kazemAkhgary Because branch prediction helps in >95% of the cases in real life. The example in this question happens to be that remaining 5%. And even in that 5%, the penalty is minimal compared to not predicting at all and always stalling. – Mysticial Oct 11 '17 at 15:27",,,,
,"I'm afraid your proposed optimisation is flawed: int t = (data[c] - 128) >> 31; has implementation defined behavior: data[c] has int type, so data[c] - 128 will be negative for values less than 128. Right shifting a negative value has implementation defined behavior. You can fix this for 2's complement architectures with a simple expression: sum += -(data[c] >= 128) & data[c]; for which many compilers will produce code without jumps. Alternatively, given the range of data[c]: sum += -(data[c] >> 7) & data[c]; – chqrlie for yellow blockquotes Oct 19 '17 at 11:16",,,,
,"@chqrlie When you get to this level of optimization, implementation-defined behavior is often an acceptable trade-off. Especially since sign-fill right-shift is essentially universal for 2's complement architectures. The real offender here is assuming a 32-bit int. It's been a while, but I probably didn't use a solution with a comparison because I had experiences with compilers generating branches for bool -> int conversions. You also can't do that in Java. Anyway, that was 5 years ago. I rarely do these hacks anymore since I prefer the SIMD intrinsic route. – Mysticial Oct 19 '17 at 15:50",,,,
,"@M.kazemAkhgary Short answer is that each core has multiple pipelines. Long answer is that it's a loaded question. Try searching for ""superscalar processor"". Modern processors can execute around 4 instructions/cycle. – Mysticial Oct 19 '17 at 17:56",,,,
,"On ARM, a (short) conditional is a zero-cost operation, because every instruction has a 4-bit conditional field (allowing for 16 different types of conditions on any instruction), so branching can be completely avoided in many cases. (In this case, just do the comparison, then conditionally accumulate). So on ARM, the runtime will be longer for sorted than for unsorted, because sorting requires extra work. – Luke Hutchison Dec 22 '17 at 12:37",,,,
,"Note that this optimization is precisely the cause of Spectre and Meltdown big security vulnerabilities. In short, some operations like caching are not actually rollbacked (for performance reasons), which cause some potentially sensitive data to become readable by other processes. – Timothé Malahieude Jan 5 '18 at 10:42",,5,"This comment has an upvote of 30 less than the above group. This will be group 6, not 5.",ok
,"Let me clarify one thing about your analogy with trains: train suffers by making a bad choice, because it needs to get back to the branching point on failure (I consider that it's going to be the wrong choice as you see). Does the branch prediction suffer from a bad choice compared to not making any choice and rather waiting? Or is the branch prediction in CPUs beneficial in both cases (making train analogy imprecise)? – Evusas Feb 28 '18 at 8:35",,,,
,"@Evusas I'm not a hardware designer, so I don't know the answer for sure. But the rollback logic certainly isn't free. Even if the CPU designers managed to completely hide the performance impact of a misprediction roll-back, there are still costs in terms of power consumption of the wasted computation. Today's chips are very power optimized and will vary their clock speeds to stay under a power limit. So it's certainly within the realm of possibility that excessive waste of power from mispredictions can indirectly hurt performance. – Mysticial Feb 28 '18 at 19:12",,,,
,@TimothéMalahieude or maybe overly optimistic guarantees of OS vendors on process isolation are the cause. Some OSes that do not use the concept of process don't care at all – Sergey.quixoticaxis.Ivanov Apr 10 '18 at 18:32,,,,
,"@Mystical seems to me that the brach pridiction decreases the elapse time that the execution takes but not less CPU time/work is actually done cause the condition need to be checked either way, just there are less CPU idle times. Then one can say that if you make milion different jobs, the total time to do all of the will be similar with and without branch pridiction. so it optimizes perfomance but not throughput. is this right? – naviram Sep 16 '18 at 0:12",,,,
,"@naviram No it isn't. A CPU's resources can't be redistributed like that. Most of it is use it or lose it. If the CPU is stuck waiting for a branch to unwind (among many other things), its computing resources remain idle. Features like hyperthreading will allow some amount of sharing. But not to the level that you describe where everything is always utilized no matter what happens. Also, a branch misprediction involves wasted resources. So in the case you describe where throughput matters and everything can be prefectly redistributed, branch prediction would be actively harmful. – Mysticial Sep 16 '18 at 0:44",,,,
,"I haven't read every comment but while the answer's explanation is good, a simpler (and faster!) version for this specific task is sum += data[c] * (data[c] >= 128);. It is better than the posted answer even in unoptimized builds (in optimized builds, even the naive version is faster than the posted answer actually, a good reminder that micro-optimizing is bad). A comparison doesn't mean a branch. Compiler is clang 9.0. – lesurp May 16 '19 at 13:27",,,,
,"@Mysticial: You might want to qualify the ""avoid data-dependent branching in critical loops"" a bit, given it's really only valid when the conditional block performs very little work? A little worried someone will take it literally and make some expensive statement unconditional... – user541686 Jul 24 '19 at 2:38",,,,
,Can the train track analogy apply to junctions in the processor's actual electrical circuits? – Kyle Delaney Oct 14 '19 at 18:44,,,,
,"Is there a definition of a ""predict friendly"" code available ? Are the following statements ""predict equivalent"" ? Or is first statement more ""predict friendly"" than second ? why ? if (a && b)... if (a) if (b)... – Saint-Martin Jan 10 at 21:47",,,,
,"after I saw this post, I am happy to have chosen to give up my financial career and become a developer in old age – trocchietto Feb 15 at 16:32",,,,
,A God among mortals – sdc Feb 25 at 20:12,,,,
,"Congratulations for your record, +1 to keep the legend on – riki481 Feb 26 at 16:19",,,,
,"@Unheilig re: ""could you tell me how you could do this int t = (data[c] - 128) >> 31; sum += ~t & data[c]; to replace the original if-condition above?"". Sure. x>>31 returns 0 for all x>=0 and -1 for x<0. ~ inverts the result, so ~(x>>31) returns 1 for numbers >=128, and therefore the right hand side of the & is returned. Otherwise it returns false and returns 0. There reason >>31 detects sign is because we're dealing with 32 bit signed integers and 1 bit is reserved for sign. – Zack Burt Apr 1 at 3:17",,,,
https://stackoverflow.com/a/54373107/5749570,Java does not allow us to 'emulate pass by reference'. The failure of one user to accept an answer is not a huge weakness of the entire site. – user207421 Jan 25 '19 at 21:43,4,,,
,"Explain what you mean by ""java does not allow us to emulate'. As far as the weakness, it's a difference in opinion. – Sanjeev Jan 25 '19 at 22:02",4,,,
,"Honestly, you can simplify this answer by saying Java is pass by value only for primitive types. Everything that inherits from Object is effectively pass by reference, where the reference is the pointer you're passing. – Scuba Steve Feb 4 '19 at 22:51",1,1,,
,"@Scuba Steve if that's what you got out of my post, I have totally failed to get my message across. Everything in java is ALWAYS pass by value and NEVER pass by reference. When passing an object, you're actually passing a reference to that object, but THE REFERENCE IS BEING PASSED BY VALUE (i.e. a copy of the reference is passed.) And again, this not my personal opinion, but true by definition. – Sanjeev Feb 6 '19 at 0:19",1,1,,
,"That's true for any reference in any language... unless you explicitly passed a reference by reference, which generally speaking, wouldn't make much sense to do. – Scuba Steve Feb 6 '19 at 0:36",1,1,,
,"Not the case. This is true in C, Java, JavaScript, but not true in Pascal (which has ""Variable Parameters"" the same as reference parameters) and C++ (please see the example I posted) – Sanjeev Feb 6 '19 at 0:40",1,1,,
,"Other examples of pass by reference languages are c#, php, vb.net, and fortran. – Sanjeev Feb 6 '19 at 0:49",1,1,,
,"I don't think C++ owns the term ""pass by reference"". In Java, it's very common to say ""pass a reference"", because when you pass an object, you don't copy the object, as you could in C++. it is a pointer to a location in memory, but yes a new pointer. In C++, it's a pointer to a pointer... So, I prefer to use other terms and not assume C++ is the standard everyone must follow and understand. – Juan Mendes Apr 16 '19 at 15:15",3,2,This group has a total of 1 upvote while the other group which you have annotated as 3 has a total of 2 upvotes. Therefore this group should be 3 and the other one should be 2.,ok
,"@JuanMendes, I just used C++ as an example; I could give you examples in other languages. The term ""Pass by reference"" existed long before C++ existed. It's a textbook term with a very specific definition. And by definition, Java is not pass by reference. You can keep using the term in this way if you'd like, but your usage will not be consistent with the textbook definition. It's not just a pointer to a pointer. It's a construct provided by the language to allow ""Pass By Reference"". Please take a close look at my example, but please don't take my word for it and look it up for yourself. – Sanjeev Apr 17 '19 at 3:32",3,2,,
,"Describing java as ""pass-by-value"" is highly misleading. For non-primitive types Java uses pass by value of the reference. Pass by value implies the value is copied when passed to a method. It is not, the reference is copied. What java does is not the same as either pass by value or pass by reference in C++. – AutomatedMike May 3 '19 at 12:20",2,3,,
,"@AutomatedMike, if the reference was being passed-by-reference, there wouldn't be a copy of the the reference. It would be as if the argument and parameter were two different names for the same variable. That's the distinction between pass-by-value and pass-by-reference. Please take a look at my c++ example to see what I mean. Another way to look at it is that java does not pass the ""Swap Test"". Here is a great article which discusses exactly what I mean : javapapers.com/core-java/…. An example Pascal would be more clear. I'll try and post one. – Sanjeev May 5 '19 at 21:12",2,3,,
,"@AutomatedMike I think that describing Java as ""pass-by-reference"" is also misleading, their reference are nothing more than pointers. As Sanjeev wrote value, reference and pointer are textbook terms that have their own meaning regardless of what Java creators use. – Jędrzej Dudkiewicz Jun 13 '19 at 10:29",2,3,,
,"@Sanjeev that's why I said ""pass by value of the reference"" not pass-by-reference or pass-by-value, as stated many times both these terms are miss-leading when describing what java does. – AutomatedMike Jun 25 '19 at 9:43",2,3,,
,"@AutomatedMike, I understand where you're going with that. My point is that we don't need new terminology. Pass-by-value adequately describes what java does. The value of the reference is indeed passed by value in Java. – Sanjeev Jun 25 '19 at 12:27",2,3,,
,"Java is pass by reference. Or passing the value of a reference in objects. Since in Java everything is an object except for atomic types like int, char, boolean, etc. For people who always says its pass by value I think they making it more complicated rather than simplifying the matter. – Artanis Zeratul Aug 17 '19 at 21:54",2,4,I believe this is not a new group or a new conversation. They are still debating whether calling java pass-by-value is logical or not.,ok
,"@ArtanisZeratul the point is subtle, but not complicated. Please take a look at the cartoon I posted. I felt it was pretty simple to follow. That Java is Pass-by-value isn't just an opinion. It's true by textbook definition of pass-by-value. Also, ""people who always say it's pass by value"" include computer scientists like James Gosling, the creator of Java. Please see the quotes from his book under ""Edit 2"" in my post. – Sanjeev Aug 18 '19 at 20:10",2,4,,
,"What a great answer, ""pass by reference"" does not exist in java(and other languages like JS). – newfolder Sep 3 '19 at 17:06",P,5,Praise,ok
,"This part of the answer is misleading and should have been changed: ""Java is Pass-by-value, but allows us to emulate pass be reference by passing a Java reference (i.e. a pointer) by value."" -- That doesn't emulate pass-by-reference at all. The closest thing to emulating it would be to pass (a copy of a reference to) some mutable ""holder"" object, e.g., an AtomicReference, and the called function would mutate the ""holder"" to hold a new value. The caller would need to understand that usage; the language would not help. – AndrewF Dec 24 '19 at 23:56",5,,Group 5,ok
,"@AndrewF. Yes, in a sense, you could emulate pass-by-reference even more closes by enclosing the ""reference"" in a mutable object since this would allow changing the ""reference"" in the function. But my goal was to explain the origins of passing ""reference"" or a pointer by value. How closely this emulates PBR is not relevant to my argument. – Sanjeev Jan 6 at 16:24",5,,,
,"I think most of the comments/answers on this question (and this answer itself) have covered well that passing a reference/pointer value is not pass-by-reference by definition and does not exhibit the bidirectional behavior of pass-by-reference. So there is no emulation whatsoever. The rest of the answer gets it right, but that one sentence gets it wrong. – AndrewF Jan 7 at 21:14",5,,,
,"@AndrewF, I'm still not TOTALLY convinced this section is incorrect or misleading, but I'm open to the idea that you might have a point and I'm just missing it, especially since you're the second person to object. Either way, you've convicted me to change it (the first chance I get) because even if that one bullet is historically correct, it's a distraction from my core message. Thanks for the feedback. – Sanjeev Feb 11 at 18:05",5,,,
https://stackoverflow.com/a/309448/5749570,"i found filenotfound exception while i try to read file name with ""До_свидания"" file name(Russian language) i try with FileInputstream but it not cable to read this filename from sdcard. – Bhanu Sharma Feb 11 '14 at 5:39",,,,
,"For android developers, seems like android does not come with IOUtils from Apache. So you might consider referring to other answers. – Chris.Zou Aug 1 '14 at 3:57",1,1,,
,"I work in a limited footprint environment, so the solution by @PavelRepin below using the java io/util libs makes more sense. – James Sep 25 '14 at 23:34",,,,
,@ChristofferHammarström totally agree. Even on the same machine if you run java from cmd or from your IDE. – Esben Skov Pedersen Oct 23 '14 at 7:29,,,,
,IOUtils.toString() works very nicely with the Java7 try-with-resources. – Donal Fellows Apr 15 '15 at 12:49,4,5,,
,maven dependency for commons-io <dependency><groupId>commons-io</groupId><artifactId>commons-io</artifactId><version>2.4</version> </dependency> – Ronan Quillevere Jun 18 '15 at 14:47,,,,
,For gradle users: compile 'org.apache.commons:commons-io:1.3.2' (I'm having trouble finding the latest version; anyone?) – AutonomousApps Sep 7 '15 at 21:23,,,,
,It' s a worse idea to use 3rd library to load inputstream to string. Try this gist.github.com/XinyueZ/440e015b3a1afb692812 – TeeTracker Oct 9 '15 at 13:32,,,,
,Guava version: CharStreams.toString(new InputStreamReader(stream)) – Shubham Chaudhary Nov 5 '15 at 11:33,5,,,
,This is an incredibly old question at this point (it was asked in 2008). It is worth your time to read through more modern answers. Some use native calls from the Java 8 library. – Shadoninja Mar 28 '16 at 3:13,2,2,,
,This answer is heavily outdated and one should be able to mark it as such (sadly this is not possible atm). – codepleb Apr 20 '16 at 13:00,C,3,"I think there is no value in this comment. It is just a critiq. If you agree, the rests of the annotations will align well.",ok
,It turns out that this method is the slowest! Check out my benchmarks here – Ilya Gazman Feb 13 '18 at 21:33,,,,
,In case it helps anyone I've filled in the small gap in the second part of this answer on how to close the stream in this answer. – Steve Chambers Feb 25 '18 at 20:52,,,,
,IOUtils.toString() has long been deprecated. This answer definitely is not the recommended way any more. – Roshan Feb 15 '19 at 16:08,3,4,,
,then edit it to explain why it is deprecated to help future readers. – Jean-François Fabre♦ Apr 3 '19 at 20:23,3,4,,
,Check out this handy example of IOUtils.copy: apisonar.com/java-examples/… – APISonar Dec 17 '19 at 13:58,,,,
https://stackoverflow.com/a/271874/5749570,"I disagree with your statements for the DO_NOTHING action. If the find action method cannot find an action, then returning null is the right thing to do. You've ""found"" an action in your code which isn't really found, which violates the principle of the method, to find a useable action. – MetroidFan2002 Nov 7 '08 at 18:36",1,1,,
,"I agree that null is overused in Java, especially with lists. So many apis would be better if they return an empty list/array/collection instead of null. Many times, null is used where an exception should be thrown instead. An exception should be thrown if the parser can't parse. – Laplie Anderson Nov 14 '08 at 1:53",2,2,,
,I think it should be possible in the source code to specify that null is never returned from method X and that a given parameter should NOT be null and it is an error to pass one. – Thorbjørn Ravn Andersen May 26 '09 at 11:43,,,,
,"The latter example here is, IIRC, the Null Object design pattern. – Steven Evers Jul 23 '09 at 4:26",3,3,,
,Assertion is good for TESTING. It's dangerous to use on PROD. – DragonBorn Nov 30 '09 at 14:21,5,,Assertion usage - group 5,ok
,"I disagree with DO_NOTHING because although it eliminates that null check, the resultant behaviour is unexpected. If null is an unexpected input to your method then it is pertinent that your method throws NPE so that the caller is aware and things are logged(A fail fast behaviour). With using DO_NOTHING, its like everything passed but the resultant action didnt take place and users will redo the action (resubmitting the form). I agree to return empty lists, objects but not nulls as return values but dont agree to the DO_NOTHING illustrated above. But NPE's shouldnt display stacktrace on UI – Cshah Feb 11 '10 at 14:56",1,4,"These 2 comments also talk about 'Do_nothing' action. Therefore, it should go in group 1.",ok
,"@Cshah (and MetroidFan2002). Simple, put that into the contract and then it is clear that a non-found returned action will do nothing. If this is important information to the caller, then provide a way to discover that it was a non-found action (i.e. provide a method to check if the result was the DO_NOTHING object). Alternatively, if action should normally be found then you still should not return null but instead throw an exception specifically indicating that condition - this still results in better code. If desired, provide a separate method returning boolean to check if action exists. – Kevin Brock Mar 5 '10 at 12:25",1,4,,
,"I am defensive in my coding and do the null checks. Especially in a J2EE environment. My thinking is that anything that can be null...could potentially be null at some point. Contractually, in most cases I don't want to throw an illegalarg exception or nullpointer because Java shouldn't have null refs in the first place. In most cases, I try to find a default return value and fail fast with the default value/expected return value. – Berlin Brown Mar 14 '11 at 21:33",2,,"Talk about null check. Therefore, group 2.",ok
,Concise does not equal quality code. I'm sorry you think so. Your code hides situations where an error would be advantageous. – gshauger May 4 '11 at 4:33,4,5,This will auto correct if you adjust the other ratings.,ok
,"@MetroidFan, if you return a valid Action which doesn't do anything you have a simpler caller without a branch. Branches cause additional complexity, and keeping them as few as possible makes for simpler testing. – Thorbjørn Ravn Andersen Sep 4 '11 at 21:51",1,,,
,"@Thorbjørn Ravn Andersen By hiding the possibility that the findAction method may not find an action, you've now done logic that, while it doesn't break the program, may result in undesired effects that aren't found until a much later stage (possibly in production). Depending on if findAction really can be expected to not find anything, this is highly undesireable - returning null or throwing an exception, like imaginaryboy suggests, are better approaches so that they can be explicitly checked for and paths taken to account for the lack of finding an action. – MetroidFan2002 Sep 4 '11 at 22:55",1,,,
,"Whats the point of using assertions when they only fail for you? Yes you can catch stuff while you're working on it, but in production how will they help if you never hear about that in odd situations? – monksy Sep 19 '11 at 14:56",5,,Assertion usage - group 5,ok
,"There is nothing wrong with checking null values, and I have seen lot of senior/rockstar developers who check for null values everywhere. Also, null checking is one of the cheapest operation in a programming language. – DarthVader Oct 5 '11 at 0:44",2,,"Talk about null check. Therefore, group 2.",ok
,"Agreed with DarthVader. I'd argue that not being defensive enough is the junior thing to do. There are very few libraries out there, and very few coders in my experience that have the discipline to completely describe their contracts (and that includes whether nulls might be returned/ are acceptable values for arguments), so often there isn't much to trust. – Eelco Feb 8 '12 at 5:08",2,,,
,"@Saj: Why Assertions are only good for testing and dangerous for productive systems? If there is a condition that leads to an error it has to fail also in production. Nevertheless it's important to have some JUnit test or integration test that checks that assertion. Furthermore enable assertions with ""-ea"" – Sal Aug 26 '12 at 20:48",5,,Assertion usage - group 5,ok
,"In the ""compare"" code your perspective is being unveiled for the fact that if you have nothing to do when NULL is returned for action then why checking for NULL? You make the code looks uglier than just a checking for a non NULL value. Avoiding coding styles, I prefer the way I've seen in some android api code while asking for NULL. They just return if the involved method can't continue working even thought method profile returns void. And if you have to, arrange things previous the return statement. Of course, you are returning and breaking the normal flow of a high level language. – Sebastian Sep 14 '12 at 20:57",,,,
,"assert is unusable for me, because it has to be explicitly enabled - I want my assertions to always be enabled. Someone said: ""but in production how will they help if you never hear about that in odd situations?"" Easy - you get an exact and crystal clear failure as near to the root cause of the problem as possible, and can easily patch it with much less effort than reverse engineering the entire system trying to figure out where the failure was. That is why design by contract, fail-fast, no-null design is the only way to go.... and never use 'assert', use a mechanism that is always enabled.... – ianpojman Oct 18 '12 at 3:28",5,,Assertion usage - group 5,ok
,"Instead of the DO_NOTHING action I would probably create a hasAction(userInput) method, returning a true or false if there is a valid action for that userInput. Then findAction would return the action or throw an Exception ActionNotFoundException – Matthew Kirkley Dec 20 '12 at 12:25",1,,"talks about 'Do_nothing' action. Therefore, it should go in group 1.",ok
,"""although my testing has shown next to no performance impact from assertions"". Your assumption is not based on Oracle documentation. It can highly affect performance in type of system that includes real-time computation. – FidEliO Dec 24 '12 at 11:24",5,,Assertion usage - group 5,ok
,I agree with MetroidFan2002. he is spot on. returning null can sometimes happen and it is not dirty at all to check for nulls. by all means if you can avoid nulls and always initialise your contracts then you wont need to check nulls – Jonathan Jan 10 '13 at 23:40,2,,Null check topic. Group 2.,ok
,@SnOrfus +1 for mentioning the Null Object design pattern. I learned something here. See en.wikipedia.org/wiki/Null_Object_pattern – Timmos Jan 17 '13 at 16:24,3,,Null Object Pattern (NOP) is group 3,ok
,"I never return null so I never check return values for null. I never need to think about which variables that are valid. They all are. I never pass null to a method so I never need any input validation in my methods. If it would feel logical to actually have a method that allows a null parameter to be passed, I create two methods instead. Minimizing code duplication by breaking out commons is then important. – Anders Lindén Jan 21 '13 at 21:28",2,,Null check topic. Group 2.,ok
,"I'm against code bloat and agree with this solution. Explicitly checking for NULLs is an anti-pattern IMHO. The Java way is to throw *NotFound/InvalidAccess etc. exceptions which avoids the necessity for the caller to explicitly handle irregular situations. I even go further: use arg.equals(""foo"") instead of ""foo"".equals(arg), or use native types (long instead of Long) to implicitly FORCE NPE. Fortunately, when returning a null object, the caller can still try to call a method on that null value and force a NPE. :-))))) – user1050755 Mar 7 '13 at 1:04",2,,Null check topic. Group 2.,ok
,"Often, the behaviour you want to implement if an object is null will be similar no matter where you receive the null object. As others have noted, the answer's DO_NOTHING action is, in fact, The Null Object Pattern (en.wikipedia.org/wiki/Null_Object_pattern) which collects this 'what do we do if it's null?' logic in one place and so reduces duplication. However, the Null Object Pattern is really just a more limited version of Martin Fowler's Special Case Pattern: (martinfowler.com/eaaCatalog/specialCase.html) which is great for eliminating checks for values other than null too. – Ryan Bennetts Apr 23 '13 at 11:33",3,,Null Object Pattern (NOP) is group 3,ok
,I'd go for Optional/Option or an exception here. Returning null is just poison for your caller; they'll forget to handle it and see a problem far away from the call site. – Ricky Clarkson Jun 18 '13 at 18:00,,,,
,"@MetroidFan2002: agreed re: DO_NOTHING, but not quite. If the find action method cannot find an action, then the method didn't do what it said it would do. In that case it should not return. It should throw. – Travis Wilson Feb 26 '14 at 19:36",1,,"talks about 'Do_nothing' action. Therefore, it should go in group 1.",ok
,"@TravisWilson If the method was going to throw something, it should throw IllegalArgumentException, not NPE, because it's explicitly checking for null and doing something with it. IAE would also handle getting non-null input and not being able to find anything for it as well. But, nowadays with Java 5+, I would throw NPE IFF the method took an enum constant as a parameter, since you'd have something (one for each enum constant) or nothing if proper practices with enums were observed. – MetroidFan2002 Feb 27 '14 at 17:21",1,,,
,"@user1050755 What you are doing with strings is both dangerous and naive. When you do checking against a literal, you want to know if that literal matches, not if the string is null. The naive way to do that is as you've suggested, with a useless null check: if(stringVar != null && stringVar.equals(""literal"")) But, this forces you to directly send in null input for testing coverage, resulting in unneeded branches. """".equals(stringVar) will always work regardless. If you know the literal to check on, you should always do this - it's the safest, easy to read and doesn't do extra conditions. – MetroidFan2002 Feb 27 '14 at 17:23",2,,,
,"I don't get why everyone is hating the DO_NOTHING. Sure, in this example it is minimalistic - but this is a programming language... add in an ""isEmptyAction()"" method to the class... the point is to ENCODE the state of the objects, not return some cryptic-lack-of-a-value that you somehow have to just know to check for... ""isEmptyAction()"" is an actual API that encodes the fact that an action might be empty/do nothing. Much much much cleaner, imo (and many others, hence the fact that it is it's own defined design pattern ...) – grinch Feb 28 '14 at 13:23",1,,"talks about 'Do_nothing' action. Therefore, it should go in group 1.",ok
,"@MetroidFan2002: absolutely. NPE is not usually the right thing to throw. Not finding a method is a totally legitimate outcome so it should be something specific that the consumer is required to catch. Maybe it's a result of bad input, in which case I like IllegalArgumentException (but am not thrilled that it's a RuntimeException). Also by this rule: if the method says it might return an action that does nothing (say, for consumer's convenience), then returning DO_NOTHING is fine. – Travis Wilson Feb 28 '14 at 17:36",1,,"talks about 'Do_nothing' action. Therefore, it should go in group 1.",ok
,"Throwing NPE is a very sensible thing to throw when something is null that shouldn't be. By the way, you should be careful if you're dealing with concurrency, because something that's not null when you check it might be null when you use it. – dfeuer Mar 31 '14 at 1:11",2,,Null check topic. Group 2.,ok
,"I just added the final two suggestions to the answer -- the try/catch and the more-meaningful default action. @dfeuer I don't think NPE makes sense unless 'someInput' is null. I agree with Travis Wilson that IllegalArgumentException also is not ideal, although it's not inappropriate. My suggestion is a custom exception with a meaningful message that can be shown to the user that supplied the bad input. – UFL1138 May 15 '14 at 16:15",2,,Null check topic. Group 2.,ok
,"@MetroidFan2002 late to the fray. The point with the null object pattern is that you are returning null. The user can still check for a null object, by comparing it with the null object. She can also ignore the fact that she got back a null: that's the advantage. If you implement a method, and you think null is an OK value to return, then the thing you returned (the null) should still obey the API of the thing you promised to return. If it's unacceptable, then you should have thrown instead. The user can still decide for herself, by checking for the null object and throwing. – Ziggy Jun 10 '14 at 23:06",3,,Null Object Pattern (NOP) is group 3,ok
,"@Ziggy It's not that I disagree with the null object pattern, and I use it all the time. It's that in this particular case, the method signature is findAction A DO_NOTHING action, by definition, is NOT FOUND! That's lying to your user. And having the user have to check for DO_NOTHING violates polymorphism - now not all your instances can be used interchangeably. To put it in perspective, let's say the method was BigDecimal findBigDecimal(String whatever) - The Null Object pattern does not work here. Finding something lies to you if zero is returned. – MetroidFan2002 Jun 21 '14 at 4:06",3,,Null Object Pattern (NOP) is group 3,ok
,"Null Object pattern is more useful than null because sometimes the result isn't used immediately - it could be stored in a field, for example. You can then distinguish between null caused by an uninitialized field (probably a programming error), vs null as a result of some action. – artbristol Jul 29 '14 at 14:31",3,,Null Object Pattern (NOP) is group 3,ok
,CAUTION: Assertions can be disabled and are found to be disabled in production environments. – Dilruk Jul 31 '14 at 18:51,5,,Assertion usage - group 5,ok
,"null object pattern is useful for only simple cases because of java's lack of multiple inheritance. Unfortunately, null is the only value that can stand for an arbitrary object and that is why it is used so widely. – Kemal Erdogan Sep 16 '14 at 14:06",3,,Null Object Pattern (NOP) is group 3,ok
,"I find myself using the Null Object DP when having the API ""always available"" is relevant (such as with the Strategy pattern), but I typically find myself simply throwing verbose and meaningful exceptions. I can't remember the last time I explicitly checked for null in Java (or any real OO language); then again, I don't code in Java all that often. I just want to say: this was an epic conversation and a very enlightening read. This is why I come to SO. Thank you all for participating in this. – Xunnamius Nov 4 '14 at 2:31",3,,Null Object Pattern (NOP) is group 3,ok
,There is a much better solution for this now in Java8: use an Optional as your return value to represent a nullable value. That way the caller knows that it is an optional value and can use all the methods that Optional provides for handling the value. – sprinter Dec 24 '14 at 3:28,,,,
,"I like the idea of a DO_NOTHING action but nobody seems to mention throwing an IllegalArgumentException. If the argument is invalid this seems like a good response. The method will need to have proper documentation either way. Also @sprinter returning a DO_NOTHING action is very similar to Optional. Both have the goal of not returning null. I'm not convinced that Optional is ""a much better solution"" though. – John Mercier Feb 24 '15 at 17:58",1,,"talks about 'Do_nothing' action. Therefore, it should go in group 1.",ok
,"By and large, the problem is not that developers don't know or trust the contracts; the problem is that there are no contracts. In my experience with the Android SDKs published by several hardware vendors, there is either no documentation or no useful documentation. The code mills in Hong Kong and Bangalore have never even heard of Javadoc. – Kevin Krumwiede Mar 9 '15 at 18:48",,,,
,"As an electronic eng. turned into a programmer, this topics spin my head as I try to learn more XD – Josh Jul 17 '15 at 9:53",,,,
,throwing an Error just because someone passed a null file path to your file opener thingy is extremely overkill. Imagine if someone used that inside an application server. – Demonblack Sep 14 '16 at 16:47,,,,
,The real question is WHEN null is valid response and when is not. And what would be that very contract for software to be least cluttered with boilerplate code. – Mykhaylo Adamovych Nov 23 '16 at 11:14,,,,
,"Since Java 8, I always use Optional for cases like this. From the point of readybility it's not a big difference IMO, but it looks a bit more aesthetic. So instead of if (obj != null) I write if (objOpt.isPresent()) – Pascal Schneider Feb 27 '17 at 15:00",,,,
,@MetroidFan2002 Added to your statement - Criticism of NullObjectPattern – Tarun Maganti Apr 11 '17 at 9:43,3,,Null Object Pattern (NOP) is group 3,ok
,"I've seen too many dumb NullPointer exceptions in Production as to think that defensively checking for nulls is a ""Junior to Intermediate developers problem"" In my opinion, always, always do Null checking – Osmar Dec 27 '17 at 15:17",,,,
,"@MetroidFan2002 ""If the find action method cannot find an action, then returning null is the right thing to do"" This is totally up to the designer of the program to decide whether an action that doesn't do anything fits his use case. it is totally valid to return an action that doesn't do anything if it fits your design. You imply that real/fake action differentiation is important to the caller, but both approaches are valid according to your use case. The case where not found action is important to the caller is also legit, but can be communicated through other means than returning null – Singed Jan 22 '18 at 20:44",1,,"talks about 'Do_nothing' action. Therefore, it should go in group 1.",ok
,As a person new to java i find it interesting that people would find it useful to do this. Why would a programmer not always instead write a try/catch statement and use that to avoid and resolve errors? – JFreeman Jan 25 '18 at 8:04,,,,
,"The second half of this example basically says do not use Java. While that might be a good idea, sometimes you don't have a choise. And in java, null is a valid value. – Rasmus Kaj Feb 8 '18 at 13:33",,,,
,"A find method opens up the possibility that it didn't find what we were looking for. A habit that works well for me is to use 2 distinct verbs for functions which can obviously fail: findXXX may fail and as such may return null or better an option, getXXX may only fail by throwing an exception. I've also seen variants such as find vs find_exn or find vs find_opt. One way or the other, as long as the usage is regular this is fine. – bltxd Feb 23 '18 at 13:21",,,,
,"The NOP approach is almost never a good one, in my opinion. Like others have said, it may hide deeper flaws in your program so that they only get found in production after weeks of troubleshooting. That's not always the case, obviously, but I would be extremely wary of using it. The rigorous and arguably correct answer to ""find me X"" when you don't find it is to return null if you expect it to possibly not be found, or throw an exception if it's not an expected outcome. (e.g. I would expect a findByName method to be able to return null, but a getById never should.) – Demonblack Aug 26 '19 at 11:15",3,,Null Object Pattern (NOP) is group 3,ok
,How about using the Optional<T>? – ch271828n Mar 2 at 10:33,,,,
,How about using Kotlin? – Joffrey Mar 3 at 15:49,,,,
https://stackoverflow.com/a/40878/5749570,"If you want to make a HashMap thread-safe, use Collections.synchronizedMap(). – Rok Strniša Nov 22 '11 at 18:48",2,2,,
,"I would also comment that the naive approach to thread-safety in Hashtable (""synchronizing every method should take care of any concurrency problems!"") makes it very much worse for threaded applications. You're better off externally synchronizing a HashMap (and thinking about the consequences), or using a ConcurrentMap implementation (and exploiting its extended API for concurrency). Bottom line: the only reason to use Hashtable is when a legacy API (from ca. 1996) requires it. – erickson Mar 16 '12 at 17:19",1,1,"Although these comments have overlapping topics, I think your ratings make more sense. Updated mine to match yours.",
,HashMap gives flexibility to programmer to write threadSafe code when they actually use it. It happened rarely that I needed a thread safe collection like ConcurrentHashMap or HashTable. What I needed is certain set of functions or certain statements in a synchronized block to be threadsafe. – Gaurava Agarwal Jun 27 '16 at 9:00,3,3,,
,Hashtable is obsolete and we are using HashMap for non thread safe environment. If you need thread safety then you can use Collections.synchronizedMap() or use ConcurrentHashMap which is more efficient that hashtable. – Maneesh Kumar Mar 30 '18 at 3:45,4,4,,
,"It's obsolete but not deprecated and I'm wondering why this is. I'm guessing removing this class (and Vector for the same reasons) would break too much existing code and annotating with @Deprecated would imply an intention to remove the code, which apparently is not there. – Jilles van Gurp May 19 '18 at 8:11",4,4,,
,"You can also use ConcurrentSkipListMap (docs.oracle.com/javase/10/docs/api/java/util/concurrent/…). It is thread-safe collection similar to ConcurrentHashMap and this map is sorted according to the natural ordering of its keys, or by a Comparator provided at map creation time. – rashid Jun 25 '18 at 7:25",5,5,,
https://stackoverflow.com/a/13375461/5749570,"Theory: Goats are found in all kinds of precarious places, like sheer cliffs, possibly bucking location trends they get from regular non-goat users. Might explain ""teleportations"", which could be goats appearing to wildly relocate as the software tries to determine their location with algos designed for non-goats. – tedders Nov 14 '12 at 12:58",2,2,,
,How does this answer add anything to the info that the question already showed? – LarsH Nov 14 '12 at 17:17,4,5,This will auto correct if you change the previous groups.,ok
,@LarsH - the source for one. – djechlin Nov 14 '12 at 20:07,4,5,,
,"This is a history lesson, not an answer. Even if it is an Easter egg, is there a valid use case for it? Being an Easter egg doesn't preclude it from being useful, and you've not shown whether it is or is not useful. – casperOne Nov 14 '12 at 20:26",3,3,,
,"@djechlin, one aspect of the source is informative, and now that the answer has been edited, it's far more obvious: (this implementation of) this method always returns false. – LarsH Nov 14 '12 at 20:52",4,5,"
This will auto correct if you change the previous groups.
",ok
,The method could be overridden in a test scenario. – Thorbjørn Ravn Andersen Aug 25 '13 at 6:13,,,,
,"It's also a reference to en.wikipedia.org/wiki/The_Men_Who_Stare_at_Goats , about a U.S. military project involving goats. – Matthew Flaschen Feb 19 '14 at 6:03",2,,Talk about Goat app. Group 2.,ok
,The monkey function is to detect the MonkeyRunner debug tool as specified in another answer. – logain Mar 30 '14 at 20:49,,,,
,They need to add canPigsFly(). while (!canPigsFly()) { /* code */ } – Jared Rummler Feb 5 '15 at 9:25,5,,"
This will auto correct if you change the previous groups.
",ok
,That's a real app. – Kevin Krumwiede Feb 21 '15 at 8:07,2,4,Talk about Goat app. Group 2.,ok
,"I feel bad for anyone who cheekily used this function, expecting it to return false forever. – Martin Konecny Apr 27 '15 at 5:11",1,1,,
,@casperOne given the content of the method I think the use case is pretty self explanatory. – Ced Aug 22 '15 at 5:40,3,,Reply to a comment in group 3.,ok
,"What's funny is there's an app with that ID: play.google.com/store/apps/…. And it's not free, nor made by Google! – raulk Jan 14 '16 at 18:58",2,,Talk about Goat app. Group 2.,ok
,"@raulk Yes, they used the ID of that app, they didn't pick a random app ID and then happen to have someone create an app with that ID... – user253751 Sep 27 '16 at 1:01",2,,Talk about Goat app. Group 2.,ok
,App is available for free through Amazon app store amazon.com/Coffee-Stain-Studios-Goat-Simulator/dp/B013KNQ2MS – Kevin Brotcke Jun 21 '17 at 0:05,2,,Talk about Goat app. Group 2.,ok
https://stackoverflow.com/a/13381101/5749570,"My bad - those are warnings, however they often lead to actual compile errors if you are returning from a block that control flow is now forced down. – djechlin Nov 14 '12 at 15:05",2,2,My bad. I changed mine.,
,Wouldn't compiler directive be a better use for conditions you want to compile out? – Andy Nov 14 '12 at 18:13,4,4,,
,"@djechlin I do not know if this is android only, in standard java ` if(false){...}` compiles just fine (open jdk javac 1.6 and 1.7) – josefx Nov 14 '12 at 20:24",2,2,,
,"@josefx - compiler warnings and can lead to errors if the branch the code is forced down has a return statement as this produces unreachable code. This is a useful compiler error; e.g. if you forget break; statements in a switch and your default case throws an exception, you will get this error. – djechlin Nov 14 '12 at 20:26",2,2,,
,"@djechlin sorry, I somehow failed to read your first sentence after seeing your (1==2) example - that if(false) is handled by the compiler is a downside in this case (and I should get some sleep to avoid more of these mistakes :-)). – josefx Nov 14 '12 at 20:36",2,2,,
,"@PeterOlson - if you are specifically trying to test a code branch where an if goes false or true, this is the most precise and obvious way to simulate that - commenting out the block could be less accurate if you don't match to the proper end of the block (perhaps you didn't notice a discreet if/else block immediately following), it will lead to a compile error if you're forcing to the following else block, etc. – djechlin Nov 15 '12 at 2:01",3,3,,
,"For ""if (false)"", check end of doc docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.21 – auselen Nov 15 '12 at 6:37",,,My bad. This is not group 3.,
,It is legal because a sub-class could override isUserAGoat() and return a different value. – Mike Dec 1 '12 at 10:34,,,,
,"@Vadzim nope, compiler will detect that always evaluates to true. – djechlin Oct 9 '13 at 15:43",4,4,,
,possibly because isUserAGoat is not final. – njzk2 Apr 7 '14 at 21:21,,,,
,"""provided the implementation doesn't change"" - and there's the problem. This is a disastrous way to implement a warning-free ""if (false)"" because the implementation can and does change. See my answer to this question: as of API21 isUserAGoat() returns true if a user has a specific app installed. Good luck diagnosing that when your code suddenly starts behaving oddly on ""random"" devices! – Mark Whitaker Nov 5 '14 at 12:29",1,1,,
,@MarkWhitaker Or if goats start using devices. – thedayturns Feb 18 '16 at 1:51,1,1,,
,@thedayturns If goats start using Android devices this will be the least of our problems. – Szymon Drosdzol Feb 29 '16 at 13:16,1,1,,
,"@djechlin No it isn't, did you actually try it? – user253751 Mar 19 '16 at 22:02",5,5,Changed mine to match yours.,
,@immibis what's that referring to? – djechlin Mar 20 '16 at 1:22,5,5,,
,@djechlin if(false) {/* stuff */} not compiling. – user253751 Mar 20 '16 at 2:26,5,5,,
,"@immibis guess you're right. Certainly gives this answer a long run of misinformation (and I had at least one chance to read a JLS citation and realize this). It's maybe material enough to keep around if the ""Eclipse warning/error"" happens but I will have trouble checking given my lack of Eclipse environment. At the least, I brought it up to being technically factual. – djechlin Mar 20 '16 at 2:46",5,5,,
,"@djechlin could you please remove the aforementioned misleading comment (stackoverflow.com/questions/13375357/…) - a lot of people his this answer, and, since newbies usually believe highly-upvoted things, we're actually educating newcomers that if(false){} is a compiler error in Java... – user719662 May 13 '16 at 23:59",,,Removed these ratings.,
,have you tried using /* and */ for commenting out code? – BlueWizard Nov 15 '16 at 8:17,,,,
,"@JonasDralle this is obviously a ridiculous answer, but that won't work for code that already has /* */ inside of it. It's also easy to mess up blocks that way if if ends in } } } } } } } }. – djechlin Nov 15 '16 at 13:06",,,,
https://stackoverflow.com/a/8710685/5749570,"So i+=j compiles as I checked myself, but it would result in loss of precision right? If that's the case, why doesn't it allow it to happen in i=i+j also? Why bug us there? – bad_keypoints Sep 22 '12 at 6:07",1,1,,
,"@ronnieaka: I'm guessing that the language designers felt that in one case (i += j), it is safer to assume that the loss of precision is desired as opposed to the other case (i = i + j) – Lukas Eder Sep 22 '12 at 8:31",1,1,,
,"No, its right there, infront of me! Sorry i didn't notice it earlier. As in your answer, E1 op= E2 is equivalent to E1 = (T)((E1) op (E2)), so that's kind of like implicit down typecasting (down from long to int). Whereas in i = i+j, we have to do it explicitly, ie, provide the (T) part in E1 = ((E1) op (E2)) Isn't it? – bad_keypoints Sep 22 '12 at 14:52",1,1,,
,I'd assume that this is used to avoid an explicit cast and/or f postfix in the situation of adding a double literal to a short? – nanofarad Aug 12 '13 at 14:28,4,4,I think yours is correct. I changed mine to match yours.,
,So is E1 op1 op2 op3 = E2 valid and equivalent to E1 = T(E1 op3 (E1 op2 (E1 op1 E2)))? – Hans Feb 25 '14 at 0:28,,5,This would become group 6 with a total upvote of 4.,ok
,"@Hans: You can't have several ""ops"" to the left of an assignment operator... I'm sure this is covered elsewhere in the JLS – Lukas Eder Feb 25 '14 at 6:53",,5,,
,"A likely reason to why the Java compiler adds a typecast is because if you're trying to perform arithmetic on incompatible types, there is no way of performing a typecast of the result using the contracted form. A typecast of the result is generally more accurate than a typecast of the problematic argument. No typecast would make the contraction useless when using incompatible types, as it would always cause the compiler to throw an error out. – ThePyroEagle Dec 22 '15 at 21:04",2,2,I think yours is correct. I changed mine to match yours.,
,"Why is 3 + 4.6 rounded to 7, not 8? – pyb Apr 2 '16 at 21:14",3,3,,
,It's not rounded. It's cast (= truncated) – Lukas Eder Apr 3 '16 at 12:40,3,3,,
,"The Puzzle 9 in the book ""Java Puzzlers"" (Joshua Bloch, Neal Gafter) covers exactly this issue. In the solution the authors highlight 2 phrases: ""Compound assignment expressions automatically cast the result of the computation they perform to the type of the variable on their left-hand side."" --- ""Do not use compound assignment operators on variables of type byte, short, or char."" – Stefan Neuhaus Oct 15 '16 at 17:11",,,,
,"Does this issue persist in Java today (Java 8, or 9)? – Nikos Jul 13 '17 at 22:32",5,,This should be group 5 with a total  upvote of 5,ok
,"@RestlessC0bra: I really really really hope that the JLS won't break incompatibly on that level :), so without trying (you could try this yourself), I'll say yes, the ""issue"" persists – Lukas Eder Jul 14 '17 at 10:20",5,,,
https://stackoverflow.com/a/157985/5749570,"That will be backed by the original input array, which is why you (probably) want to wrap it in a new ArrayList. – Bill the Lizard Oct 1 '08 at 14:46",1,2,This is group 1 because it is talking about Arrays not returing an object wrapping an inner array.,ok
,"Be careful with this solution. If you look, Arrays ISN'T returning a true java.util.ArrayList. It's returning an inner class that implements the required methods, but you cannot change the memebers in the list. It's merely a wrapper around an array. – Mikezx6r Oct 1 '08 at 14:47",1,1,,
,You can cast the List<Element> item to an ArrayList<Element> – monksy Oct 9 '09 at 22:48,2,3,This will auto align if you fix the above.,ok
,"@Mikezx6r: little correction: it's a fixed-size list. You can change the elements of the list (set method), you cannot change the size of the list (not add or remove elements)! – user85421-Banned Dec 4 '09 at 13:10",1,1,,
,"Yes, with the caveat that it depends on what you want to do with the list. It's worth notng that if the OP simply wants to iterate through the elements, the array doesn't have to be converted at all. – PaulMurrayCbr May 5 '13 at 9:23",3,4,This will auto align if you fix the above.,ok
,"@monksy No, you can't. As was said, it is a different kind of ArrayList. – glglgl Feb 22 '15 at 17:05",2,3,This will auto align if you fix the above.,ok
,"This does not work if array element is of primitive type in Java 8. For details, see stackoverflow.com/q/2607289/431698 – Jingguo Yao Feb 4 '16 at 7:05",4,5,This will auto align if you fix the above.,ok
https://stackoverflow.com/a/363692/5749570,"For calls where max value is Integer.MAX_VALUE it is possible to overflow ,resulting into a java.lang.IllegalArgumentException. You can try with : randInt(0, Integer.MAX_VALUE). Also, if nextInt((max-min) + 1) returns the most high value (quite rare, I assume) won't it overflow again( supposing min and max are high enough values)? How to deal with this kind of situations? – Daniel Aug 12 '14 at 10:34",1,1,,
,@momo the RANDOM class supports nextLong. You could use that instead of nextInt for longs. – Moishe Lipsker Jun 17 '15 at 17:18,4,4,My bad. Fixed.,
,@MoisheLipsker It must be that nextLong doesn't take a bound as nextInteger – mmm Jun 17 '15 at 18:42,4,4,,
,@momo Enlist help from the double. Just so: long val = ((long) (r.nextDouble() * (max - min))) + min – b1nary.atr0phy Aug 18 '15 at 1:01,4,4,,
,"Yes, I already do that, using the Math.random() which does that: public static long random(long min, long max) { return min + Math.round( Math.random() * ( (max - min) ) ); } – mmm Aug 18 '15 at 12:01",4,4,,
,"This snippet (that probably thousands of people copy) is BAD. It produce garbage. Just ThreadLocalRandom.current().nextInt(min, max). – leventov Sep 4 '15 at 9:07",2,2,,
,@leventov ThreadLocalRandom was added to Java 2 1/2 years after this question was first asked. I've always been of the firm opinion that management of the Random instance is outside the scope of the question. – Greg Case Sep 11 '15 at 1:57,2,2,,
,"@AbhishekSingh The comments try to address this, but in more detail: nextInt(N) returns a number from 0 to N - 1, i.e. it will never return N as a result. In this case we want to include N in our possible range of values, so we add one: nextInt(N+1) => returns a number in the range 0 to N, inclusive of both 0 and N – Greg Case Oct 12 '15 at 4:51",5,5,My bad. Fixed.,
,In Android Random rand = new Random(); – Webserveis Oct 3 '16 at 19:55,3,3,,
,"@Webserveis This is addressed in the comments in the example. Short version - you should not = new Random() for every call to the function, or your results will not be sufficiently random for many cases. – Greg Case Oct 4 '16 at 0:29",3,3,,
,Shouldn't you initialize the rand = new Random()? – Chit Khine Mar 7 '17 at 8:02,3,3,,
,"@ChitKhine Not on each call to the function. The RNG algorithm under the hood of Random works well (enough for non-cryptographic applications) when generating successive random numbers. However, if the Random instance is re-created on each call, that means that instead of a proper RNG you're going to get ""random"" numbers based on whatever seed is chosen each time - often this is based on the system clock. This can give decidedly non-random results. Instead, you should consider instantiating your Random instance outside of method scope. The example code attempts to address this. – Greg Case Mar 13 '17 at 3:09",3,3,,
,Use ThreadLocalRandom.current().nextBytes(chunk); if you want to save yourself the new Random(). Thanks to a really popular question on generating random Integers in Java. – user5365075 Feb 20 '18 at 13:04,,,I think I misclassified these as group 3. Removed the annotation.,
,"and if you're using for android java ThreadLocalRandom.current().nextInt(1, 100) it requires min API Level 21 – Aman Nov 14 '18 at 13:19",,,,
,"Do these methods return integers, or real numbers. In other words, what method should be called if my bounds were 1.33 < x < 4? – JustAnotherGuy Oct 6 '19 at 4:35",6,,My bad. Fixed although of no importance to us.,
,"@JustAnotherGuy The examples in this answer strictly deal with integers. For the real numbers case, a variant on the technique described in stackoverflow.com/a/363732/462 should work. Recommend not using Math.random() but instead an appropriate double-based method of ThreadLocalRandom or Random instead. – Greg Case Oct 15 '19 at 20:33",6,,,
,Maybe these examples can help even more: apisonar.com/java-examples/… – APISonar Dec 17 '19 at 14:04,7,,,
https://stackoverflow.com/a/8881461/5749570,"I'd replace ""completely useless"" with ""just a minor security improvement"". For example you could get access to a memory dump if you happen to have read access to a tmp directory, a badly configured machine and a crash in your application. In that case you wouldn't be able to install a keylogger, but you could analyze the core dump. – Joachim Sauer Jan 16 '12 at 16:23",2,2,,
,"Wiping unencrypted data from memory as soon as you're done with it is considered a best practice not because it's foolproof (it's not); but because it reduces your threat exposure level. Real time attacks aren't prevented by doing this; but because it serves a a damage mitigation tool by significantly reduces the amount of data that is exposed in a retroactive attack on a memory snapshot (eg a copy of your apps memory that was written to a swap file, or that was read out of memory yanked from a running server and moved to a different one before its state failed). – Dan Is Fiddling By Firelight Jan 16 '12 at 16:26",1,1,,
,"I tend to agree with the attitude of this response. I'd venture to propose most security breaches of consequence occur at a much higher level of abstraction than the bits in memory. Sure, there are probably scenarios in hyper-secure defense systems where this may be of considerable concern but seriously thinking at this level is overkill for 99% of the applications where .NET or Java are being leveraged (as it related to garbage collection). – kingdango Jan 17 '12 at 18:18",4,4,,
,"maybe localhost isn't what you want to protect. Maybe you have created a program running on an unsecure client and you need the password for accessing a database. If you don't trust the client and are trying to protect the database, wiping passwords from memory is good advice. – Rolf Rander Jan 20 '12 at 17:19",5,5,,
,"@RolfRander that is even worse, you should not enter passwords on an untrusted client - use a one time key (not sure this is the right term, a password that only works once and gets locked out after that use). – josefx Jan 20 '12 at 19:08",5,5,,
,most websites use passwords for login. Your credit card number and security-digits is also a kind of password. – Rolf Rander Jan 20 '12 at 19:31,5,5,,
,"@RolfRander there is nothing about websites that requires an untrusted client, if the user chooses to use a compromised system then there is nothing that you can do to protect him from the consequences. – josefx Jan 20 '12 at 20:58",5,5,,
,"as I said, the point might be protecting the server, not the client. My point with the website-example is that there are lots of services using passwords (for different reasons, although other mechanisms obviously would be more secure. Bottom line being that a scenario where you want to protect the server, won't trust the client and are using passwords, storing passwords in a char[] is a wise choice and this isn't really a far-fetched scenario. – Rolf Rander Jan 20 '12 at 22:02",5,5,,
,@RolfRander somehow I get the feeling that you use a single login for all your clients and don't have any security/validation serverside. Its your duty to make sure that a user can't compromise the database (access restrictions and validation serverside) and the users duty to make sure that his account can't be compromised (his password). – josefx Jan 21 '12 at 10:06,5,5,,
,"Absolutely. But for the user to make sure his password isn't compromised, the software handling the password has to take care to reduce the chance that malware (on the client) can pick up passwords from the client application memory. To achieve that, I believe storing the password in a char[] and overwriting this afterwards is good advice. – Rolf Rander Jan 22 '12 at 11:49",5,5,,
,I'd say that of someone understands the thinking behind the char vs sting then they are more likely to be thinking of security when configuring the servers. Not thinking is what usually introduces security holes. – Tinman Oct 10 '12 at 21:28,7,,,
,"After the Heartbleed penetration of server memory, revealing passwords, I would replace the string ""just a minor security improvement"" with ""absolutely essential to not use String for passwords, but use a char [] instead."" – Peter vdL Jul 24 '14 at 5:15",3,3,,
,"@PetervdL heartbleed happened because someone got the great idea that reusing memory was cheaper than allocating new (cleared) memory, you cannot reuse a String in Java, just hope that nobody ever gets the idea to put your char[] into a reuse list for better performance. – josefx Jul 26 '14 at 14:47",3,3,,
,"You're missing the point completely, Josefx. The point is that heartbleed allowed remote reading of process memory, which everyone had hitherto thought very unlikely. When combined with the use of Java strings, passwords are easily revealed. Char [] allows the developer to blank out passwords, String does not even give that opportunity. Char [] + heartbleed may be harmful if coder screws up. String + heartbleed == definitely always harmful. – Peter vdL Jul 27 '14 at 18:45",3,3,,
,"@PetervdL heartbleed only allowed reading of a specific reused collection of buffers (used for both security critical data and network I/O without clearing in between - for performance reasons), you cannot combine this with a Java String since they are by design not reuseable. Nor can you read into random memory using Java to get at the contents of a String. The language and design problems that lead to heartbleed are just not possible with Java Strings. – josefx Jul 30 '14 at 17:39",3,3,,
,"@PetervdL then please do not refer the ""heartbleed bug in combination with Java Strings"" and I am sure most I mentioned in relation to heartbleed was correct, the libreSSL developers got quite detailed on why OpenSSL was a security nightmare. There ""may"" be a way to use a bug in the JIT to bypass Javas build in range checks or the automatic zeroing of object memory and it ""might"" be possible for someone to trigger this from a remote location without crashing the JVM, however that has nothing in common with heartbleed, nor would any bug on the JVM be so simple or optimized for exploits. – josefx Jul 31 '14 at 19:39",3,3,,
,"@PetervdL It's not just not ""specific"" to the Heartbleed bug; it's totally inapplicable. I suggest you don't reference Heartbleed as justification for security measures until you have a better grasp of its nature. Thanks to josefx for shedding light on this often misunderstood issue. – DavidS Jul 8 '15 at 5:15",3,3,,
,There is yet another case - when the JVM crashes and produces a memory dump. – ACV Apr 25 '18 at 22:33,,,,
,"Why would you store the password in in memory? external system? web or api request submits a string (ironically), so it's in memory anyway at that point. I'd never store the login password in another variable (other than the readonly one it's sent to the server with) unencrypted for any reason? Should web requests convert letters to their char number equiv to submit so the request variable is a number? As there is no char datatype from the browser? – Dawesi Aug 5 '18 at 19:59",,,,
,And for completeness let's not forget the more recent meltdown and spectre attacks: meltdownattack.com which could be exploited via a web browser or shared hosting environment. – Stefan L Dec 17 '18 at 16:18,,,,
https://stackoverflow.com/a/1066603/5749570,"Though old style, this will help avoid ConcurrentModificationExceptions over the new foreach style in the answers below. You can for instance remove via the seperate iterator. – Benjamin Wootton Dec 16 '10 at 9:22",3,3,,
,"@karim79 what do you think about the following way: Map<Integer, Integer> map = new HashMap<Integer, Integer>(); for (Map.Entry<Integer, Integer> entry : map.entrySet()) { System.out.println(""Key = "" + entry.getKey() + "", Value = "" + entry.getValue()); } – fresh_dev Oct 25 '11 at 8:56",1,1,,
,by calling 'it.remove(); ' you are emptying the map making it not reusable if this map was a class variable. Do you have any solution to that? – vim Jan 10 '12 at 9:47,2,4,,
,@vimukthi what do you mean a solution to that? Just remove the it.remove(); line. – Danny Jan 26 '12 at 19:07,2,4,,
,"The for (Map.Entry<String, Object> cursor : map.entrySet()) {...} syntax is much better. – Chad Okere Jan 28 '12 at 17:29",1,2,This should be in group 1 as it also talks about Map.Entry syntax.,ok
,Is there any difference on chances of ConcurrentModificationExceptions between both syntaxs in terms of calling remove() or not? Some answers imply contradictory assertions (first vs fourth comments) – Whimusical Jul 19 '12 at 12:41,3,,Should be group 3 as it talks about CME,ok
,Iterator interface is generic since 1.2. It need to be Iterator<E> – etlds Mar 5 '13 at 19:37,5,,,
,"I consider that the answer of arvnid, despite is just a copy/paste or not. (I agree that is ethical to give the proper credits to the one who belongs) – Victor Feb 28 '14 at 15:46",,,,
,"I landed up here accidentally, why did we do Iterator.remove() here? OP just asked for a best way for iterating over a Map – Puru-- Apr 13 '14 at 18:42",4,5,,
,"Note that it.remove will not work with unmodifiable Maps, like System.getenv() return String Map. – J E Carter II May 14 '14 at 15:06",,,,
,The full type of iterator is : import java.util.Iterator; – Moebius Sep 3 '14 at 13:13,,,,
,@harto's answer is a better one as it tells the reader how to actually use this in a variety of cases. Your solution's application range is tiny. Very tiny. – Hele Dec 15 '14 at 5:19,,,,
,"Don't you jump over the first entry using the ""linewhile (it.hasNext())""? – Jürgen K. Oct 19 '15 at 17:38",,,,
,So the big picture steps seem to be 1. convert to a set using entrySet 2. turn it into an iterator and 3. call hasNext and turn each next Object into a Map.Entry Object? – Jwan622 Jan 7 '16 at 16:03,,,,
,"Everyone saying that for (Map.Entry<String, Object> cursor : map.entrySet()) is better than this is ignoring the fact that you will still receive a ConcurrentModificationException using that method. The selected answer remains the best method to iterate through a Map. – ashishduh Dec 2 '16 at 18:22",1,,This should be in group 1 as it also talks about Map.Entry syntax.,ok
,"@JürgenK. No, it.hasNext() returns a boolean based on whether the iterator has another element beyond the current one but does not advance the iterator's state. The iterator isn't advanced to the next element until it.next() is called. – apraetor May 11 '17 at 22:00",,,,
,@Alex yeah me too – NimChimpsky May 31 '17 at 2:37,,,,
,"@ashishduh The selected answer is only the best in the special case where you need to modify the map during iteration. For all other uses, using an enhanced for loop is preferable. – nemetroid Jun 29 '17 at 8:22",1,,This should be in group 1 as it also talks about Map.Entry syntax.,ok
,"This API is not intuitive, so I google this answer repeatedly and was at least 20 times on this answer!! – flipperweid Jul 6 '17 at 13:49",,,,
,"@etlds Actually, Java 1.2 introduced Iterator, but didn't have generics back then. Generics were only added in 1.5. – Paŭlo Ebermann Aug 21 '17 at 17:57",5,,,
,Please do not use Iterator anymore. – Impulse The Fox Sep 18 '17 at 7:52,,,,
,"i get unchecked cast and unchecked assignment warnings for '(Map.Entry)it.next()'. I did add a check to Map,Entry: 'Map.Entry<Integer,MyObject> entry' to avoid other issues. – Androidcoder Oct 22 '17 at 21:56",,,,
,"Since Map is not under Iterator class, how can you use iterator with map ? Only List, Queue and Set are iterable. – Rishabh Agarwal Dec 6 '17 at 6:45",,,,
,"Perhaps update this for Java 8? (E.g. providing two versions, one for before Java 8 and one that only works on Java 8.) – Peter Mortensen Feb 6 '18 at 22:57",,,,
,"ConcurrentHashMap is an implementation of ConcurrentMap interface. ConcurrentMap Interface extends Map Interface. The confusion is because the question specifically asked for HashMap. HashMap is an implementation of Map interface. It is always better to declare a ConcurrentHashMap like: Map<String,String> myMap = new ConcurrentHashMap<String,String>(); instead of : ConcurrentHashMap<String,String> myMap = new ConcurrentHashMap<String,String>(); This first practice allows extensibility. That is the reason this is a mature answer. – technazi Apr 19 '18 at 4:06",,,,
,"I consider it bad answer. OP was asking just for iterating over map, not how to modify map during iteration. – Mader Levap Mar 1 '19 at 13:05",,,,
https://stackoverflow.com/a/46908/5749570,"If you do that, then it won't work as Entry is a nested Class in Map. java.sun.com/javase/6/docs/api/java/util/Map.html – ScArcher2 Mar 22 '10 at 13:30",1,1,,
,"you can write the import as ""import java.util.Map.Entry;"" and it will work. – jjujuma Apr 30 '10 at 10:34",1,1,,
,"@Pureferret The only reason you might want to use an iterator is if you need to call its remove method. If that is the case, this other answer shows you how to do it. Otherwise, the enhanced loop as shown in the answer above is the way to go. – assylias Oct 8 '12 at 10:34",2,3,Will auto align if you correct the below rating,
,I believe the form Map.Entry is clearer than importing the inner class into the current namespace. – JosiahYoder-deactive except.. Dec 4 '14 at 20:31,1,2,Group 1. Talks about Map.Entry,ok
,where is map from map.entrySet() declared ? – Saras Arya Apr 6 '15 at 11:19,,,,
,"quick Question: do the Generic values <String, String> need to match that of the Map? For Example, mine is <String, Foo>. – Fallenreaper Jun 22 '15 at 13:10",,,,
,This is assuming your Map is named map of course. Beginners might not catch on. – intcreator Sep 28 '15 at 20:28,5,,Will auto align if you correct the above rating,
,"@brandaemon Agreed. Even for intermediates, it's nice to see precisely which type implements the entrySet method. – jpaugh Jan 26 '16 at 20:38",5,,,
,Note that you can use map.values() or map.keySet() if you want to loop through values or keys only. – dguay Oct 12 '16 at 21:03,3,4,,
,That is not efficient. The Map holds the data in an entry set. For speed always iterate over the entry set. – Marcus MacWilliam Feb 13 '18 at 15:15,4,5,,
,"I get and incompatible types error for 'Map.Entry entry' and 'Map.Entry<Integer,HashMap> entry: ""required Object, found Entry"". I'm mapping integers to hashmaps. Having to use the keyset for loop because of this and pull the value through 'value = (HashMap) integertomap.get(key)', though less efficient then if I could use entrySet without iterater as per your example. – Androidcoder Jul 25 '18 at 16:44",,,,
,"@MarcusMacWilliam ""The Map holds the data in an entry set"" - This is not true for many Map implementations. See TreeMap implementation for example which traverses the tree for either keys, values or entries. – JimmyB Nov 14 '18 at 14:09",4,,,
,"@ScArcher2 No it isn't. It is a nested interface, and even if it was a nested c,ass it would still work. This code works. Been using. It for 15 years. No import required. – user207421 Feb 14 '19 at 9:43",1,,Group 1. Reference to Archer,ok
https://stackoverflow.com/a/6471947/5749570,"\+1 ClassLoader leaks are some of the most commonly painful memory leaks in the JEE world, often caused by 3rd party libs that transform data (BeanUtils, XML/JSON codecs). This can happen when the lib is loaded outside your application's root classloader but holds references to your classes (eg. by caching). When you undeploy/redeploy your app the JVM is unable to garbage collect the app's classloader (and therefore all classes loaded by it), so with repeat deploys the app server eventually borks. If lucky you get a clue with ClassCastException z.x.y.Abc cannot be cast to z.x.y.Abc – earcam Jun 27 '11 at 16:55",1,1,,
,"tomcat uses tricks and nils ALL static variables in ALL loaded classes, tomcat has a lot of dataraces and bad coding though (need to get some time and submit fixes), plus the all mind-boggling ConcurrentLinkedQueue as cache for internal (small) objects, so small that even the ConcurrentLinkedQueue.Node takes more memory. – bestsss Jun 30 '11 at 19:49",2,3,Will auto align if you correct the below rating,ok
,"\+1: Classloader leaks are a nightmare. I spent weeks trying to figure them out. The sad thing is, as what @earcam has said, they are mostly caused by 3rd party libs and also most profilers can't detect these leaks. There's a good and clear explanation on this blog about Classloader leaks. blogs.oracle.com/fkieviet/entry/… – Adrian M Jul 8 '11 at 9:08",1,2,Group 1. Talks about classloader nightmares,ok
,"@Nicolas: Are you sure? JRockit does GC Class objects by default, and HotSpot doesn't, but AFAIK JRockit still can't GC a Class or ClassLoader that is referenced by a ThreadLocal. – Daniel Pryden Jul 11 '11 at 17:01",4,5,Will auto align if you correct the above rating,ok
,"Tomcat will try to detect these leaks for you, and warn about them: wiki.apache.org/tomcat/MemoryLeakProtection. The most recent version will sometimes even fix the leak for you. – Matthijs Bierman Mar 2 '12 at 10:33",2,4,Group 2. Talks about Tomcat issues.,ok
,"For future references, there is one more tool trying to solve classloader leaks: Plumbr – Nikem Sep 11 '12 at 6:06",,,,
,"@DanielPryden Does this gist(gist.github.com/4057644) shows what you described? but it won't go out of memory according to my test,correct me if there is any misunderstanding,thanks – DiveInto Nov 12 '12 at 5:23",4,,Group 4. Reference to Daniel,ok
,"@DanielPryden I have update my gist,please check: gist.github.com/4057644#gistcomment-595443 – DiveInto Nov 15 '12 at 3:24",4,,Group 4. Reference to Daniel,ok
,"Okay A little stupid question...Will it be termed as a memory leak,if the GC(Garbage Collector) doesn't kicks in? I am not sure whether one can invoke GC explicitly. – Sid Aug 12 '13 at 16:58",5,,,
,"@Sid: the issue is not whether or not the GC actually runs (Raymond Chen argues that a no-op GC is a valid implementation, see Everybody thinks about garbage collection the wrong way), it's whether, even if the GC did run, it would be unable to reclaim an object that is no longer visible to any running code. A ClassLoader leak is one way to end up with objects that cannot be found or used, but that still occupy memory and are rooted for GC purposes, so the GC cannot reclaim them. – Daniel Pryden Aug 14 '13 at 0:10",5,,,
,"It would be great if you could provide the code, I could not get all the steps! How to create one with a non-static member ? thanks. – Jack May 14 '14 at 2:54",,,,
,"@JackMoore: I don't have ""the code"", this is just an example of a systemic problem. The issue is that a ThreadLocal creates a strong reference to an instance of a class, and through that instance to the class itself (and to all data statically reachable from the class), including the ClassLoader that loaded the class. But you can clear all references to the ThreadLocal object instance and not clear the underlying GC reference as long as the referenced Thread is still running. Basically, the Thread has an invisible, uncollectable reference to the ThreadLocal storage, which thus leaks. – Daniel Pryden May 20 '14 at 20:53",,,,
,"@AfterWorkGuinness: See my response to Jack Moore. Does that make sense? The Thread itself can be a GC root even if, for all other intents and purposes, there are no more references to the given value reachable from Java code. If you have a thread pool and you load and unload classes using a ClassLoader, it's entirely possible that any particular thread in the pool may outlive the classes, and can this keep a large amount of memory (all classes in the ClassLoader, and all data statically reachable from any of them) ""reachable"" for GC purposes although the values can't be reached from code. – Daniel Pryden May 20 '14 at 20:59",,,,
,@DanielPryden could you post a code snipped for this ? I'm having trouble visualizing it. – AfterWorkGuinness Aug 22 '14 at 15:31,,,,
,"@igaurav: Regarding your edit to this answer, please see the discussion at meta.stackoverflow.com/questions/289814 – Daniel Pryden Apr 11 '15 at 22:43",,,,
,"I think this is not a ""true"" memory leak. One could still retrieve the loaded classes by investigating the Thread object's package visible threadLocals member field via reflection. So this isn't a more ""true"" leak than a simple unused private field. – Tamas Hegedus Apr 3 '16 at 19:17",3,,Group 3,ok
,"@TamasHegedus: It's true that you can find specific cases of this using reflection, but that only works if the installed SecurityManager allows it, and it also depends on you being able to programmatically identify a type as being no longer in use. In a constrained case this is certainly doable, but I don't think it solves the general case. – Daniel Pryden Apr 3 '16 at 21:41",3,,,
,"I am not sure whether I understand you right: The thread own the ThreadLocalMap which own threadLocal variable and class. But the content in ThreadLocalMap is weakly reachable, shouldn't it be GCed when memory is not enough? – Tony Apr 25 '16 at 14:57",3,,,
,"@Tony: Each Thread holds strong references to every ThreadLocal. So the ThreadLocal values can't be GC'd as long as the thread keeps running. This kind of problem often surfaces in an application container that owns a thread or thread pool that runs as long as the JVM does, which effectively keeps the garbage rooted forever. You're right though that if you ensure that all threads that could possibly be holding a ThreadLocal have been forcibly terminated, you can fix the leak. But in a large application that can often be an intractable task. – Daniel Pryden Apr 26 '16 at 5:52",3,,,
,"Sorry, but I can't find any reference about 'Each Thread holds strong references to every ThreadLocal.'. From source, the ThreadLocalMap's Entry is extended from WeakReference, shouldn't it mean the entry may be GCed when no strong reference to the entry holds? Thank you. – Tony Apr 26 '16 at 6:26",3,,,
,"@Tony: the Javadoc on ThreadLocal says: ""Each thread holds an implicit reference to its copy of a thread-local variable as long as the thread is alive and the ThreadLocal instance is accessible"". Empirically this prevents a Class object for the type of value stored in a ThreadLocal from being GC'd while the thread is running: see the Gist I linked to in my answer for an example. – Daniel Pryden Apr 26 '16 at 15:08",3,,,
,"Oh, the class also have a strong reference to its static field(ThreadLocal in this case), so this make ThreadLocal stay in memory. Isn't it? – Tony Apr 27 '16 at 2:03",3,,,
,"When I ask a question in an interview, especially like this, the answer isn't ""here's how you do it"". I make a point of asking questions that don't have a look-it-up-on-stackoverflow answer. Instead, I expect a discussion about what a memory leak is, how java works, the internal data structures. I am hoping for ""If you mean having a process consume a ton of memory and halt, there are a bunch of ways, I can show you a handful. Is that what you want? It's not technically a leak though."" ( Then code it in 2 lines ). Or tell a war story about tracking one down. That's the person I want to hire. – Brian Bulkowski Apr 18 '17 at 18:09",,,,
,"Note that, since Java 8, there is no longer a permgen but the Metaspace. Memory leaking still persists, but the main difference besides the name is that Metaspace size can be auto-incremented. – AMDG Sep 5 '17 at 22:04",,,,
,"I'm getting a recourse leak. I'm calling Class.forName(""com.informix.jdbc.IfxDriver""); in a scheduled thread. Would that cause a resource leak? @TamasHegedus – Philip Rego Sep 8 '17 at 20:14",,,,
,"@philiprego no, that wouldn't as far as you load the same driver every time – Tamas Hegedus Sep 9 '17 at 8:30",,,,
,"@community wiki, so what if I can't get away with long running threads? like I need to fetch something perpetually from the DB or somewhere else? – Artanis Zeratul Dec 11 '18 at 22:35",,,,
,"@ArtanisZeratul: It sounds like you're trying to ask a new question. You can do that by clicking ""Ask Question"". And ""community wiki"" isn't a person, it just means that all of the answers to this question are owned by the whole community rather than individuals. – Daniel Pryden Dec 11 '18 at 22:45",,,,
,Why this elaborate scheme with the ClassLoader though? Why isn't it enough to create some objects and put them into ThreadLocal? – Malcolm Mar 1 '19 at 17:15,3,,Group 3,ok
,"@Malcom: The reason the ClassLoader makes a difference is because, if you lose the reference to the Class that contained the reference to the ThreadLocal, you no longer have any way to get a reference to the ThreadLocal object. So the memory is leaked because you can't write code that can remove, or even retrieve, the leaked object anymore. – Daniel Pryden Mar 1 '19 at 18:24",3,,,
,"@DanielPryden: @Malcom is right. When the value of the ThreadLocal points back to the ThreadLocal object itself (maybe directly, or through some intermediate references), there's a leak. It doesn't matter if the intermediate references are in a ClassLoader or not. Here's a small example that creates a memory leak simply by creating a ThreadLocal object that directly points back to itself: repl.it/@jcsahnwaldt/ThreadLocalLeakExample – jcsahnwaldt says GoFundMonica Nov 23 '19 at 15:17",3,,,
,"@Tony: ""Oh, the class also have a strong reference to its static field (ThreadLocal in this case), so this make ThreadLocal stay in memory. Isn't it?"" - Well, the main thing is that the value of the ThreadLocal is a (direct or indirect) reference to the ThreadLocal itself. Due to some details of the ThreadLocal implementation in Sun's/Oracle's JDK, this creates a leak. The exact reference path to the ThreadLocal - whether directly, through static fields, or through instance fields - doesn't matter. – jcsahnwaldt says GoFundMonica Nov 23 '19 at 15:27",3,,,
,"By the way, the original implementation of ThreadLocal in JDK 1.2 didn't have that problem. Give it a try: download github.com/fanhongtao/.../jdk_1.2.1/.../ThreadLocal.java, remove the package declaration, and compile and run it with @DanielPryden's sample code - no memory leak! (That implementation had other problems though. Josh Bloch mentions some of them here: cs.oswego.edu/pipermail/concurrency-interest/2007-October/… ) – jcsahnwaldt says GoFundMonica Nov 23 '19 at 15:32",3,,,
,"@Jepessen: ""I just don't understand why the thread must be long-running"" - In Sun's/Oracle's implementation of ThreadLocal, thread-local values are actually stored in a map that is attached to the thread. When the thread dies, the garbage collector eventually clears this map, which would also remove the memory leak in this example. github.com/openjdk/jdk/blob/master/src/java.base/share/classes/… – jcsahnwaldt says GoFundMonica Nov 23 '19 at 15:42",3,,,
https://stackoverflow.com/a/424936/5749570,"Wow! I'll try to convert this to Java and do a comparison, as well as an accuracy check on the results. I'll let you know what I find. – Kip Jan 12 '09 at 21:47",3,3,,
,"Testing on all values is impossible, but a test on suspect values (+/- 1 from very large perfect squares) has proven to be accurate. On a run of the first billion integers, this only took 34% of the time required by the original algorithm. – Kip Jan 16 '09 at 20:13",3,3,Agreed. This is group 3. Fixed mined.,
,"Awesome! I'm glad it worked out for you. One thing that's different in C(++) and Java is that Java checks bounds on array lookups, so I thought you might take a hit there. – A. Rex Jan 16 '09 at 20:50",3,3,,
,"Seems that this only returns true/false, but it will be difficult to return the square root itself? – Dimitre Novatchev Mar 27 '09 at 23:44",4,,Should be group 4,ok
,"Wow, this is beautiful. I'd seen Hensel lifting before (computing roots of polynomials modulo a prime) but I hadn't even realised the lemma could be carefully lowered all the way for computing square roots of numbers; this is... uplifting :) – ShreevatsaR May 25 '09 at 2:36",1,1,,
,"@Dimitre Novatchev: No, it would not be too difficult. If the number is a perfect square, then its square root is r times some power of 2, which can be determined when dividing out by powers of 4. – A. Rex Dec 3 '09 at 23:50",4,,Should be group 4,ok
,@A. Rex: HotSpot is able to eliminate bounds checks in certain circumstances stackoverflow.com/questions/4469483/bounds-checking-in-java so the hit is probably being avoided. – PeterT Jan 11 '11 at 15:08,4,,Should be group 4,ok
,"@A. Rex: I might be mistaken, but isn't 9 a perfect square? And doesn't if( x < 0 || (x&2) || ((x & 7) == 5) || ((x & 11) == 8) ) return false; filter it out as not being one? And similar for all other uneven perfect squares? – orlp Sep 17 '12 at 8:20",4,4,,
,"@nightcracker It doesn't. 9 < 0 => false, 9&2 => 0, 9&7 == 5 => false, 9&11 == 8 => false. – primo Dec 2 '12 at 7:56",4,4,,
,"Maartinus posted a 2x faster solution (and much shorter) down below, a bit later, that doesn't seem to be getting much love. – Jason C Mar 17 '14 at 3:46",2,2,,
,"@A.Rex AFAIK, the final test t <= (1LL << 33) is useless as you either get a square root or overshoot anyway. I dropped it and it works (but maybe there's a gotcha with numbers I haven't tried?). – maaartinus Jun 13 '14 at 19:21",4,,Should be group 4,ok
,It seems like a lot of the speed advantage in the different solutions is gained by filtering out the obvious squares. Did anyone benchmark the situation of filtering out via Maartinus' solution and then just using the sqrt function as that's a built-in function? – user1914292 Oct 7 '14 at 17:26,5,5,,
,LL in y & 4294967295LL not needed. – chux - Reinstate Monica May 21 '18 at 8:30,,,,
,"“Next, check if it's a square modulo 255 = 3 * 5 * 17. Because that's a product of three distinct primes, only about 1/8 of the residues mod 255 are squares.” Actually, the proportion of squares modulo 255 is 54/255 ≃ 0.212, much more than 1/8 = 0.125 (because the proportion of squares modulo each of the prime factors are slightly more than 1/2). But note that you are not limited to primes. The proportion of squares modulo 256 is 44/256 ≃ 0.172, and computing modulo 256 is much more convenient. – Maëlan Sep 29 '19 at 15:31",,,,
,"That’s essentially one of the things maaartinus’ answer does, except that it uses 64 instead of 256 (which gives a more compact precomputed table with a better cache behavior, while still being pretty efficient at filtering out non-squares, as the proportion of squares modulo 64 is 12/64 ≃ 0.188). – Maëlan Sep 29 '19 at 15:50",,,,
https://stackoverflow.com/a/2885224/5749570,Worth noting PrintWriter will truncate the filesize to zero if the file already exists – Covar May 21 '10 at 20:16,1,1,,
,"PrintWriter can be (and often is) used, but is not (conceptually) the right class for the job. From the docs: ""PrintWriter prints formatted representations of objects to a text-output stream. "" Bozho's answer is more correct, though it looks cumbersome (you can always wrap it in some utility method). – leonbloy May 21 '10 at 20:40",1,2,Group 1. Talks about printwriter,ok
,will it print the html file as well? – adesh singh Aug 3 '13 at 6:24,4,5,Will auto align if you fix the above rating.,ok
,"@adeshsingh no one ever tried out so faar, be the first one! – JBA Mar 3 '14 at 19:00",4,5,,
,So where will the textfile will be created after the app is build and used in another PC since we have not given the path? – Marlon Abeykoon Apr 25 '14 at 5:28,2,3,,
,"@MarlonAbeykoon Good question. The answer is that it will create the text file in the working directory. The working directory is whatever directory you execute your program from. For example, if you execute your program from the command line, then the working directory will be whatever directory you are ""in"" at that moment (on Linux, type ""pwd"" to see the current working directory). Or, if I double-click a JAR file on my desktop to run it, then the working directory will be the desktop. – Michael Sep 2 '14 at 12:06",2,3,,
,"If you want to append and not truncate u can replace PrintWriter with FileWriter: FileWriter(new File (""the-file-name.txt""), true).. one trade-off is FileWriter assumes default character encoding and buffer sizes – Rondo Nov 19 '14 at 1:01",1,,Group 1. Talks about printwriter,ok
,The syntax for declaring the byte array is incorrect. Should be byte[] data = .... – kamoroso94 Aug 23 '16 at 18:44,5,,,
,writer.close() should be in a finally block – Thierry May 11 '17 at 22:16,3,4,Will auto align if you fix the above rating.,ok
,Why is it bad practice to use PrintWriter for this job? Does it perform more slowly? – Apollys supports Monica May 12 '17 at 18:23,1,,Group 1. Talks about printwriter,ok
,@Apollys PrintWriter swallows exceptions: stackoverflow.com/a/1747092/4678667 – micsthepick May 31 '18 at 6:38,1,,Group 1. Talks about printwriter,ok
,"I would suggest to use File.createNewFile() method to create and verify file creation success. It returns a boolean value : true if the file is created successfully. I don't like waiting for exceptions to tell something has failed. Only after file has been created and you have verified it, start writing data into it. It can save many bytes. Ref – lokesh Aug 11 '18 at 6:10",,,,
https://stackoverflow.com/a/30727799/5749570,"In short then, Java intentionally allows it: the ""bug"" is in the OP's IDE? – Bathsheba Jun 9 '15 at 9:15",1,1,,
,"@Bathsheba: It's more in the heads of people. People don't try to understand how Java parsing works, so IDEs sometimes display the code in a wrong way. In the example above, the comment should end with \u000d and the part after it should have code highlights. – Aaron Digulla Jun 9 '15 at 9:17",1,1,,
,Another common mistake is to paste Windows paths in the code like // C:\user\... which leads to a compile error since \user isn't a valid Unicode escape sequence. – Aaron Digulla Jun 9 '15 at 9:18,2,2,,
,"I understand introduction of unicode characters, but not so much why it is allowed in comments? – Reg Jun 9 '15 at 9:19",,,,
,In eclipse the Code after \u000d is highlighted partially. After pressing Ctrl+Shift+F the character is replaced with new line and rest of line is wrapped – bluelDe Jun 9 '15 at 9:21,3,3,Fixed mine. Yours look better.,
,So.. this is related to how the compiler parses the source-code file?. This problem can't be reproduced when we use block comments instead of single line comments – TheLostMind Jun 9 '15 at 9:22,4,4,,
,"@Reg, there are many features of the language that doesn't make sense in conjunction with other features of the language. In this case, the language designers put the unicode escape handling before the parser, and being able to use unicode escapes in commens was simply a (possibly unfortunate) side effect. – aioobe Jun 9 '15 at 9:22",,,,
,"While I agree with the answer from @aioobe that the source code is valid and the problem is rather in the IDE (and the source code highlighter on StackOverflow), please note that there is another ""problem"" with the code. The CR character entered as unicode escape sequence is interpreted as a correct start of a new line, but the line number is not incremented. – Gregor Raýman Jun 9 '15 at 9:27",,,,
,"@UmaKanth, // comments are skipped all the way to the next new-line character. \u000d is interpreted as a new-line character. – aioobe Jun 9 '15 at 9:31",3,3,Auto aligned after my fix.,
,@TheLostMind If I understand the answer correctly you should be able to reproduce this with block comments as well. \u002A/ should end the comment. – Taemyr Jun 9 '15 at 11:27,4,4,,
,"@Taemyr wow, \u002A/ is really evil, eclipse utterly fails to parse it. Put code between /*\u002A/ and /\u002a*/ and it's completely hidden as comment. Found this as bug 3533 – Dorus Jun 9 '15 at 18:23",4,4,,
,Note that this could have been avoided completely if the language specification had forbidden using \u notation to represent anything representable in ASCII. – R.. GitHub STOP HELPING ICE Jun 12 '15 at 22:47,5,5,,
,"@r good point, well made. At the very least this should be a Level 1 Compiler Warning. – Ben Jun 13 '15 at 18:23",5,5,,
,"@R..: That would make it so that if you're developing on a computer that doesn't use ASCII, then there are many characters you can't type in, such as IBM Mainframes that use EBCDIC, which doesn't have curly braces. – Mooing Duck Jun 13 '15 at 21:58",5,5,,
,@TBohne: Do you actually have in mind such a character? – R.. GitHub STOP HELPING ICE Jun 13 '15 at 22:01,5,5,,
,"@R..: Yes, curly braces. {} – Mooing Duck Jun 14 '15 at 1:43",5,5,,
,@TBohne: Wikipedia claims they're at positions C0 and D0 in EBCDIC. It seems pretty ridiculous to expect programmers to use \u escapes for something as ubiquitous as braces... – R.. GitHub STOP HELPING ICE Jun 14 '15 at 2:20,5,5,,
,"@R.: A quick glance shows you're right. But it also contains ""Portability is hindered by a lack of many symbols commonly used in programming and in network communications, such as the curly braces."" and ""It exists in at least six mutually incompatible versions"". I assume it must be a different version. – Mooing Duck Jun 14 '15 at 15:54",5,5,,
,"@R..: One wouldn't have to forbid everything in ASCII if one were to specify that the first pass of compilation is subdivision into lines, and any new-line characters that get introduced after that will be processed as-is, such that string st=""Hello\u000D\u000Athere"" would generate a twelve-character string containing a carriage return and a new-line. – supercat Sep 27 '15 at 19:47",5,5,,
,"If ever anyone is skeptic and want to test the hello world program, the class should be named ""Ugly.java"". There is other funny thing that may be caused by this... For example, insert LRM character will allow you to compile code such as for (char c‮ = 1; c‮ > 0; c‮++) – Jean-François Savard Oct 7 '15 at 17:17",,,,
,@biziclop Can we call it comment of the day even if it was posted 8 days ago ? :/ – Jean-François Savard Oct 15 '15 at 14:12,,,,
https://stackoverflow.com/a/23188881/5749570,How efficient is this? – Supuhstar Oct 2 '15 at 1:34,1,1,,
,"Worth a read: jaxenter.com/… tl;dr - streams could be performant or not, it depends on what you're doing with them and the constraints of the problem (isn't this always the answer? lol) – Trevor Brown Feb 25 '16 at 17:29",1,1,,
,"Yeah, it's a risky solution from the performance point of view. It might be fast, but I wouldn't bet my application's performance on it ;) – Marcin Zukowski Apr 7 '16 at 23:21",1,,Group 1. Talks performance.,ok
,"Additionally, if a or b are arrays of primitive types, their streams will need to be .boxed() so they are of type Stream rather than e.g. IntStream which cannot be passed as a parameter to Stream.concat. – Will Hardwick-Smith Jul 16 '16 at 9:59",2,2,,
,"@Will Hardwick-Smith: no, you only have to pick the right stream class, e.g. if a and b are int[], use int[] both = IntStream.concat(Arrays.stream(a), Arrays.stream(b)).toArray(); – Holger Jun 13 '17 at 12:28",2,2,,
,@Supuhstar: It is probably not as fast as System.arrayCopy. But not particularly slow either. You probably have to do this a very many times with huge arrays in really performance sensitive contexts for the execution time difference to matter. – Lii Dec 23 '17 at 15:43,1,1,,
,I wonder which is faster and more memory efficient: the concat method or flatMap? Or are they the same under the hood? – Sina Madani Apr 6 '18 at 11:00,1,3,Group 1. Talks performance.,ok
,The latter solution is nice because it can be used for more than 2 arrays unlike most (if not all) the other answers. – Dave L. Apr 9 '18 at 19:51,5,4,,
,"@SinaMadani with all known implementations, the variant using concat will be faster and need less memory, because it can predict the resulting array size beforehand and will create and fill only one array. In contrast, the flatMap based solution will have to use a resizable buffer internally, with at least one final copying step. – Holger Feb 25 '19 at 15:15",1,3,Group 1. Talks performance.,ok
,"Is it possible to make it works for generic type (like in the answer above)? Something like T[] both = Stream.of(a, b).flatMap(Stream::of).toArray(T[]::new); Looks like T[]::new isn't allowed cause of type erasure... – Artsiom Chapialiou Jun 18 '19 at 16:55",4,5,,
,"@ArtsiomChapialiou: You can, but it's not so pretty. You have to use reflection to create the array, and thus get an unchecked cast. I added that to the solution text. – Lii Dec 17 '19 at 9:20",4,5,,
https://stackoverflow.com/a/2950415/5749570,This answer is more correct than try it because current behavior is not the same as guaranteed behavior. – Luke Jan 8 '13 at 19:08,1,1,,
,This question comes into play during Joshua Bloch's chapter on object equality in Effective Java - amazon.com/Effective-Java-Edition-Joshua-Bloch/dp/0321356683 – Kevin Meredith Nov 21 '13 at 13:57,2,2,,
,"Specifically, in Item 8, he notes that in equals() methods, one instanceof operator serves two purposes - it verifies that the argument is both non-null and of the correct type. ""...[S]o you don't need a separate null check."" – Andy Thomas Nov 21 '13 at 14:40",2,2,,
,I don't see them ever changing this. It can only return true or false so how can can it ever be true for a null reference to be an instanceof anything? – Ben Thurley Aug 3 '15 at 10:19,3,3,,
,"@BenThurley - Java's instanceof operator was part of Java 1.0, released almost 20 years ago. Changing the behavior now in a way that would break existing code is unlikely, absent some benefit that outweighs that huge cost. Twenty years ago, maybe there could have been arguments for returning true iff the argument could be cast, or throwing an exception for a null argument. But those definitions would have required separate null checks. – Andy Thomas Aug 3 '15 at 13:59",3,3,,
,Exactly my point. It's true that current behaviour is not the same as guaranteed behaviour but in this case I think it's pretty well guaranteed. – Ben Thurley Aug 3 '15 at 14:02,3,3,,
,@BenThurley - The behavior is guaranteed by Java specifications past and present. I think Luke's point addresses the limitations of experimentation in determining the guaranteed behavior of the present. – Andy Thomas Aug 3 '15 at 15:43,3,3,,
,"Why the compiler let you do this: ""null instance of Class"" lol. I mean, if it is a hardcoded null, it doesn't make sense to even ask it – GabrielBB Mar 22 '18 at 22:57",4,4,,
,"@GabrielBB that’s like writing with a red pen on a red paper. Even if it makes no sense, it’s possible due to the general possibility to combine an arbitrary pen with an arbitrary paper. And implementing a “writing on the same color” check into a pen would complicate the technology for little to no benefit. – Holger Jan 23 at 12:38",4,4,,
https://stackoverflow.com/a/26587225/5749570,"See ""Additional Notes #1"" of my Answer. For a better explanation of this problem. – Stephen C Oct 27 '14 at 13:16",1,1,,
,"@StephenC Yes, your answer is more complete (and of course, +1), but this particular answer had the word ""package"" in it, which allowed me to find what I needed fast. And it worked. So +1 Razavi. StephenC, yours lacks the simple package example I needed as I am new to Java. – kmort Oct 29 '14 at 19:02",1,1,,
,This was exactly my problem. I have been wading through tons of Java doc and this concrete example is what I needed – John Mar 17 '15 at 19:05,2,2,,
,Its better to make 'Runnable JAR File' to execute class file. – M-Razavi Aug 3 '15 at 7:19,3,5,Last group. Only 3 groups.,ok
,"Yes, concrete example is nice, this worked perfectly. I'm sure the main answer is very thorough, but it was difficult to see the tree for the forest. Nice one @Razavi – Pixel May 9 '18 at 7:11",2,3,Group 2 because it has the phrase 'concrete example',ok
,I like this shorter and useful answer instead of accepted one! – Spara Apr 18 '19 at 19:29,2,4,Group 2. This comment also says it likes this answer as the previous comment does.,ok
https://stackoverflow.com/a/153785/5749570,This is probably the best solution presented so far. The reason I didn't spot this facility when I first looked at the DecimalFormat class is that it was only introduced in Java 1.6. Unfortunately I'm restricted to using 1.5 but it will be useful to know for the future. – Alex Spurling Oct 1 '08 at 13:07,1,1,,
,"Doesn't work with exponent decimalformats, say format(""0.0E00""). It will in this example round 0.0155 to 0.0E00 instead of 1.6E-02. – Martin Clemens Bloch Oct 15 '14 at 23:50",,,,
,"I tried this with: ""#.##"", rounding HALF_UP. 256.335f -> ""256.33"" ...(example comes from comments to @asterite's answer). – bigstones Dec 11 '15 at 11:43",4,3,Comment with 1 vote. Tied with other comments having 1 vote. But this commenter has 14k points - the second highest. This will be group 4. it discusses about half_up method.,fine
,"Please be carefull as DecimalFormat depend on your current Local configuration, you may not get a dot as a separator. I personnally prefer Asterite's answer below – Gomino Mar 2 '16 at 17:01",2,2,My bad. Fixed.,
,"Also be aware that you should not expect DecimalFormat to be thread-safe. As per Java docs: Decimal formats are generally not synchronized. It is recommended to create separate format instances for each thread. If multiple threads access a format concurrently, it must be synchronized externally. – CGK Aug 10 '16 at 3:05",5,4,Comment with 1 vote. Tied with other comments having 1 vote. But this commenter has 2k points - the third highest. This will be group 5. it discusses about thread-safety.,fine
,how do i make it so that it does a proper rounding so it will not round 0.0004 to 0.001 – user4919188 Oct 20 '16 at 8:00,,5,,
,"Cannot get this working with HALF_UP: Example DecimalFormat df = new DecimalFormat(""0.00""); df.setMaximumFractionDigits(2); df.setRoundingMode(RoundingMode.HALF_UP); df.format(3.775) returns 3.77 – Thorsten Niehues Dec 11 '17 at 14:20",4,,Group 4. Talks about Half_up,ok
,It's not too difficult to create cases where this simply doesn't work. I wouldn't use this method if it's important to get the correct result. – Dawood ibn Kareem Feb 20 '18 at 2:04,3,,So this comment has 1 vote. It's a tie with some other comments having 1 vote. But this commenter has 60k rep points. So this should be at the top. It should be group 3.,ok
,"@ThorstenNiehues Just because you specify it as 3.775, does not mean it has that value internally. Internally it has a binary value, and 3.775 cannot be represented exactly as a binary value. So it might have a value corresponding to 3.77499999999 internally. When rounding, always add the expected accuracy of the value. – fishinear Oct 25 '19 at 15:51",4,,Group 4. Talks about Half_up,ok
,@fishinear THX :) – Thorsten Niehues Jan 8 at 12:19,4,,Group 4. Talks about Half_up,ok
https://stackoverflow.com/a/3348855/5749570,"Prior to me putting the high number for the threshold, I had the settings set up like you said already but it still put in the wild card imports (i.e. I had ""use single class import"" checked and removed all packages in the ""packages to use import with *""... – digiarnie Jul 27 '10 at 23:51",3,5,A conversation between two users.,ok
,Working for me. Let me see what else I might have set. Version 9.0.3 for me. – duffymo Jul 27 '10 at 23:59,3,,,
,"So if you do 11 imports of classes from the same package the wild card import doesn't kick in? As a test, I have my threshold set to 2. If I import something from org.hibernate let's say, it will put the import correctly (fully qualified). As soon as I import something else from org.hibernate it will stick in the wild card import, which kind of tells me either my version of intellij doesn't behave like yours or the only solution is to put a high threshold so I never run into this issue – digiarnie Jul 28 '10 at 0:53",3,,,
,"If you're using IntelliJ 12 or later then this can be configured under ""Code Style"" -> ""Java"" -> ""Imports"" – Denis Kniazhev Dec 11 '13 at 15:57",4,,,
,"Read my answer - see the ""Click on the Settings"" bit? It's been true since IntelliJ 7. Already been answered for more than three years. – duffymo Dec 11 '13 at 17:04",4,,,
,"In case it saves someone else the confusion: In my enthusiasm for never collapsing imports, I put an unreasonably long string of 9's in the 'class count to use...' field, and this caused IntelliJ 12 to silently ignore the value. '9999' works fine. – PotataChipz Mar 20 '14 at 16:53",1,1,"They all talk about configuring class count property with 3 or 4 or 5 9's on intellij. With the highest votes, this should be group 1.",ok
,Is there really no way to tell Intellij 15 never to use wildcard imports? I mean without specifying a class count??! – Stephen Hartley Feb 8 '16 at 15:04,1,4,,
,Why is adding a class count so oppressive? Why not ask JetBrains for an enhancement if this is so odious? – duffymo Feb 8 '16 at 20:51,1,4,,
,"For the record (at least in IntelliJ Ultimate 2016), trying to set the value to an extremely large number of 9's won't work. If you add more than 5 9's, the ""Apply"" button grays itself out and the setting won't take - instead of just not allowing you to only enter 5 9's. I found this out because I was lazy and just wanted to add a bunch of 9's to make sure it would never be close to an issue at all :) – MCory Apr 5 '16 at 18:02",1,,,
,Looks like three nines should be enough. If you need more than a thousand imports I'd say your class should be refactored. – duffymo Apr 5 '16 at 20:09,1,2,,
,"Can't believe programmes programmed a program for programmers the way this is programmed. This confusing dialog is still not fixed in 2016.3, is there a bug for it, or somewhere we can vote? – Glenn Bech Jan 26 '17 at 11:38",2,3,This will auto correct if you fix the above.,ok
,"Interesting enough, for Kotlin the option is less confusing: ""Use import with '*' when at least [99] names used."" – Paulo Merson Oct 5 '18 at 16:31",5,,,
,"@GlennBech Just contact them on the ""Submit feedback"" entry in the Help menu. – Thorbjørn Ravn Andersen Sep 19 '19 at 10:02",2,,Direct reference to a user in group 2.,ok
https://stackoverflow.com/a/36211683/5749570,Why is the nio package better? Does it work in the same way? What even is nio? – StealthVice7 Mar 24 '16 at 23:51,1,1,,
,"It's not fundamentally better and using the standard io package is fine, I'm not sure where is your error coming from but having a clean example of file deletion (starting with a .) might be a good starting point. – Benoit Vanalderweireldt Mar 24 '16 at 23:56",1,1,,
,"My program works perfectly fine with all other test files I made, but not the .minecraft file. – StealthVice7 Mar 24 '16 at 23:58",2,2,,
,"System.getProperty(""user.home"") returns the user's desktop on windows. Use System.getProperty(""user.home"") + ""/.."" or similar instead. – Majora320 Mar 25 '16 at 0:07",3,3,My bad. Fixed it.,
,What does /.. do? And my program was working fine with all other files with the way I had it. – StealthVice7 Mar 25 '16 at 0:25,3,4,I think this should be group 3 only. They talk the same thing.,ok
,/ is the root path .. means the parent folder so /.. means the parent folder of root which is incorrect – Benoit Vanalderweireldt Mar 25 '16 at 1:52,3,4,,
,"@BenoitVanalderweireldt Wrong, with <somepath> + ""/.."" it means the parent folder of <somepath>, so in this case it would return the parent folder of the desktop. – Majora320 Mar 25 '16 at 3:46",3,4,,
,"""/.."" != '""<somepath>"" + ""/..""' – Benoit Vanalderweireldt Mar 25 '16 at 3:47",3,4,,
,"Guys I figured out my mistake, the folder had other files inside of it, so I had to delete the insides before I could delete the folder. – StealthVice7 Mar 25 '16 at 11:26",3,5,,
,Hey can you guys undownvote my question? I can't post any more. – StealthVice7 Nov 13 '16 at 1:20,4,,Group 4,ok
https://stackoverflow.com/a/8725470/5749570,"\+1. Imo, this is more constructive than the top voted answer. It comes with two minor downsides though. The PriorityQueue does not support random access. You cannot do peek(elementIndex). So you cannot do e.g. Integer maxVal = prioQueue.peek(prioQueue.size() - 1);. Secondly if you're intending to use the PriorityQueue simply as a sorted list, it will sound less intuitive to see PriorityQueue in the code than it would have been to see SortedList, if such a data structure existed. – Alderath Jan 4 '12 at 12:18",1,1,,
,"And, after looking at the other question which someone linked in the comments, another big disadvantage is that the iterator of PriorityQueue is not guaranteed to return elements in any specific order. So, unless I am overlooking something, the only way to e.g. print all objects in the PriorityQueue in order is to repeatedly poll() the queue until it is empty. To me, this feels borderline retarted. To print the objects in a PriorityQueue twice, you'd first have to copy the PriorityQueue and then poll() all objects from the original PriorityQueue and then pol()l all objects from the copy. – Alderath Jan 4 '12 at 12:49",2,2,My bad. Fixed it.,
,Hmm... looks like you're right Alderath. You can't use the iterator of PriorityQueue to get the elements in expected order. Looks like I have to edit my answer. – Spoike Jan 4 '12 at 13:10,2,2,,
,"Sorted list is implemented via tree, otherwise it's just way too costy – bestsss Jan 4 '12 at 17:24",,,,
,"Priority queue is just a heap, you can access only the top, imo it does not belong to the answer of the question. – bestsss Jan 4 '12 at 17:25",3,3,,
,"Also worth noting is that Collections.sort() even lets you define the compare function that is used to sort, by using a Comparator object. – Mike 'Pomax' Kamermans Jun 12 '13 at 14:27",4,4,,
,"I would argue that there is a need for some kind of sorted, indexed collection. I'm working on an application, and I need a data collection that is accessible via an index number, but maintains a very specific order. I don't want to have to use sort() or comparators all the time. So yeah, I'm probably going to create a custom collection that just inherits from Collection, rather than list, that fulfills this function. – user2223059 Feb 9 '16 at 19:38",5,5,My bad. Fixed it,
,"The TreeMultiset allows for multiples in a really weird way. If you have two objects that have the same key, instead of actually inserting all of the objects into the Multiset, it just keeps track of the count that match that key. This is fine if you are using primitives. But if you are using objects, and plan on using other pieces of the object, it won't return the objects expected. – Caitlin Oct 7 '16 at 17:25",,,,
,"@Spoike ` because the add methods should ensure that the element will reside in the index that the user specifies` actually,it adds at the end, you can specify index in a Map, with put(). Am I confused? – juanmf Feb 4 '17 at 18:46",,,,
,@juanmf The key (or index) for a Map is not the same thing as the index for a List. Using put() there is no way for sure that putting something in a lower number and something in a higher number will come in the order you want when you iterate on the entrySet of the map (i.e. unless you sort the entrySet by the key). – Spoike Feb 7 '17 at 14:34,,,,
,"A huge downside to all of these suggestions is the missing .sub*-function that SourtedMap and SortedSet provide, and that at least in my experience is the most needed feature. – Torque Apr 5 '19 at 7:37",,,,
,"@Spoike, the own implementation of a SortedList can be written more efficiently. Since a random access list is used (ArrayList) and you know that it is already sorted before adding a new item, you can use Collections.binarySearch to get the index where the new item should be inserted. – Marcono1234 Jul 13 '19 at 15:25",,,,
https://stackoverflow.com/a/3831945/5749570,"You don't need to create a class to pass by reference in java (though that would certainly work). You can use the Integer class, which is part of the standard library, and it even has the benefit of being auto-boxed to and from int almost transparently. – rmeador Sep 30 '10 at 18:18",4,4,My bad. Fixed it.,
,"@rmeador Integer is immutable, so you still couldn't change its value. AtomicInteger, however, is mutable. – ILMTitan Sep 30 '10 at 18:22",4,4,,
,"@rmeador: I'm asking because I honestly don't know, not to challenge you: how would this work, what you're suggesting? What I mean is, how can you assign a new value to x from within a method, even if it is boxed as an Integer? (Is the Integer type not immutable?) I know that in .NET, using C# for example, you could box an int as object but you still wouldn't be able to assign a new value to the variable holding that int from within a method, unless it were passed as a ref parameter. – Dan Tao Sep 30 '10 at 18:22",4,4,,
,"@Dan Tao: yeah, as @ILMTitan points out, it's immutable... I forgot that little detail. The suggestion of AtomicInteger seems reasonable, but I don't think you get autoboxing with that class. – rmeador Sep 30 '10 at 18:51",4,4,,
,"@Dan: By the way, x in your last example must be declared volatile, otherwise it's an undefined behaviour and seeing 1s is implementation specific. – axtavt Sep 30 '10 at 20:44",1,1,,
,"@axtavt: Good point -- I actually discovered this myself after last updating my answer when I changed the code only slightly and saw different behavior (all 0s, no 1s). I've updated the answer to include the volatile keyword so that the program's behavior is defined. – Dan Tao Sep 30 '10 at 20:56",1,1,,
,"simple answer: operator precedence of ++ before =. See cppreference.com/wiki/operator_precedence The ""infinite loop"" part of title is misleading. – burkestar Oct 1 '10 at 3:22",3,3,,
,"@burkestar: I don't think that link is quite appropriate in this case, since it's a Java question and (unless I'm mistaken) the behavior is actually undefined in C++. – Dan Tao Oct 1 '10 at 3:49",3,3,,
,"Something to say about my last comment on the question?: It's very strange that in C language the behavior is different. Maybe in C it first read the value and then, later, it increments, while in Java it increments then return the old value.. – Tom Brito Oct 1 '10 at 11:54",2,2,,
,"@Tom Brito - in C it's not defined... the ++ could be done before or after assignment. Practically speaking, there might a compiler that does the same thing as Java, but you wouldn't want to bet on it. – detly Oct 1 '10 at 16:54",2,2,,
,This is a very verbose way of saying the right side of an assignment expression is evaluated first. – Jason C Mar 15 '14 at 3:53,5,5,,
,"@burkestar Operator precedence is irrelevant here because (x = x)++ isn't legal. And the ""infinite loop"" part of the title is a fact; it's not at all ""misleading"". – Jim Balter Dec 28 '16 at 6:16",3,5,"I think this is group 3, not 5.",ok
https://stackoverflow.com/a/52264813/5749570,"Just to note, main could be a keyword that is only usable as a name for a static method with an appropriate signature (or whatever). Note that super class calls use super in a way that makes it look like an identifier: super(foo); and super.foo, but super IS a keyword (and before generics were added, this was the only way to use it (that I can remember)). – jaxad0127 Sep 10 '18 at 21:33",1,1,,
,"@jaxad0127 Interesting point but I don't agree completely. Actually it IS not and in the future it could probably not be for still compatibility reasons. If you defined main as a keyword in a new version of java, it means that any code that uses main as method name (or any member names) will not compile any longer. The usage of super in generics doesn't have any side effect in existing code as generics didn't exist at this time. – davidxxx Sep 10 '18 at 21:50",1,1,,
,"I just meant that it COULD have been done as a keyword. Just because it looks like an identifier, doesn't mean it has to be. – jaxad0127 Sep 10 '18 at 22:01",1,1,,
,@jaxad0127 Without going too deep into the JLS and for the two cases you mention I think it can be said that super is a special expression: It represents a reference to a Class object to be used with the object's constructor and its members. – GeroldBroser reinstates Monica Sep 12 '18 at 0:57,1,1,,
,"I would argue that main is still a better identifier than java1234. Using it for a ""regular"" method would be misleading, but I'd have no problem naming a variable main, if it's actually the main something in my method. java1234 is just awful, names should be descriptive... – AJPerez Sep 12 '18 at 12:56",2,2,My bad. Fixed it.,
,"""About the question, is main a good identifier?"" It depends. I probably wouldn't bat an eye at a variable named main if the function I was looking at did something with water main data. I'd throw up if I ever saw java1234 in production code (and pray there were not 1233 other variables with the prefix java). – jpmc26 Sep 13 '18 at 1:59",3,3,,
,"@jaxad0127 main could have been defined to be a keyword, it could still become a keyword, just like _ stopped to be a legal identifier, however, it is not and this was a deliberate decision. The Java designers decided that, e.g. goto and const are keywords, to prevent their use as misleading identifiers, but main does not require such special treatment. – Holger Sep 13 '18 at 6:08",1,1,,
,@AJPerez I completely agree. But well both are bad. You could notice that I added main as variable name but I didn't quote it in things that we don't want (not the hazard). But I will remove it to be consistent. – davidxxx Sep 13 '18 at 16:10,2,2,My bad. Fixed it.,
https://stackoverflow.com/a/1250655/5749570,"Looks nice and simple, only I have feeling that shutdown here is used not for what it was designed (or it is fine?). – serg Aug 9 '09 at 5:15",4,,"I think this is group 4 as well. The user is asking if 'shutdown' should be used here. In the following group 4 comment, the guy says it is meant for that.",ok
,It's a common pattern. Transient threadpools like the above are good for several reasons and I pretty much always prefer them to persistent threadpools where a lot more can go wrong or at least it can be harder to figure out. The above is really straightforward which is why I like it. – cletus Aug 9 '09 at 5:29,,,,
,this is exactly what shutdown / awaitTermination are meant for – matt b Aug 9 '09 at 14:31,4,4,,
,"It is a good pattern if this task handling is a one-time event. If this is done repeatedly during the same runtime, however, it is not optimal, as you would create and tear down threads repeatedly every time it is executed. – sjlee Aug 9 '09 at 16:25",2,2,,
,This pattern is incomplete: Some unsubmitted tasks may be never executed. – 象嘉道 Jul 24 '11 at 22:47,6,,,
,"@Kejia It is not incomplete... Think about it this way: Your main thread is spawning off subthreads in a loop. When it's done adding, you run this code. You might see output out of order, but all of your tasks will have been spun off. Thanks @Cletus! – inanutshellus Aug 17 '11 at 15:32",6,,,
,"I'm looking for any official documentation that Long.MAX_VALUE, TimeUnit.NANOSECONDS is equivalent to not having a timeout. – Sam Harwell Aug 22 '12 at 14:04",1,1,,
,@serg is this still considered the best answer over using invokeAll() as proposed by sjlee? – Brad Aug 27 '12 at 21:35,7,,,
,"I can't believe that you have to use shutdown in order to join on all the current threads (after using shutdown, you cannot use the executor again ever). Suggest using list of Future's instead... – rogerdpack Nov 2 '12 at 16:02",3,3,,
,As I'm testing this out I found that the executor finishes before all tasks have completed. If I use Thread.sleep(100) before calling shutdown() it works. So I suspect that there may be some timing issues with your code if the time between adding tasks to the shutdown call is too small. – jontejj May 14 '13 at 17:47,,,,
,this wont work if you dont want to shutdown the executor. For a perpetually running batch kind of thing u need to submit jobs and wait for them to finish before jumping ahead. In Such a case a latch or a barrier makes more sense than a shutdown. – Nazgul Nov 11 '13 at 15:25,,,,
,IMO it's probably not a wise thing to NOT have a timeout. There's always a likelihood your task is stuck / deadlocking and the user would wait forever. – gerrytan Jan 28 '14 at 2:10,5,5,,
,"@ashutosh I can't find any documentation on this. It appears to be a method of a Spring library, and not plain Java functionality. – Zero3 May 14 '15 at 20:23",,,,
,"@SamHarwell see the java.util.concurrent package documentation under the Timing section: To wait ""forever"", you can use a value of Long.MAX_VALUE – beluchin Aug 28 '15 at 22:01",1,1,,
,@ashutosh 1) That requires springframework. 2) Doesn't look any simpler to me than shutdown/awaitTermination. – ToolmakerSteve Sep 6 '15 at 9:35,,,,
,Is it better than using infinite loop while checking isTerminated() ? – Praveen Kumar Jan 6 '16 at 6:50,,,,
,If I don't want to shutdown because I want to keep my executor alive. How can I know the maximum number of pending tasks that could I have there? – Sergio Bilello Apr 5 '16 at 20:49,,,,
,"@SamHarwell TimeUnit.NANOSECONDS and Long.MAX_VALUE equals 106,751 Days or 292 years (TimeUnit.NANOSECONDS.toDays(Long.MAX_VALUE);), that should be enough, or use some of the bigger TimeUnits. – hinneLinks Dec 9 '16 at 7:51",1,1,,
,"When sizing thread pools, it is often useful to base the size on the number of logical cores in the machine running the application. In Java, you can get that value by calling Runtime.getRuntime().availableProcessors(). In this case, it would be Math.min(4, Runtime.getRuntime().availableProcessors()); – eli-bd Jun 24 '17 at 16:23",,,,
,executor.shutdown(); is stopping my program !! – Jobs May 7 '18 at 18:40,,,,
,Java apis are pretty terrible. Thank you for this insight. – Mobigital Aug 2 '19 at 19:34,,,,
,@cletus is awaitTermination() necessary after shutdown()? – gaurav Oct 11 '19 at 11:04,,,,
https://stackoverflow.com/a/37308580/5749570,"Well, this effectively means that any Function can always be used as a Consumer, right? I wasn't aware of this design choice, so thanks for pointing this out. Still, why then are Function Lambdas like s -> s not allowed as Consumer arguments? – Ulrich Schmidt May 18 '16 at 20:41",2,2,,
,"Well, there's always the Java typing issue, so you can't pass a constructed Function as Consumer or cast/assign it to a Consumer variable. It still uses the same old Java typing mechanism - you can think of lambdas as anonymous classes, except with prettier syntax and different internals. (I won't go into details, but chances are that they do not compile into the same exact bytecode.) However, any method that could construct a Function<A, B> (that consumes type A), could be used to construct a Consumer<A>. – JustACluelessNewbie May 18 '16 at 20:49",2,2,,
,"About the s -> s - my guess is that if you explicitly define a new lambda without referencing an existing method, you have to follow its exact method signature. In this case, Consumer<String> does not return anything, so you cannot just end the lambda with a line that basically stands for return s;. s -> s.toString() (which would pretty have the same result) should work, as the method would be simply invoked and its result (s) would be ignored. – JustACluelessNewbie May 18 '16 at 20:56",2,2,,
,"It does work indeed! Amazing! s -> s triggers a compiler error ""Void methods cannot return a value"" but s -> s.toString() is accepted. I still don't understand the difference between these two Lambda expressions. – Ulrich Schmidt May 18 '16 at 21:02",2,2,,
,"s -> s is an equivalent of s -> { return s; }, which fails to compile, as Consumer method cannot return a value. s -> s.toString() might seem to ""do"" the same thing, but it actually is an equivalent of s -> { s.toString(); }, which simply invokes a method, but does not return anything. So - in the first example, you're trying to return a value. In the second, you're actually invoking a method and ignoring its result. – JustACluelessNewbie May 18 '16 at 21:14",2,2,,
,"I think I understand it now :-) If the target type is a Consumer, then s -> s.toString()is interpreted as s -> { s.toString(); }. If the target type is a Function, then the same lambda is interpreted as s -> { return s.toString(); } – Ulrich Schmidt May 18 '16 at 21:24",2,2,,
,"Yes, that's it. Is there anything you'd like me to add to the original answer or can it be accepted as it is? – JustACluelessNewbie May 18 '16 at 21:31",2,3,This is still group 2. They are trying to conclude the discussion.,ok
,Your original answer is certainly acceptable in light of our discussion. Thanks again for your patience in explaining these things. Type inference does sometimes lead to suprising conclusions! – Ulrich Schmidt May 18 '16 at 21:36,2,3,,
,"Here's the basis for this design decision: Java allows you to call a method and ignore the return value (a method invocation expression as a statement). Since we allow this at the invocation, we also allow this when adapting a method to a functional interface whose arguments are compatible but the functional interface is void-returning. – Brian Goetz May 18 '16 at 23:20",1,1,,
,"Note also that we'll do other adaptations (boxing, unboxing) to make the shape of the lambda match up with the expected shape of the functional interface. Ignoring a return value is just one of those adaptations. – Brian Goetz May 18 '16 at 23:21",1,1,,
,"A convenient way to adapt a Function<T,R> to a Consumer<T,R> is to append ::apply to a Function instance; then the Function return type can be ignored like any other method that returns a value, e.g. Function<String,Integer> f = String::length; Consumer<String> c = f::apply; – Hank D May 19 '16 at 4:22",3,4,This will auto align if you change the above.,
https://stackoverflow.com/a/23318269/5749570,This has changed now. You can use Java 7 as well. As long as you don't use try with resources. – Martin Nov 30 '14 at 12:11,3,5,This will auto-align if you change the below one.,
,"Did Java 8 change the way the bytecode works? If not, it should be fine to use any version of Java, theoretically, as long as it compiles. – Ben Leggiero Mar 12 '15 at 14:13",1,2,This will auto-align if you change the below one.,
,"the correct question is: what if you use new features in java 8 not exists in java 7 to build android app, is it ok? to be on safe side follow official instructions. – Eng. Samer T Mar 12 '15 at 20:12",1,3,This is not a separate group. This is user is simply asking the previous commenter to rephrase her question.,ok
,"@BenC.R.Leggiero there's no new bytecode in Java 8, but the instructions' meanings and structures were changed stackoverflow.com/questions/28228450/… stackoverflow.com/questions/16143684/… – phuclv Mar 14 '15 at 19:13",1,2,This will auto-align if you change the below one.,
,"Please do not post ""Update N"" in your answer. Rewrite it to have up-to-date information. Otherwise, SO will in a few years be as difficult to get information from as the forums it superseded. – Aleksandr Dubinsky Mar 7 '16 at 21:44",C,1,"Though it is the most voted comment, it has no value. It is a pure criticism. It is actually a meta-comment.",ok
,"As I understand it, It says Android N is supporting Java 8, so it means APIs < Android N doesn't have it. Is this correct? – Neon Warge Jun 17 '16 at 2:47",,,,
,Jack toolchain is now deprecated as per this announcement. Replacement is in the works. – Andrey Makarov Mar 28 '17 at 3:30,,,,
,"This answer needs to be updated. The first sentence ""I think it is too early to say if Java 8 is suitable for Android development"" is completely outdated an links to old data. The ""Updated"" stuff is also very old. – user239558 May 31 '17 at 12:25",4,,Group 4,
,Not all Java 7 features are available in Android. Like the package java.nio.file. It will be available in Android O as I understand ? – Guillaume Husta Jun 28 '17 at 14:15,5,,Group 5,
,Answer need to be update. Java 8 will is supported as of Android Studio 3.0 and Gradle Plugin 3.0. – Юрій Мазуревич Oct 21 '17 at 20:27,2,4,This will auto-align if you change the above annotations,ok
https://stackoverflow.com/a/49940364/5749570,So maybe this should be reported as a bug? – Federico Peralta Schaffner Apr 20 '18 at 12:47,1,,These are group 1 as well,ok
,@FedericoPeraltaSchaffner I don’t know whether the behavior matches the specification. I just used the word “flaw” from the practical point of view. I didn’t have the time to check the specification yet and this part of the spec is one of toughest… – Holger Apr 20 '18 at 13:41,1,,,
,"I don't think it's a ""flaw"": Consumer<? super Supplier> would even match Consumer<Object>, and Object is not a funtional interface. By downcasting to Supplier you make the potentially-Object an instance of a functional interface again. – JimmyB Apr 20 '18 at 13:56",1,1,,
,"@JimmyB Consumer<? super Supplier…> could be a Consumer<Object>, but you see at the action variable that the compiler does not assume Consumer<Object>, as the lambda expression s -> System.out.println(s.get()) invokes the supplier’s get method without problems. Here, the compiler does assume the most specific type which is Consumer<Supplier<? extends String>>. And it could do the same for the invocation of accept. See the last example of my answer which doesn’t have a type cast. These assignments are valid. – Holger Apr 20 '18 at 14:03",1,1,,
,"@Holger No, your last example does not have an explicit cast. But your supp is not of type ? super Supplier but of type Supplier which amounts to the same as the other example with an explicit cast. When using action its declared type is what matters to the compiler, and that type does not guarantee that there's a supplier involved. In other words, ? super Supplier means that consumer.accept(new Object()) would be valid w.r.t. generic types. Hence, the compiler only knows that some object is required and fails to see how customer::getName should target the non – JimmyB Apr 20 '18 at 14:19",1,1,,
,functional interface type Object. – JimmyB Apr 20 '18 at 14:19,1,1,,
,"By the way, ? super X is meant to designate some kind of 'container' for objects of type X, i.e. it is guaranteed that I can assign an instance of type X to a given variable (ensures assignability). In the case of the OP this is not needed because he won't be assigning anything to the given supplier reference inside his consumer. – JimmyB Apr 20 '18 at 14:23",1,1,,
,"@JimmyB You can not do consumer.accept(new Object()). The declaration Consumer<? super Supplier<? extends String>> action implies that you can assign a Consumer<Object> to action, because a Consumer<Object> can also handle Supplier<? extends String> arguments in its accept method. But since it is also possible to assign a Consumer<Supplier<? extends String>> to it, as happening implicitly in my examples, it would never be valid to pass new Object() to the accept method. The argument to accept must be assignable to Supplier<? extends String>. So why not infer that… – Holger Apr 20 '18 at 15:01",1,1,,
,"@Holger No, the argument to accept must be a super type of Supplier. That's what ? super Supplier declares, and that does not make sense in this case. Consumer<Supplier> declares what you intend, making only instances of Supplier acceptable. – JimmyB Apr 21 '18 at 17:17",1,1,,
,"@JimmyB: Apparently, you are so convinced of yourself that you didn’t even try it. Since you are only repeating yourself, this pointless discussion has to stop here. – Holger Apr 23 '18 at 6:33",1,1,,
,"@Holger While I do understand your point, obviously the compiler proves both of us wrong: It does not in fact accept new Object() (although the effective declared method becomes accept(Object t)), but on the other hand it does not infer the need for a Supplier (because the effective declared method becomes accept(Object t)). – JimmyB Apr 24 '18 at 10:45",1,1,,
,"@JimmyB: There is no such thing as “effective declared method”. Apparently you are confusing this with type erasure, but type erasure has nothing to do with what is valid under the generic type system. As said several times, the signature Consumer<? super Type> implies that the accept method requires Type, the relevant difference to Consumer<Type> is that the actual implementation may be a consumer of a super type. But in the example of the answer, it is not. There, it is a Consumer<Supplier<? extends String>>. – Holger Apr 24 '18 at 15:03",1,1,,
,"@Holger Yes, I am referring to type erasure. And through that, Consumer<? super X> gets its accept() as accept(<? super X>) (itself not valid syntax), and that method should accept anything of X or a super type, hence when typing eclipse offers me accept(Object t). – JimmyB Apr 24 '18 at 15:33",1,1,,
,"@Holger I think, together we can pin down the issue: You are correct in that Consumer<? super X> action says something about which kinds of consumers may be assigned to action; could be Constumer<Object> if one wants. Now, if I assigned a Constumer<Object> to action at some point in my program, action.accept(...) would accept Object which is not a functional interface. Thus, from the declared type of action the compiler cannot infer that the actual instance is restricted to functional interfaces, because it might not. – JimmyB Apr 24 '18 at 15:37",1,1,,
,"Btw, I just tried once more and my eclipse Neon actually only suggests accept(Supplier<...> t) while Oxygen on my laptop showed accept(Object t). – JimmyB Apr 24 '18 at 15:43",1,1,,
,"@JimmyB there is no need for the target type to be “restricted to functional interfaces”. See, whenever there is a variable or parameter of type X, X being a functional interface, you could also assign Y, a subtype of X not being a functional interface. The variable is never “restricted to functional interfaces”. And once you have assigned the lambda expression to a variable or parameter of a functional interface type, the receiving code could always assign that to a wider type like Object. All that matters is whether the compiler understands what to do before assigning the result. – Holger Apr 24 '18 at 16:21",1,,These are group 1 as well,ok
,"@JimmyB Regarding type erasure, when you write, e.g. Set<Runnable> l = Collections.singleton(() -> System.out.println(""hello""));, you are also passing the lambda expression to a method receiving Object under the cover, as singleton accepts arbitrary types, not even remotely restricted to lambda expression. It’s only our generic (compile-time) usage, i.e. assigning to a Set<Runnable> (which will be just Set after erasure), which determines the lambda’s target type for the compiler. – Holger Apr 24 '18 at 16:23",1,,,
,"@Holger Not sure I get your point. If X is a functional interface, then Y extending X should implicitly be a functional interface too. So whatever I can do on a functional interface X, I can do on Y too. – JimmyB Apr 24 '18 at 18:20",1,,,
,"Supplier<String> s = obj::toString; works, Object o = obj::toString; doesn't. – JimmyB Apr 24 '18 at 18:23",1,,,
